<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary" /><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Graph isomorphism networks | datitos</title>
<meta name="generator" content="Jekyll v4.0.0" />
<meta property="og:title" content="Graph isomorphism networks" />
<meta name="author" content="Matías Battocchia" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="/ᐠ｡▿｡ᐟ*ᵖᵘʳʳ* Redes neuronales de grafos, la moda que se viene" />
<meta property="og:description" content="/ᐠ｡▿｡ᐟ*ᵖᵘʳʳ* Redes neuronales de grafos, la moda que se viene" />
<link rel="canonical" href="https://matiasbattocchia.github.io/datitos/Graph-isomorphism-network.html" />
<meta property="og:url" content="https://matiasbattocchia.github.io/datitos/Graph-isomorphism-network.html" />
<meta property="og:site_name" content="datitos" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-10-24T00:00:00-05:00" />
<script type="application/ld+json">
{"author":{"@type":"Person","name":"Matías Battocchia"},"description":"/ᐠ｡▿｡ᐟ*ᵖᵘʳʳ* Redes neuronales de grafos, la moda que se viene","mainEntityOfPage":{"@type":"WebPage","@id":"https://matiasbattocchia.github.io/datitos/Graph-isomorphism-network.html"},"@type":"BlogPosting","url":"https://matiasbattocchia.github.io/datitos/Graph-isomorphism-network.html","headline":"Graph isomorphism networks","dateModified":"2019-10-24T00:00:00-05:00","datePublished":"2019-10-24T00:00:00-05:00","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/datitos/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://matiasbattocchia.github.io/datitos/feed.xml" title="datitos" /><!-- the google_analytics_id gets auto inserted from the config file -->



<script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-174296382-1','auto');ga('require','displayfeatures');ga('send','pageview');</script>

<link rel="shortcut icon" type="image/x-icon" href="/datitos/images/favicon.ico"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Graph isomorphism networks | datitos</title>
<meta name="generator" content="Jekyll v4.0.0" />
<meta property="og:title" content="Graph isomorphism networks" />
<meta name="author" content="Matías Battocchia" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="/ᐠ｡▿｡ᐟ*ᵖᵘʳʳ* Redes neuronales de grafos, la moda que se viene" />
<meta property="og:description" content="/ᐠ｡▿｡ᐟ*ᵖᵘʳʳ* Redes neuronales de grafos, la moda que se viene" />
<link rel="canonical" href="https://matiasbattocchia.github.io/datitos/Graph-isomorphism-network.html" />
<meta property="og:url" content="https://matiasbattocchia.github.io/datitos/Graph-isomorphism-network.html" />
<meta property="og:site_name" content="datitos" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-10-24T00:00:00-05:00" />
<script type="application/ld+json">
{"author":{"@type":"Person","name":"Matías Battocchia"},"description":"/ᐠ｡▿｡ᐟ*ᵖᵘʳʳ* Redes neuronales de grafos, la moda que se viene","mainEntityOfPage":{"@type":"WebPage","@id":"https://matiasbattocchia.github.io/datitos/Graph-isomorphism-network.html"},"@type":"BlogPosting","url":"https://matiasbattocchia.github.io/datitos/Graph-isomorphism-network.html","headline":"Graph isomorphism networks","dateModified":"2019-10-24T00:00:00-05:00","datePublished":"2019-10-24T00:00:00-05:00","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

<link href="https://unpkg.com/@primer/css/dist/primer.css" rel="stylesheet" />
<link rel="stylesheet" href="//use.fontawesome.com/releases/v5.0.7/css/all.css"><link type="application/atom+xml" rel="alternate" href="https://matiasbattocchia.github.io/datitos/feed.xml" title="datitos" /><!-- the google_analytics_id gets auto inserted from the config file -->



<script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-174296382-1','auto');ga('require','displayfeatures');ga('send','pageview');</script>


    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous">
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"> </script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js" integrity="sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous"></script>
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
        ]}
        );
    });
    </script>


<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/datitos/">datitos</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/datitos/about/">Acerca de</a><a class="page-link" href="/datitos/search/">Búsqueda</a><a class="page-link" href="/datitos/categories/">Contenidos</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Graph isomorphism networks</h1><p class="page-description"> /ᐠ｡▿｡ᐟ\*ᵖᵘʳʳ* Redes neuronales de grafos, la moda que se viene</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2019-10-24T00:00:00-05:00" itemprop="datePublished">
        Oct 24, 2019
      </time>• 
          <span itemprop="author" itemscope itemtype="http://schema.org/Person">
            <span class="p-author h-card" itemprop="name">Matías Battocchia</span></span>
       • <span class="read-time" title="Estimated read time">
    
    
      3 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/datitos/categories/#pytorch">pytorch</a>
        &nbsp;
      
        <a class="category-tags-link" href="/datitos/categories/#grafos">grafos</a>
        &nbsp;
      
        <a class="category-tags-link" href="/datitos/categories/#paper">paper</a>
        
      
      </p>
    

    
      
        <div class="pb-5 d-flex flex-wrap flex-justify-end">
          <div class="px-2">

    <a href="https://github.com/matiasbattocchia/datitos/tree/master/_notebooks/2019-10-24-Graph-isomorphism-network.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/datitos/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          
          <div class="px-2">
    <a href="https://colab.research.google.com/github/matiasbattocchia/datitos/blob/master/_notebooks/2019-10-24-Graph-isomorphism-network.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/datitos/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>
        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul class="section-nav">
<li class="toc-entry toc-h2"><a href="#Publicaciones">Publicaciones </a></li>
<li class="toc-entry toc-h2"><a href="#Adjacency-matrix">Adjacency matrix </a></li>
<li class="toc-entry toc-h2"><a href="#Dataset">Dataset </a></li>
<li class="toc-entry toc-h2"><a href="#Net-modules">Net modules </a></li>
<li class="toc-entry toc-h2"><a href="#Train-loop">Train loop </a></li>
<li class="toc-entry toc-h2"><a href="#TODO">TODO </a></li>
</ul><!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2019-10-24-Graph-isomorphism-network.ipynb
-->

<div class="container" id="notebook-container">
        
    
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Estas notas corresponden a la sección de código de una charla que di en el seminario <a href="https://twitter.com/machinlenin">MachinLenin</a> en 2019. Esta es la <a href="https://docs.google.com/presentation/d/1y9-4LMrm0UPqwYYBWwTMn-ixBazD8-nRnr6EIn53Nig/edit?usp=sharing">presentación</a> que usé y este el <a href="https://github.com/matiasbattocchia/gin">repositorio</a>.</p>
<p>Esta es una implementación simple, con fines didácticos y para nada eficiente de la publicación <a href="https://arxiv.org/pdf/1810.00826.pdf">How powerful are graph neural networks?</a>. Para una implementación eficiente ver <a href="https://docs.dgl.ai/api/python/nn.pytorch.html#ginconv">GINConv</a> de Deep Graph Library (DGL).</p>
<p>La publicación mencionada fue la que elegí para comenzar a aprender sobre redes neuronales de grafos (<em>graph neural networks</em> o GNN). Unas redes interesantes porque no todo es texto, ni todo son imágenes, ni tablas... una vasta cantidad de información se representa en forma de grafo, y estas redes se especializan en esta estructura de datos.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Publicaciones">
<a class="anchor" href="#Publicaciones" aria-hidden="true"><span class="octicon octicon-link"></span></a>Publicaciones<a class="anchor-link" href="#Publicaciones"> </a>
</h2>
<p>Hoy en día si tuviese que recomendar lecturas introductorias, serían los <em>reviews</em> de esta lista.</p>
<p><strong>Reviews</strong></p>
<ul>
<li><a href="https://arxiv.org/pdf/2003.00982.pdf">Benchmarking Graph Neural Networks</a></li>
<li>
<a href="https://arxiv.org/abs/1709.05584">Representation Learning on Graphs: Methods and Applications</a> | <a href="http://snap.stanford.edu/proj/embeddings-www/">http://snap.stanford.edu/proj/embeddings-www/</a>
</li>
</ul>
<p><strong>Arquitecturas</strong></p>
<ul>
<li><a href="https://arxiv.org/pdf/1710.10903">GAT</a></li>
<li><a href="https://arxiv.org/pdf/1810.00826">GIN</a></li>
<li><a href="https://arxiv.org/abs/1609.02907">GCN</a></li>
<li><a href="https://arxiv.org/pdf/1706.02216.pdf">GraphSAGE</a></li>
</ul>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">networkx</span> <span class="k">as</span> <span class="nn">nx</span>

<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Adjacency-matrix">
<a class="anchor" href="#Adjacency-matrix" aria-hidden="true"><span class="octicon octicon-link"></span></a>Adjacency matrix<a class="anchor-link" href="#Adjacency-matrix"> </a>
</h2>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">G</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">binomial_graph</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">)</span>

<span class="c1"># TODO: numerar los nodos en el gráfico</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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%0A">
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span> <span class="n">nx</span><span class="o">.</span><span class="n">adjacency_matrix</span><span class="p">(</span><span class="n">G</span><span class="p">)</span><span class="o">.</span><span class="n">todense</span><span class="p">(),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span> <span class="p">)</span>

<span class="n">A</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([[0., 0., 1., 1., 0.],
        [0., 0., 0., 1., 1.],
        [1., 0., 0., 1., 1.],
        [1., 1., 1., 0., 1.],
        [0., 1., 1., 1., 0.]])</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>

<span class="n">X</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([[0., 1.],
        [0., 0.],
        [1., 0.],
        [0., 0.],
        [0., 0.]])</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">A</span> <span class="o">@</span> <span class="n">X</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([[1., 0.],
        [0., 0.],
        [0., 1.],
        [1., 1.],
        [1., 0.]])</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Dataset">
<a class="anchor" href="#Dataset" aria-hidden="true"><span class="octicon octicon-link"></span></a>Dataset<a class="anchor-link" href="#Dataset"> </a>
</h2>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">torch.utils.data</span>

<span class="kn">import</span> <span class="nn">importlib</span>  
<span class="n">gnns</span> <span class="o">=</span> <span class="n">importlib</span><span class="o">.</span><span class="n">import_module</span><span class="p">(</span><span class="s1">'powerful-gnns.util'</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">GraphDataset</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Dataset</span><span class="p">):</span>
    <span class="sd">""" Levanta los datasets de Powerful-GNNS. """</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">degree_as_tag</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">classes</span> <span class="o">=</span> <span class="n">gnns</span><span class="o">.</span><span class="n">load_data</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">degree_as_tag</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">features</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">node_features</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        
    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">):</span>
        <span class="n">graph</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
        <span class="n">adjacency_matrix</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">adjacency_matrix</span><span class="p">(</span> <span class="n">graph</span><span class="o">.</span><span class="n">g</span> <span class="p">)</span><span class="o">.</span><span class="n">todense</span><span class="p">()</span>
        
        <span class="n">item</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="n">item</span><span class="p">[</span><span class="s1">'adjacency_matrix'</span><span class="p">]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">adjacency_matrix</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
        <span class="n">item</span><span class="p">[</span><span class="s1">'node_features'</span><span class="p">]</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">node_features</span>
        <span class="n">item</span><span class="p">[</span><span class="s1">'label'</span><span class="p">]</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">label</span>
        
        <span class="k">return</span> <span class="n">item</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">DS</span> <span class="o">=</span> <span class="n">GraphDataset</span><span class="p">(</span><span class="s1">'PROTEINS'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>loading data
# classes: 2
# maximum node tag: 3
# data: 1113
</pre>
</div>
</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">DL</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span><span class="p">(</span><span class="n">DS</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Net-modules">
<a class="anchor" href="#Net-modules" aria-hidden="true"><span class="octicon octicon-link"></span></a>Net modules<a class="anchor-link" href="#Net-modules"> </a>
</h2>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">GINConv</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hidden_dim</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">linear</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">hidden_dim</span><span class="p">,</span> <span class="n">hidden_dim</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        Params</span>
<span class="sd">        ------</span>
<span class="sd">        A [batch x nodes x nodes]: adjacency matrix</span>
<span class="sd">        X [batch x nodes x features]: node features matrix</span>
<span class="sd">        </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        X' [batch x nodes x features]: updated node features matrix</span>
<span class="sd">        """</span>
        <span class="n">X</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">linear</span><span class="p">(</span><span class="n">X</span> <span class="o">+</span> <span class="n">A</span> <span class="o">@</span> <span class="n">X</span><span class="p">)</span>
        <span class="n">X</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">functional</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">X</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">GNN</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_dim</span><span class="p">,</span> <span class="n">hidden_dim</span><span class="p">,</span> <span class="n">output_dim</span><span class="p">,</span> <span class="n">n_layers</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">in_proj</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">input_dim</span><span class="p">,</span> <span class="n">hidden_dim</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">convs</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">ModuleList</span><span class="p">()</span>
        
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_layers</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">convs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">GINConv</span><span class="p">(</span><span class="n">hidden_dim</span><span class="p">))</span>
        
        <span class="c1"># In order to perform graph classification, each hidden state</span>
        <span class="c1"># [batch x nodes x hidden_dim] is concatenated, resulting in</span>
        <span class="c1"># [batch x nodes x hiddem_dim*(1+n_layers)], then aggregated</span>
        <span class="c1"># along nodes dimension, without keeping that dimension:</span>
        <span class="c1"># [batch x hiddem_dim*(1+n_layers)].</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">out_proj</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">hidden_dim</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">n_layers</span><span class="p">),</span> <span class="n">output_dim</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
        <span class="n">X</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">in_proj</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

        <span class="n">hidden_states</span> <span class="o">=</span> <span class="p">[</span><span class="n">X</span><span class="p">]</span>
        
        <span class="k">for</span> <span class="n">layer</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">convs</span><span class="p">:</span>
            <span class="n">X</span> <span class="o">=</span> <span class="n">layer</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span>
            <span class="n">hidden_states</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

        <span class="n">X</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">(</span><span class="n">hidden_states</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="n">X</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">out_proj</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">X</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Train-loop">
<a class="anchor" href="#Train-loop" aria-hidden="true"><span class="octicon octicon-link"></span></a>Train loop<a class="anchor-link" href="#Train-loop"> </a>
</h2>
</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">GNN</span><span class="p">(</span><span class="n">input_dim</span><span class="o">=</span><span class="n">DS</span><span class="o">.</span><span class="n">features</span><span class="p">,</span> <span class="n">hidden_dim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">output_dim</span><span class="o">=</span><span class="n">DS</span><span class="o">.</span><span class="n">classes</span><span class="p">,</span> <span class="n">n_layers</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="n">criterion</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">CrossEntropyLoss</span><span class="p">()</span>
<span class="n">optimizer</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="mf">0.01</span><span class="p">)</span>

<span class="n">EPOCHS</span> <span class="o">=</span> <span class="mi">5</span>

<span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">EPOCHS</span><span class="p">):</span>
    <span class="n">running_loss</span> <span class="o">=</span> <span class="mf">0.0</span>
    
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">batch</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">DL</span><span class="p">):</span>
        <span class="n">A</span> <span class="o">=</span> <span class="n">batch</span><span class="p">[</span><span class="s1">'adjacency_matrix'</span><span class="p">]</span>
        <span class="n">X</span> <span class="o">=</span> <span class="n">batch</span><span class="p">[</span><span class="s1">'node_features'</span><span class="p">]</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="n">batch</span><span class="p">[</span><span class="s1">'label'</span><span class="p">]</span>
                
        <span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>

        <span class="n">outputs</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">X</span><span class="p">)</span>
        <span class="n">loss</span> <span class="o">=</span> <span class="n">criterion</span><span class="p">(</span><span class="n">outputs</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
        <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
        <span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>

        <span class="n">running_loss</span> <span class="o">+=</span> <span class="n">loss</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'</span><span class="si">{</span><span class="n">epoch</span><span class="si">}</span><span class="s1"> - loss: </span><span class="si">{</span><span class="n">running_loss</span><span class="o">/</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="si">}</span><span class="s1">'</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>0 - loss: 1.2691171061103663
1 - loss: 0.32851389047806046
2 - loss: 0.944981049655904
3 - loss: 0.2894633889519622
4 - loss: 0.3056941165221455
</pre>
</div>
</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered">
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="TODO">
<a class="anchor" href="#TODO" aria-hidden="true"><span class="octicon octicon-link"></span></a>TODO<a class="anchor-link" href="#TODO"> </a>
</h2>
<ul>
<li>Dropout</li>
<li>Mini-batches (<code>collate_fn</code> for padding)</li>
<li>
<p>Batch normalization</p>
</li>
<li>
<p>Extended neighborhood <code>X = self.linear(X + A @ X + A**2 @ X)</code></p>
</li>
<li>Node classification</li>
<li>Link prediction</li>
</ul>

</div>
</div>
</div>
</div>



  </div><!-- from https://github.com/utterance/utterances -->
<script src="https://utteranc.es/client.js"
        repo="matiasbattocchia/datitos"
        issue-term="title"
        label="blogpost-comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script><a class="u-url" href="/datitos/Graph-isomorphism-network.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/datitos/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/datitos/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/datitos/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>Tutoriales de ciencia de datos | CC BY-SA 4.0</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"></ul>
</div>

  </div>

</footer>
</body>

</html>
