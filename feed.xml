<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="4.0.0">Jekyll</generator><link href="https://matiasbattocchia.github.io/datitos/feed.xml" rel="self" type="application/atom+xml" /><link href="https://matiasbattocchia.github.io/datitos/" rel="alternate" type="text/html" /><updated>2020-10-14T15:39:52-05:00</updated><id>https://matiasbattocchia.github.io/datitos/feed.xml</id><title type="html">datitos</title><subtitle>Tutoriales de ciencia de datos | CC BY-SA 4.0</subtitle><entry><title type="html">Salvar un DataFrame en Google Sheets</title><link href="https://matiasbattocchia.github.io/datitos/Salvar-un-DataFrame-en-Google-Sheets.html" rel="alternate" type="text/html" title="Salvar un DataFrame en Google Sheets" /><published>2020-10-13T00:00:00-05:00</published><updated>2020-10-13T00:00:00-05:00</updated><id>https://matiasbattocchia.github.io/datitos/Salvar-un-DataFrame-en-Google-Sheets</id><content type="html" xml:base="https://matiasbattocchia.github.io/datitos/Salvar-un-DataFrame-en-Google-Sheets.html">&lt;!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-10-13-Salvar-un-DataFrame-en-Google-Sheets.ipynb
--&gt;

&lt;div class=&quot;container&quot; id=&quot;notebook-container&quot;&gt;
        
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Este es uno de los mejores trucos que aprendí trabajando en &lt;a href=&quot;https://muttdata.ai&quot;&gt;Mutt Data&lt;/a&gt;. Del lado del desarrollo, en el día a día, trabajar con Pandas es de lo más común, tanto para análisis exploratorio de datos como manipulación de datos en general. Cuando existen otras partes interesadas en un proyecto, sobre todo personas de negocio, la comunicación es esencial y en Mutt nos iba bastante bien sacando a la luz &lt;code&gt;DataFrame&lt;/code&gt;s por medio de Google Sheets — ambos están hechos para trabajar con datos tabulares y lo bueno de los documentos de Google es que son fáciles de compartir y que las personas de negocio están acostumbradas a interactuar con hojas de cálculo.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;El paquete que vamos a usar se llama &lt;a href=&quot;https://gspread.readthedocs.io&quot;&gt;gspread&lt;/a&gt; y es una API en Python para Google Sheets.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;pip install gspread&lt;/code&gt;&lt;/pre&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Autenticaci&amp;#243;n&quot;&gt;Autenticaci&amp;#243;n&lt;a class=&quot;anchor-link&quot; href=&quot;#Autenticaci&amp;#243;n&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Vamos a necesitar una cuenta de servicio —que es un archivo con credenciales— para habilitar a nuestro programa a escribir en Google Sheets. Estas son las instrucciones.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Ir a la &lt;a href=&quot;https://console.cloud.google.com&quot;&gt;consola&lt;/a&gt; de Google Cloud Platform (GCP) y crear un proyecto nuevo o seleccionar uno existente (yo creé &lt;code&gt;mi-proyecto&lt;/code&gt;). Si nunca usaste GCP, vas a tener algunos pasos adicionales.&lt;/li&gt;
&lt;li&gt;En la barra de &lt;em&gt;Buscar productos y recursos&lt;/em&gt; buscar &lt;strong&gt;Google Drive API&lt;/strong&gt; y habilitarla.&lt;/li&gt;
&lt;li&gt;En la barra de &lt;em&gt;Buscar productos y recursos&lt;/em&gt; buscar &lt;strong&gt;Google Sheets API&lt;/strong&gt; y habilitarla.&lt;/li&gt;
&lt;li&gt;En la barra de &lt;em&gt;Buscar productos y recursos&lt;/em&gt; buscar &lt;strong&gt;cuentas de servicio&lt;/strong&gt;, en esa página:&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;+ Crear cuenta de servicio&lt;/strong&gt;, completar el formulario; con el nombre de la cuenta de servicio es suficiente (yo elegí &lt;code&gt;google-sheets&lt;/code&gt;).&lt;/li&gt;
&lt;li&gt;Una vez creada, seleccionarla para entrar en los detalles de la cuenta.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Claves &amp;gt; Agregar clave &amp;gt; Crear clave nueva &amp;gt; JSON &amp;gt; Crear&lt;/code&gt;. Aceptar la descarga de la cuenta de servicio. En mi caso, de &lt;code&gt;mi-proyecto-80a030363d28.json&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;Mover el archivo a la carpeta de trabajo. Debe estar en lugar seguro.&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;La cuenta de servicio servirá para todas las planillas de cálculo que necesitemos dentro de un mismo proyecto de GCP.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Acceso-a-la-hoja-de-c&amp;#225;lculo&quot;&gt;Acceso a la hoja de c&amp;#225;lculo&lt;a class=&quot;anchor-link&quot; href=&quot;#Acceso-a-la-hoja-de-c&amp;#225;lculo&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Este paso es mucho muy importante, &lt;strong&gt;debe realizarse cada vez que utilicemos una hoja de cálculo nueva&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;Ir a la hoja de cálculo y compartirla con el correo electrónico de la cuenta de servicio (es el que figura en el detalle de la cuenta) de la misma manera que haríamos para compartírsela a otra persona mediante su cuenta de correo.&lt;/p&gt;
&lt;p&gt;En mi caso, tengo que compartir las hojas con &lt;code&gt;google-sheets@mi-proyecto.iam.gserviceaccount.com&lt;/code&gt;.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Pandas&quot;&gt;Pandas&lt;a class=&quot;anchor-link&quot; href=&quot;#Pandas&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Esta es la función que utilizo para escribir un &lt;code&gt;DataFrame&lt;/code&gt; en Google Sheets. Hay algunas conversiones de tipos de datos, ya que Pandas y Google Sheets no manejan los mismos tipos.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;gspread&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;GSHEETS_CREDENTIALS&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;mi-proyecto-80a030363d28.json&amp;#39;&lt;/span&gt;


&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;save_to_gsheets&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sheet_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;worksheet_name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Sheet1&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;client&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;gspread&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;service_account&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;GSHEETS_CREDENTIALS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;sheet&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;client&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sheet_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;worksheet&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sheet&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;worksheet&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;worksheet_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;# convertimos el tipo de las columnas que sean datetime a string&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;column&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;columns&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dtypes&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;datetime64[ns]&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;column&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;column&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;astype&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;# reemplazamos valores NaN por strings vacíos&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;worksheet&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;update&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;columns&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;values&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tolist&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fillna&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;values&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tolist&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;

    &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;sa&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;DataFrame escrito en la hoja &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sheet_name&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt; / &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;worksheet_name&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;.&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Vamos con un ejemplo:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;np&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pandas&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pd&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DataFrame&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;random&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;randint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;columns&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;ABCD&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea output_execute_result&quot;&gt;
&lt;div&gt;
&lt;style scoped=&quot;&quot;&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;
  &lt;thead&gt;
    &lt;tr style=&quot;text-align: right;&quot;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;A&lt;/th&gt;
      &lt;th&gt;B&lt;/th&gt;
      &lt;th&gt;C&lt;/th&gt;
      &lt;th&gt;D&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;80&lt;/td&gt;
      &lt;td&gt;61&lt;/td&gt;
      &lt;td&gt;9&lt;/td&gt;
      &lt;td&gt;52&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;17&lt;/td&gt;
      &lt;td&gt;98&lt;/td&gt;
      &lt;td&gt;55&lt;/td&gt;
      &lt;td&gt;77&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;52&lt;/td&gt;
      &lt;td&gt;5&lt;/td&gt;
      &lt;td&gt;99&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;3&lt;/td&gt;
      &lt;td&gt;93&lt;/td&gt;
      &lt;td&gt;36&lt;/td&gt;
      &lt;td&gt;99&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;99&lt;/td&gt;
      &lt;td&gt;45&lt;/td&gt;
      &lt;td&gt;51&lt;/td&gt;
      &lt;td&gt;39&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;5&lt;/th&gt;
      &lt;td&gt;69&lt;/td&gt;
      &lt;td&gt;62&lt;/td&gt;
      &lt;td&gt;3&lt;/td&gt;
      &lt;td&gt;23&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;6&lt;/th&gt;
      &lt;td&gt;93&lt;/td&gt;
      &lt;td&gt;34&lt;/td&gt;
      &lt;td&gt;90&lt;/td&gt;
      &lt;td&gt;88&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Previamente tuve que crear la hoja &lt;code&gt;Ejemplo Pandas&lt;/code&gt; y darle acceso a la cuenta de servicio.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;save_to_gsheets&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Ejemplo Pandas&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;worksheet_name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Sheet1&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;DataFrame escrito en la hoja Ejemplo Pandas / Sheet1.
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Este es el resultado 📝.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/datitos/images/copied_from_nb/images/pandas_gsheets.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;</content><author><name>Matías Battocchia</name></author><summary type="html"></summary></entry><entry><title type="html">Preprocesamiento de texto para NLP (parte 3)</title><link href="https://matiasbattocchia.github.io/datitos/Preprocesamiento-de-texto-para-NLP-parte-3.html" rel="alternate" type="text/html" title="Preprocesamiento de texto para NLP (parte 3)" /><published>2020-10-13T00:00:00-05:00</published><updated>2020-10-13T00:00:00-05:00</updated><id>https://matiasbattocchia.github.io/datitos/Preprocesamiento-de-texto-para-NLP-parte-3</id><content type="html" xml:base="https://matiasbattocchia.github.io/datitos/Preprocesamiento-de-texto-para-NLP-parte-3.html">&lt;!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-10-13-Preprocesamiento-de-texto-para-NLP-parte-3.ipynb
--&gt;

&lt;div class=&quot;container&quot; id=&quot;notebook-container&quot;&gt;
        
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Este es el artículo final de la serie preprocesamiento de texto para NLP. Los artículos anteriores son &lt;a href=&quot;Preprocesamiento-de-texto-para-NLP-parte-1.html&quot;&gt;parte 1&lt;/a&gt; y &lt;a href=&quot;Preprocesamiento-de-texto-para-NLP-parte-2.html&quot;&gt;parte 2&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;En este nos vamos a focalizar en &lt;em&gt;embeddings&lt;/em&gt; pre-entrenados. Los &lt;em&gt;embeddings&lt;/em&gt; son un tema central en procesamiento del lenguaje y mucho se ha escrito al respecto. Acá hay algunos enlaces para introducrise en el tema&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://jalammar.github.io/illustrated-word2vec&quot;&gt;The illustrated Word2Vec&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://web.stanford.edu/class/cs224n/slides/cs224n-2020-lecture01-wordvecs1.pdf&quot;&gt;CS224n presentación &lt;em&gt;word vectors&lt;/em&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://web.stanford.edu/class/cs224n/assignments/a1_preview/exploring_word_vectors.html&quot;&gt;CS224n trabajo práctico &lt;em&gt;word vectors&lt;/em&gt;&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;y acá dejamos algunos enlaces sobre cómo algunos &lt;em&gt;frameworks&lt;/em&gt; abarcan el tema de este mismo artículo&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://keras.io/examples/nlp/pretrained_word_embeddings&quot;&gt;Keras&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://gluon-nlp.mxnet.io/examples/word_embedding/word_embedding.html&quot;&gt;Gluon&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Los embeddings son la primera capa en las redes neuronales que procesan texto. Mapean índices (a cada tóken le corresponde un índice, los índices corren de cero hasta &lt;code&gt;len(tókenes)&lt;/code&gt;). Estamos mapeando enteros a vectores, a cada índice le corresponde un vector de palabra que codifica a la palabra. El mapeo se realiza por medio de una matriz que tiene tantas filas como índices y tantas columnas como la dimensión de los vectores. Esta dimensión es un hiperparámetro del modelo y básicamente significa la cantidad de atributos con la que representaremos a las palabras. Elegir una fila de la matriz, y a cada índice/tóken le corresponde una fila) estamos rebanando la matriz de modo de quedarnos con un vector.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Como el resto de las capas de una red neuronal que no ha sido entrenada los pesos de la capa de &lt;em&gt;embeddings&lt;/em&gt; se inicializan al azar. O sea que al seleccionar un vector de palabra obtenemos un vector con componentes aleatorios. La idea central de los &lt;em&gt;embeddings&lt;/em&gt; es que las palabras adquieren significado a partir de las palabras que la rodean. Una vez que la red neural ha sido entrenada y que los componentes de los vectores de palabras no son azarosos sino que han capturado en mayor o menor medida el significado de las palabras, la distancia entre los vectores (&lt;a href=&quot;https://es.wikipedia.org/wiki/Similitud_coseno&quot;&gt;similitud del coseno&lt;/a&gt; es una forma de calcular la distancia entre vectores) de palabras similares es más corta, es decir los &lt;em&gt;embeddings&lt;/em&gt; están más cerca, que si cuando se consideran palabras con significados disímiles.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Una de las primeras técnicas de transfencia de aprendizaje (&lt;em&gt;transfer learning&lt;/em&gt;) fue utilizar &lt;em&gt;embeddings&lt;/em&gt; pre-entrenados. La red neuronal con la que son entrenados y la que los utiliza con otros fines pueden tener arquitecturas bien distintas, comparten solamente los vectores de palabras, es decir la primera capa. Vimos que el armado del vocabulario es un asunto central y sería extraño que adoptemos el mismo vocabulario que la red que se utilizó para entrenar los &lt;em&gt;embeddings&lt;/em&gt;; no es esto un problema mientras haya una intersección substancial entre el vocabulario que queremos utilizar y el que se utilizó para los &lt;em&gt;embeddings&lt;/em&gt;, ya que nos estamos limitando a este último, posiblemente entrenado con un corpus general (Wikipedia) mientras que el vocabulario que necesitamos posiblemente pertenezca a un corpus particular. Todos los tókenes que no están en el vocabulario se denominan &lt;strong&gt;fuera del vocabulario&lt;/strong&gt; (&lt;em&gt;out-of-vocabulary&lt;/em&gt; u OOV) y requieren un tratamiento especial como ser ignorados/eliminados o mapeados a un tóken especial que codifique tókenes desconocidos.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Los índices del vocabulario que crearemos tampoco será el mismo que los que se usaron para los vectores pre-entrenados. Por lo tanto la estrategia para obtener los pesos de la capa de vectores de palabra es la siguiente.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Descargar los vectores pre-entrenados&lt;/li&gt;
&lt;li&gt;Obtener los vectores del vocabulario propio&lt;/li&gt;
&lt;li&gt;Ordenar los vectores según los índices propios&lt;/li&gt;
&lt;li&gt;Crear un tensor&lt;/li&gt;
&lt;li&gt;Inicializar los pesos de la capa de &lt;em&gt;embeddings&lt;/em&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Descargar-los-vectores-pre-entrenados&quot;&gt;Descargar los vectores pre-entrenados&lt;a class=&quot;anchor-link&quot; href=&quot;#Descargar-los-vectores-pre-entrenados&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Los proyectos más conocidos son&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Word2Vec&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://nlp.stanford.edu/projects/glove/&quot;&gt;GloVe&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://fasttext.cc/docs/en/support.html&quot;&gt;fastText&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Vamos a usar fastText por tener vectores para idioma español y soporte para OOV. Primero instalamos el paquete de Python&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;pip install fasttext
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;y luego descargamos e inicializamos el modelo. Pesa unos 3,5 GB  así que la descarga puede demorar. La dimensión de los vectores de este modelo es 300.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;fasttext&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;fasttext.util&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;fasttext&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;util&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;download_model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;es&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;if_exists&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;ignore&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;ft&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fasttext&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;load_model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;cc.es.300.bin&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;strong&gt;IMPORTANTE&lt;/strong&gt;. Particularmente la carga de este modelo necesita de unos 12 GB de memoria RAM/swap, lo que me llevó a cerrar aplicaciones para liberar memoria. Para evitar pasar siempre por este paso, una vez que obtuve el tensor con los pesos necesarios lo salvé en un archivo; levantar este archivo es mucho más liviano.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Obtener-los-vectores-del-vocabulario&quot;&gt;Obtener los vectores del vocabulario&lt;a class=&quot;anchor-link&quot; href=&quot;#Obtener-los-vectores-del-vocabulario&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Redefinimos ligeramente la clase &lt;code&gt;Vocab&lt;/code&gt; que fuimos escribiendo en las partes anteriores. Lo nuevo es la propiedad &lt;code&gt;vocabulario&lt;/code&gt;, que devuelve la lista de tókenes del vocabulario.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# versión 5&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;np&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;itertools&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;chain&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;collections&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Counter&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Vocab&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# ningún cambio aquí&lt;/span&gt;
    &lt;span class=&quot;nd&quot;&gt;@property&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;índice_relleno&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mapeo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken_relleno&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;# ningún cambio aquí&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tóken_desconocido&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;lt;unk&amp;gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tóken_relleno&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;lt;pad&amp;gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;frecuencia_mínima&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;frecuencia_máxima&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                 &lt;span class=&quot;n&quot;&gt;longitud_mínima&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;longitud_máxima&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stop_words&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;límite_vocabulario&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken_desconocido&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tóken_desconocido&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken_relleno&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tóken_relleno&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;frecuencia_mínima&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;frecuencia_mínima&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;frecuencia_máxima&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;frecuencia_máxima&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;longitud_mínima&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;longitud_mínima&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;longitud_máxima&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;longitud_máxima&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stop_words&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stop_words&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;límite_vocabulario&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;límite_vocabulario&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;# ningún cambio aquí&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;reducir_vocabulario&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;contador_absoluto&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Counter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;chain&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
        
        &lt;span class=&quot;n&quot;&gt;contador_documentos&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Counter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;doc&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;contador_documentos&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;update&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;set&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;doc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
        
        &lt;span class=&quot;c1&quot;&gt;# frecuencia mínima&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;isinstance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;frecuencia_mínima&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# frecuencia de tóken&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;vocabulario_mín&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;frecuencia&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;contador_absoluto&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;most_common&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;frecuencia&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;frecuencia_mínima&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# frecuencia de documento&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;vocabulario_mín&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;frecuencia&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;contador_documentos&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;most_common&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;frecuencia&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;frecuencia_mínima&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        
        &lt;span class=&quot;c1&quot;&gt;# frecuencia máxima&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;isinstance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;frecuencia_máxima&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# frecuencia de tóken&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;vocabulario_máx&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;frecuencia&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;contador_absoluto&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;most_common&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;frecuencia_máxima&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;frecuencia&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# frecuencia de documento&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;vocabulario_máx&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;frecuencia&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;contador_documentos&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;most_common&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;frecuencia_máxima&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;frecuencia&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt;

        &lt;span class=&quot;c1&quot;&gt;# intersección de vocabulario_mín y vocabulario_máx preservando el órden&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;vocabulario&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vocabulario_mín&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vocabulario_máx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;

        &lt;span class=&quot;c1&quot;&gt;# longitud&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;vocabulario&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vocabulario&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;longitud_máxima&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;longitud_mínima&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        
        &lt;span class=&quot;c1&quot;&gt;# stop words&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;vocabulario&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vocabulario&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stop_words&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        
        &lt;span class=&quot;c1&quot;&gt;# límite&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;vocabulario&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vocabulario&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;límite_vocabulario&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vocabulario&lt;/span&gt;
        
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;fit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;vocabulario&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;
        
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken_relleno&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;vocabulario&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken_relleno&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken_desconocido&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;vocabulario&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken_desconocido&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        
        &lt;span class=&quot;n&quot;&gt;vocabulario&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reducir_vocabulario&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mapeo&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;índice&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;índice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;enumerate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vocabulario&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)}&lt;/span&gt;

        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;# ningún cambio aquí&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;transform&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken_desconocido&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# reemplazar&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mapeo&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken_desconocido&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;doc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;doc&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# ignorar&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;doc&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mapeo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;doc&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;# ningún cambio aquí&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;tókenes_a_índices&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;transform&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mapeo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;doc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;doc&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;# ningún cambio aquí&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;índices_a_tókenes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;mapeo_inverso&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mapeo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keys&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
        
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mapeo_inverso&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;índice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;índice&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;doc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;doc&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;# ningún cambio aquí&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;fm&quot;&gt;__len__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mapeo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;nd&quot;&gt;@property&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;vocabulario&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mapeo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keys&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Creamos el vocabulario como lo hicimos anteriormente (parte 1).&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pandas&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pd&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;read_csv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;train.csv&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sep&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;|&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;tokenizar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;texto&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# IMPORTANTE: podría devolver una lista vacía&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;texto&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;split&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()]&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;train_docs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tokenizar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;doc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;doc&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Pregunta&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;values&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;v&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Vocab&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_docs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Desde Python 3.7 está garantizado que el orden del diccionario es el orden de inserción. Por lo tanto el órden de la lista &lt;code&gt;v.vocabulario&lt;/code&gt; coincide con el del diccionario &lt;code&gt;v.mapeo&lt;/code&gt; (ver implementación de &lt;code&gt;Vocab&lt;/code&gt;). Tener claro el órden / los índices de los tókenes es importante porque crearemos un tensor de &lt;em&gt;embeddings&lt;/em&gt; al cuál accederemos mediante índices.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vocabulario&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;[&amp;#39;&amp;lt;pad&amp;gt;&amp;#39;, &amp;#39;&amp;lt;unk&amp;gt;&amp;#39;, &amp;#39;de&amp;#39;, &amp;#39;el&amp;#39;, &amp;#39;la&amp;#39;, &amp;#39;tarjeta&amp;#39;, &amp;#39;que&amp;#39;, &amp;#39;para&amp;#39;, &amp;#39;un&amp;#39;, &amp;#39;me&amp;#39;]&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Por ejemplo, el &lt;em&gt;embedding&lt;/em&gt; del tóken &lt;code&gt;tarjeta&lt;/code&gt; será &lt;code&gt;embeddings[5]&lt;/code&gt; ya que el tóken está en el quinto lugar del vocabulario (recordar que empezamos a contar por cero).&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;La interfaz de fastText para obtener un vector a partir de un tóken es como la de un diccionario. Así luce un &lt;em&gt;embedding&lt;/em&gt; de dimensión 300.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ft&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;tarjeta&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;array([ 0.06298134, -0.03280621,  0.03053921, -0.14426479, -0.04330583,
        0.02782611,  0.04671088,  0.01322352, -0.00091936, -0.02005653,
       -0.08679762, -0.00335382, -0.04299804,  0.03553167, -0.07989401,
        0.00514562,  0.06741733, -0.01824431, -0.0627635 , -0.03652998,
       -0.02327815, -0.06624147,  0.00762858,  0.04288524, -0.02111394,
       -0.02724549,  0.01001478, -0.0437385 , -0.07554701,  0.00330107,
       -0.00436452, -0.03166814, -0.02237143, -0.00398921, -0.00873911,
        0.01801448,  0.06549975,  0.02997639,  0.04104616,  0.08769971,
       -0.06594162, -0.01973427,  0.03386661, -0.05415446, -0.0547767 ,
       -0.00098864, -0.00864553,  0.05127762,  0.02343957, -0.00937056,
       -0.03792336,  0.06513872,  0.03453366,  0.00376538,  0.00911847,
        0.03639029, -0.04959448, -0.10815199,  0.0189229 , -0.00545404,
       -0.0441896 ,  0.05246361, -0.08793913,  0.01742068,  0.07848521,
        0.00829239,  0.00512537, -0.00187416,  0.06793492, -0.0205775 ,
        0.09385861,  0.06492148,  0.08256735, -0.01685029,  0.04042866,
       -0.03420147, -0.01297663, -0.03008673,  0.06171214, -0.0073834 ,
       -0.00952853, -0.07957197,  0.05753422, -0.00230803,  0.01646664,
        0.00405738,  0.01874345, -0.01656639,  0.03835326,  0.00671893,
        0.03538686, -0.05837374,  0.00655341, -0.06613984, -0.00893264,
        0.01970789, -0.02059824, -0.01957787,  0.04642227, -0.03362621,
       -0.03894996, -0.03437151, -0.0639662 , -0.00890221, -0.02950617,
        0.030174  ,  0.00092385,  0.08426531, -0.00274815,  0.00948968,
        0.04102866,  0.01430673,  0.01487885,  0.0998308 , -0.0284079 ,
       -0.00470919,  0.03808989,  0.08536439,  0.03592137,  0.07948075,
        0.0172466 , -0.07252405, -0.0107453 ,  0.0275656 ,  0.02603439,
        0.01865727, -0.10967878,  0.04329263, -0.03052348,  0.01704779,
       -0.05844689,  0.06367239,  0.00445418,  0.1319068 ,  0.02953896,
        0.02432506,  0.04764185,  0.04224063, -0.05673009, -0.00072847,
       -0.01646314,  0.0195642 ,  0.02678232, -0.02039818,  0.01072512,
        0.03165798,  0.02296546,  0.03048908,  0.00605224,  0.03494508,
       -0.03987421,  0.10772546,  0.05239586, -0.05665122, -0.04541425,
       -0.03411638,  0.00866744, -0.10566777, -0.06131719, -0.0434983 ,
        0.07758161, -0.05220485,  0.03249336, -0.12057097,  0.05518946,
       -0.00267152, -0.0791545 ,  0.00928127, -0.03528287, -0.07231892,
       -0.00943873,  0.02749985, -0.02224496,  0.001105  , -0.04838763,
        0.02414943,  0.00739839,  0.03333126,  0.0515946 , -0.0163026 ,
        0.06550607, -0.01794759,  0.07309239,  0.01166206, -0.01817643,
        0.00392749,  0.00703375,  0.03426434,  0.02729288, -0.00475265,
        0.01720353,  0.04551698, -0.02496281, -0.06664832, -0.02822311,
        0.03184071, -0.02069683, -0.03815257,  0.02659006,  0.18702458,
       -0.0493904 ,  0.02795539, -0.06647408,  0.02131662,  0.01693988,
        0.04659843, -0.04887157, -0.09692122, -0.07950865,  0.06913692,
       -0.0173317 ,  0.00877939, -0.06175148,  0.05520935,  0.04833567,
        0.00859433,  0.0169889 , -0.02598299,  0.0434835 , -0.03762854,
       -0.02821014, -0.00132759, -0.06334166,  0.00318673,  0.01190044,
       -0.02857058, -0.01841859, -0.00682279,  0.00447517, -0.01528993,
       -0.07283813,  0.00650864,  0.01897584, -0.00431945, -0.02006911,
        0.07013839, -0.02700875,  0.04124613, -0.01243533, -0.04903939,
       -0.01877775,  0.0053995 , -0.00930875, -0.03993747,  0.01549599,
       -0.01568508, -0.05651587,  0.06928204,  0.01355214, -0.0159476 ,
        0.04126405,  0.04020314,  0.10078269,  0.02648922,  0.06171743,
       -0.01357437,  0.0018341 , -0.00616703,  0.04361626,  0.00650506,
        0.05089275, -0.00275116,  0.02991083, -0.11814439, -0.01024311,
        0.07333191, -0.02508869,  0.01686102,  0.01045217, -0.07310145,
       -0.01285514,  0.09339073, -0.06714858, -0.09901267,  0.0068216 ,
        0.03572355, -0.03935919,  0.03302537,  0.02549176,  0.0144202 ,
       -0.02991694, -0.01354563, -0.00787938,  0.03613688,  0.05657197,
       -0.00474709, -0.02503674, -0.0273344 ,  0.05442371, -0.01384753,
        0.00932324, -0.04490621, -0.03971119,  0.02634538, -0.02593908,
        0.04915658,  0.04001555, -0.1161194 , -0.08524479, -0.04748566],
      dtype=float32)&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Veamos la distancia entre &lt;em&gt;embeddings&lt;/em&gt; de tókenes similares, por ejemplo debido a un error ortográfico, y la de tókenes disímiles, de diferente significado.&lt;/p&gt;
&lt;p&gt;Para ello utilizaré la similitud del coseno, una fórmula trigonométrica que en la definición de &lt;code&gt;scipy&lt;/code&gt; es igual a cero si ambos vectores apuntan a un mismo lugar; cualquier ángulo existente entre los vectores, arrojaría un valor mayor a cero.&lt;/p&gt;
&lt;p&gt;Los índices son cateorías que nada dicen de la relación entre las palabras pero los vectores sí.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Cosine_similarity&quot;&gt;https://en.wikipedia.org/wiki/Cosine_similarity&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://docs.scipy.org/doc/scipy/reference/generated/scipy.spatial.distance.cosine.html&quot;&gt;https://docs.scipy.org/doc/scipy/reference/generated/scipy.spatial.distance.cosine.html&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;scipy.spatial&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;distance&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;distance&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cosine&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ft&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;tarjeta&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ft&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;tarjeta&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;0.0&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Error ortográfico:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;distance&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cosine&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ft&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;tarjeta&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ft&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;targeta&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;0.18840116262435913&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Otra palabra:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;distance&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cosine&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ft&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;tarjeta&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ft&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;saldo&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;0.6775485575199127&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;La siguente función servirá para&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;obtener los vectores de cada uno de los tókenes del vocabulario,&lt;/li&gt;
&lt;li&gt;en el orden de los índices del vocabulario (es importante mantener este orden),&lt;/li&gt;
&lt;li&gt;convertirlos en tensores de PyTorch (&lt;code&gt;map&lt;/code&gt; aplica la función &lt;code&gt;torch.tensor&lt;/code&gt; a cada uno de los vectores),&lt;/li&gt;
&lt;li&gt;&lt;code&gt;list&lt;/code&gt; convierte el mapeo es una lista, ya que &lt;code&gt;map&lt;/code&gt; es &lt;em&gt;lazy&lt;/em&gt;, no acciona hasta que se lo piden y convertirlo en lista es una manera de pedirlo,&lt;/li&gt;
&lt;li&gt;&lt;code&gt;torch.stack&lt;/code&gt; apila los tensores de la lista (cada uno tiene dimensión 300 y la lista tiene largo $N$, el tamaño del vocabulario) en un tensor bidimensional de $N \times 300$.&lt;/li&gt;
&lt;/ol&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;torch&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# versión 1&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;obtener_embeddings&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tókenes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fastText&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    
    &lt;span class=&quot;n&quot;&gt;embeddings&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fastText&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tókenes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stack&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tensor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;embeddings&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;embeddings&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;obtener_embeddings&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vocabulario&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ft&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;embeddings&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;tensor([[-0.0503, -0.0404,  0.0759,  ...,  0.0252, -0.0356, -0.0142],
        [ 0.0093,  0.0350,  0.0453,  ..., -0.0111, -0.0165, -0.0326],
        [ 0.0547,  0.0112,  0.1910,  ...,  0.0066, -0.0021, -0.0230],
        ...,
        [-0.0278, -0.0258,  0.0990,  ...,  0.0018, -0.0074, -0.0465],
        [ 0.0149, -0.0274,  0.0268,  ...,  0.0571,  0.0106, -0.0065],
        [-0.0097,  0.0221, -0.0038,  ..., -0.0042,  0.0152,  0.0462]])&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Entonces ahora podemos salvarlos para no tener que volver a generarlos, obviando así cargar el modelo de fastText.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;save&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;embeddings&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;vectores.pkl&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Si queremos cargarlos más adelante:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;embeddings&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;load&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;vectores.pkl&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Extra:-bolsa-de-palabras&quot;&gt;Extra: bolsa de palabras&lt;a class=&quot;anchor-link&quot; href=&quot;#Extra:-bolsa-de-palabras&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Hay una forma simple y efectiva de obtener la representación de un documento, si bien existen otras que son mejores. Los vectores son representaciones de tókenes, los documentos son conjuntos de tókenes, calcular la suma, el promedio o el máximo de los vectores del conjunto nos da un vector que es la representación del documento. Como esta agregación no tiene en cuenta el orden de los tókenes en el documento se llama &lt;strong&gt;bolsa de palabras&lt;/strong&gt;, o en inglés &lt;em&gt;bag of words&lt;/em&gt;.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cambio_cien&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;obtener_embeddings&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;señor&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;tiene&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;cambio&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;de&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;cien&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ft&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;cambio_cien&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;torch.Size([5, 300])&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Hacemos la agregación es en sentido de las columnas, cada columna o dimensión del &lt;em&gt;embedding&lt;/em&gt; es un atributo o &lt;em&gt;feature&lt;/em&gt; del tóken, queremos obtener los atributos para el documento.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cambio_cien&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cambio_cien&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dim&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;cambio_cien&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;torch.Size([300])&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Representación de una variante del documento:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cambio_mil&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;obtener_embeddings&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;señor&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;tiene&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;cambio&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;de&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;mil&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ft&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;cambio_mil&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cambio_mil&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dim&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Representación de un documento bien diferente:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;extravío&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;obtener_embeddings&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;extravié&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;mi&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;tarjeta&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;de&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;débito&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;anoche&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ft&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;extravío&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;extravío&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dim&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Ahora veamos las distancias entre los documentos.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;distance&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cosine&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cambio_cien&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cambio_mil&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;0.08124548196792603&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;distance&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cosine&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cambio_cien&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;extravío&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;0.39364296197891235&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Vemos que &lt;code&gt;señor tiene cambio de cien&lt;/code&gt; está más cerca de &lt;code&gt;señor tiene cambio de mil&lt;/code&gt; que de &lt;code&gt;extravié mi tarjeta de débito anoche&lt;/code&gt;.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;En la parte 2 hube mencionado a &lt;code&gt;nn.EmbeddingBag&lt;/code&gt; sin contar su finalidad; es un módulo de PyTorch que hace exactamento esto: recibe un tensor con índices de tókenes de documentos, reemplaza a los índices por vectores y los agrega en un vector por documento, usando una función que puede ser &lt;code&gt;mean&lt;/code&gt;, &lt;code&gt;max&lt;/code&gt;, &lt;code&gt;sum&lt;/code&gt;.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Inicializar-los-pesos-de-la-capa-de-embeddings&quot;&gt;Inicializar los pesos de la capa de &lt;em&gt;embeddings&lt;/em&gt;&lt;a class=&quot;anchor-link&quot; href=&quot;#Inicializar-los-pesos-de-la-capa-de-embeddings&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;El método &lt;code&gt;copy_&lt;/code&gt; carga el tensor de los pesos en el módulo de &lt;em&gt;embeddings&lt;/em&gt;. Para que la carga funcione las dimensiones del tensor de pesos debe ser exactamente igual a las de la capa. Inicializamosla con cantidad de filas igual al largo del vocabulario y cantidad de columnas igual al tamaño de los vectores.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;capa&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;EmbeddingBag&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ft&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get_dimension&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mode&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;mean&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;capa&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;EmbeddingBag(8116, 300, mode=mean)&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Chequeamos las dimensiones del tensor de pesos.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;embeddings&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;torch.Size([8116, 300])&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Al inicializar la capa, sus pesos se inicializan con valores al azar. Es con el entrenamiento que adquieren valores significativos para red neuronal. Los &lt;em&gt;embeddings&lt;/em&gt; pre-entrenados sirven justamente para comenzar con valores con sentido, lo que acorta los tiempos de aprendizaje de la red en general.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;capa&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;weight&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;copy_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;embeddings&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;tensor([[-0.0503, -0.0404,  0.0759,  ...,  0.0252, -0.0356, -0.0142],
        [ 0.0093,  0.0350,  0.0453,  ..., -0.0111, -0.0165, -0.0326],
        [ 0.0547,  0.0112,  0.1910,  ...,  0.0066, -0.0021, -0.0230],
        ...,
        [-0.0278, -0.0258,  0.0990,  ...,  0.0018, -0.0074, -0.0465],
        [ 0.0149, -0.0274,  0.0268,  ...,  0.0571,  0.0106, -0.0065],
        [-0.0097,  0.0221, -0.0038,  ..., -0.0042,  0.0152,  0.0462]])&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;índices&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tókenes_a_índices&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;señor&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;tiene&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;cambio&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;de&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;cien&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;señor&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;tiene&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;cambio&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;de&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;mil&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;extravié&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;mi&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;tarjeta&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;de&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;débito&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;anoche&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;índices&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;[[1, 119, 142, 2, 1], [1, 119, 142, 2, 1311], [2268, 11, 5, 2, 149, 1443]]&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Por cómo creamos el vocabulario y por cómo está definida la clase &lt;code&gt;Vocab&lt;/code&gt;, el tóken &lt;code&gt;&amp;lt;unk&amp;gt;&lt;/code&gt; de tóken desconocido o fuera del vocabulario tiene asignado el índice &lt;code&gt;1&lt;/code&gt;; esto será relevante más adelante.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Recordemos que a este módulo le gusta que los documentos sean contiguos (un único documento) y que por otro lado le informemos en qué posiciones de ese documento contiguo comienza cada uno de los documentos.&lt;/p&gt;
&lt;p&gt;Veamos el largo de cada uno de los documentos.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;índices&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;[5, 5, 6]&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;El primer documento siempre comienza en la posición &lt;code&gt;0&lt;/code&gt;, el segundo lo hace &lt;code&gt;5&lt;/code&gt; tókenes/índices después, y el tercero en 5 luego del segundo, o sea en la posición &lt;code&gt;10&lt;/code&gt;.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;posiciones&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tensor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Ahora convertimos a los documentos en un documento único y además en un tensor.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;índices&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tensor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;
    &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;119&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;142&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;119&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;142&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1311&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2268&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;11&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;149&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1443&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Luego de estos procesamientos la capa ejecuta las mismas operaciones que realizamos manualmente.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vectores&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;capa&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;índices&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;posiciones&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;vectores&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;torch.Size([3, 300])&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Lo que podemos verificar calculando la distancia entre &lt;code&gt;señor tiene cambio de cien&lt;/code&gt; está más cerca de &lt;code&gt;señor tiene cambio de mil&lt;/code&gt;, que manualmente dio $0.081$.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;distance&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cosine&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vectores&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;detach&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;numpy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vectores&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;detach&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;numpy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;0.1781657338142395&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;strong&gt;Y no se cumplió&lt;/strong&gt;. 😵&lt;/p&gt;
&lt;p&gt;La explicación está en las palabras fuera del vocabulario. Los &lt;em&gt;embeddings&lt;/em&gt; pre-entrenados no suelen venir con pesos para tókenes especiales como &lt;code&gt;&amp;lt;unk&amp;gt;&lt;/code&gt; y al hacer &lt;code&gt;ft['&amp;lt;unk&amp;gt;']&lt;/code&gt;, fastText que está preparado para generar vectores para tókenes con los cuales no fue entrenado, devuelve un vector con pesos sin sentido. Es decir, fastText es muy útil para obtener vectores aproximados cuando le preguntamos por un tóken que no conoce pero que es parecido a otros que sí, sin embargo &lt;code&gt;&amp;lt;unk&amp;gt;&lt;/code&gt; no se a parece a ningún otro. Nota: Word2Vec y GloVe no tienen soporte para tókenes fuera del vocabulario (OOV), en el caso de &lt;code&gt;&amp;lt;unk&amp;gt;&lt;/code&gt; no hubieran devuelto ningún valor.&lt;/p&gt;
&lt;p&gt;¿Qué podríamos haber hecho?&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Si contamos con soporte para OOV (fastText), no usar el tóken &lt;code&gt;&amp;lt;unk&amp;gt;&lt;/code&gt; ya que no es necesario. Para ello deberíamos haber creado el vocabulario inicilizando la clase &lt;code&gt;Vocab&lt;/code&gt; con el argumento &lt;code&gt;tóken_desconocido=None&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;Si no hay soporte para OOV, salvo que el modelo especifique que cuenta con un vector para el tóken especial &lt;em&gt;desconocido&lt;/em&gt; (y que no necesariamente se simbolizará con &lt;code&gt;&amp;lt;unk&amp;gt;&lt;/code&gt;), no usar el tóken &lt;code&gt;&amp;lt;unk&amp;gt;&lt;/code&gt; ya que no es posible.&lt;/li&gt;
&lt;li&gt;Entrenar vectores desde cero. Al existir &lt;code&gt;&amp;lt;unk&amp;gt;&lt;/code&gt;, este adquire pesos con el sentido propuesto. No era la idea.&lt;/li&gt;
&lt;li&gt;Crear un vector a partir de los existentes, según está expresado en esta &lt;a href=&quot;https://stackoverflow.com/questions/49239941/what-is-unk-in-the-pretrained-glove-vector-files-e-g-glove-6b-50d-txt&quot;&gt;respuesta de StackOverflow&lt;/a&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;Creando-un-vector-desconocido&quot;&gt;Creando un vector desconocido&lt;a class=&quot;anchor-link&quot; href=&quot;#Creando-un-vector-desconocido&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;La respuesta de StackOverflow del último punto sugiere que el &lt;strong&gt;vector promedio de todos los vectores&lt;/strong&gt; o, de al menos los que se van a usar, conforman un buen vector desconocido.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;unk&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;embeddings&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dim&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;unk&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;torch.Size([300])&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Creando-un-vector-de-relleno&quot;&gt;Creando un vector de relleno&lt;a class=&quot;anchor-link&quot; href=&quot;#Creando-un-vector-de-relleno&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Otro tóken especial que consideramos es el relleno, &lt;code&gt;&amp;lt;pad&amp;gt;&lt;/code&gt;, que sirve para completar los espacios en documentos de distinto largo cuando los queremos agrupar en un tensor. Normalmente los pesos para este vector son todos ceros.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pad&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ft&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get_dimension&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;pad&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;torch.Size([300])&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pad&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;torch.Size([300])&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Incluyendo-los-nuevos-cambios&quot;&gt;Incluyendo los nuevos cambios&lt;a class=&quot;anchor-link&quot; href=&quot;#Incluyendo-los-nuevos-cambios&quot;&gt; &lt;/a&gt;&lt;/h3&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# versión 2&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;obtener_embeddings&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tókenes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fastText&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tóken_desconocido&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;lt;unk&amp;gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tóken_relleno&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;lt;pad&amp;gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    
    &lt;span class=&quot;n&quot;&gt;embeddings&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fastText&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tókenes&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken_desconocido&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tóken_relleno&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;embeddings&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stack&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;map&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tensor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;embeddings&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tóken_desconocido&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;unk&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;embeddings&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dim&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;keepdim&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;embeddings&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;unk&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;embeddings&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tóken_relleno&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;pad&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zeros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;fastText&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get_dimension&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;embeddings&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;embeddings&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;embeddings&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;embeddings&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;obtener_embeddings&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vocabulario&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ft&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;embeddings&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;tensor([[ 0.0000,  0.0000,  0.0000,  ...,  0.0000,  0.0000,  0.0000],
        [ 0.0008, -0.0102,  0.0071,  ..., -0.0066,  0.0097, -0.0056],
        [ 0.0547,  0.0112,  0.1910,  ...,  0.0066, -0.0021, -0.0230],
        ...,
        [-0.0278, -0.0258,  0.0990,  ...,  0.0018, -0.0074, -0.0465],
        [ 0.0149, -0.0274,  0.0268,  ...,  0.0571,  0.0106, -0.0065],
        [-0.0097,  0.0221, -0.0038,  ..., -0.0042,  0.0152,  0.0462]])&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Inicializar-los-pesos-en-un-modelo&quot;&gt;Inicializar los pesos en un modelo&lt;a class=&quot;anchor-link&quot; href=&quot;#Inicializar-los-pesos-en-un-modelo&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Respecto del modelo de la parte 2, la diferencia está en el método &lt;code&gt;init_weights&lt;/code&gt; que carga el tensor de los pesos en la capa de &lt;em&gt;embeddings&lt;/em&gt; y que es llamado durante la inicialización del modelo. Recordemos: para que la carga funcione (&lt;code&gt;copy_&lt;/code&gt;) las dimensiones del tensor de pesos debe ser exactamente igual a las de la capa de &lt;em&gt;embedding&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;Además &lt;strong&gt;congelamos los pesos&lt;/strong&gt; (&lt;code&gt;requires_grad = False&lt;/code&gt;) para que no cambien durante el entrenamiento. Lo que se aconseja es entrenar el resto de las capas hasta que la función de pérdida se estabilice; dejar libres a los pesos de la capa de &lt;em&gt;embeddings&lt;/em&gt; cuando el resto de la red tiene pesos con valores aleatorios hará que los &lt;em&gt;embeddings&lt;/em&gt; varíen significativamente durante el aprendizaje y pierdan sentido. Suele ser útil descongelar los pesos una vez que el modelo ha alcanzado cierto nivel de aprendizaje para efectuar un aprendizaje fino, en el que los &lt;em&gt;embeddings&lt;/em&gt; se adaptarán al problema en cuestión.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;torch.nn&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;nn&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;torch.nn.functional&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;F&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;DIM_EMBEDDINGS&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;ClasificadorBolsa&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Module&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vocab_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;embed_dim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num_class&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;super&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;embedding&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;EmbeddingBag&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vocab_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;embed_dim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sparse&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mode&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;max&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fc&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Linear&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;embed_dim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num_class&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;c1&quot;&gt;# inicializamos los pesos&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;init_weights&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;init_weights&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;embedding&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;weight&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;copy_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;embeddings&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;embedding&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;weight&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;requires_grad&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;forward&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;text&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;offsets&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;embedded&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;embedding&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;text&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;offsets&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;embedded&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;nn.Embedding&quot;&gt;nn.Embedding&lt;a class=&quot;anchor-link&quot; href=&quot;#nn.Embedding&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Hemos visto con algo de detalle el módulo de PyTorch &lt;code&gt;nn.EmbeddingBag&lt;/code&gt;, una capa de doble acción: convierte índices en vectores y calcula un vector agregado, una forma simple de obtener una representación de un documento, aunque no la más efectiva de todas. Para lograr mejores representaciones encontramos en uso modelos más complejos. La primera capa de modelos que usan capas LSTM o Transformer es una &lt;code&gt;nn.Embedding&lt;/code&gt;, que a diferencia de la mencionada anteriormente es de simple acción: convierte índices en vectores y ya.&lt;/p&gt;
&lt;p&gt;Quiero ilustrar brevemente cómo son la entrada y la salida de esta capa, ya que son bien diferentes a las de &lt;code&gt;nn.EmbeddingBag&lt;/code&gt;. La inicialización sin embargo, es similar. El tensor de los pesos tendrá las dimensiones de tamaño del vocabulario por la dimensión (valga la redundancia) de los &lt;em&gt;embeddings&lt;/em&gt;.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;capa&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Embedding&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ft&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get_dimension&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;padding_idx&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;índice_relleno&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Diferentemente, como esta capa requiere el uso del tóken de relleno, podemos especificar el índice del tóken para que la capa inicialice sus pesos al azar excepto los de este vector, que será inicializado en cero. Si lo deseamos, podemos utilizar vectores pre-entrenados.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;capa&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;weight&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;copy_&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;embeddings&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;capa&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;weight&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;requires_grad&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Ahora armaremos un lote de documentos y lo convertiremos en un tensor. Para poder hacer esto último es fundamental que los documentos tengan el mismo largo (que será igual al del documento más largo), así que nos valdremos del tóken de relleno para lograrlo.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;índices&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tókenes_a_índices&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;señor&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;tiene&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;cambio&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;de&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;cien&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;lt;pad&amp;gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;señor&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;tiene&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;cambio&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;de&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;mil&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;lt;pad&amp;gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;extravié&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;mi&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;tarjeta&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;de&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;débito&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;anoche&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;índices&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tensor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;índices&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;índices&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;torch.Size([3, 6])&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Tenemos un tensor bidimensional, la dimensión 0 (filas) es la cantidad de documentos del lote, la dimensión 1 (columnas) es el tamaño de los documentos.&lt;/p&gt;
&lt;p&gt;Así luce el tensor de índices.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;índices&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;tensor([[   1,  119,  142,    2,    1,    0],
        [   1,  119,  142,    2, 1311,    0],
        [2268,   11,    5,    2,  149, 1443]])&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Ahora lo hacemos pasar por la capa de &lt;em&gt;embeddings&lt;/em&gt;.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vectores&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;capa&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;índices&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;vectores&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;torch.Size([3, 6, 300])&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Observamos que la capa anadió una nueva dimensión, ahora tenemos un tensor tridimensional. Reemplazó cada índice (un escalar) por su vector correspondiente de largo 300. La dimensión 2 (profundidad) siempre corresponderá al tamaño del &lt;em&gt;embedding&lt;/em&gt;.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Aquí termina la serie de artículos de pre-procesamiento de texto. Gracias por haber llegado hasta el fin.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;</content><author><name>Matías Battocchia</name></author><summary type="html"></summary></entry><entry><title type="html">Ejemplo de cómo usar Ignite</title><link href="https://matiasbattocchia.github.io/datitos/PyTorch-Ignite.html" rel="alternate" type="text/html" title="Ejemplo de cómo usar Ignite" /><published>2020-08-01T00:00:00-05:00</published><updated>2020-08-01T00:00:00-05:00</updated><id>https://matiasbattocchia.github.io/datitos/PyTorch-Ignite</id><content type="html" xml:base="https://matiasbattocchia.github.io/datitos/PyTorch-Ignite.html">&lt;!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-08-01-PyTorch-Ignite.ipynb
--&gt;

&lt;div class=&quot;container&quot; id=&quot;notebook-container&quot;&gt;
        
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Recientemente han salido varias librerías de alto nivel para PyTorch. Una vez planteados los datasets y los modelos todavía queda bastante por programar, sobre todo los bucles de entrenamiento y validación, código que salvando detalles de implementación es siempre el mismo (&lt;em&gt;boilerplate&lt;/em&gt;). Librerías como &lt;a href=&quot;https://pytorch-lightning.readthedocs.io&quot;&gt;PyTorch Lighting&lt;/a&gt; y &lt;a href=&quot;https://pytorch.org/ignite&quot;&gt;PyTorch Ignite&lt;/a&gt; prometen ahorrarnos el código repetitivo y concentrarnos en lo particular.&lt;/p&gt;
&lt;p&gt;Se instala con&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;pip install pytorch-ignite
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;torch&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sklearn.metrics&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;balanced_accuracy_score&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;ignite.engine&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Engine&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Events&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;ignite.metrics&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Accuracy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Loss&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cuda&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;is_available&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;device&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;device&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;cuda&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;device&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;device&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;cpu&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Definimos el triángulo modelo-optimizador-criterio. Lo de siempre.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;modelo&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Modelo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;device&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;optimizador&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;optim&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Adam&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;modelo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;parameters&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1e-3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;weight_decay&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1e-5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;criterio&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;CrossEntropyLoss&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;strong&gt;Bucle de entrenamiento&lt;/strong&gt;.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;entrenar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;motor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;modelo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;optimizador&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zero_grad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    
    &lt;span class=&quot;n&quot;&gt;predicciones&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;modelo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;documentos&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;device&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;pérdida&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;criterio&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;predicciones&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;etiquetas&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;device&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    
    &lt;span class=&quot;n&quot;&gt;pérdida&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;backward&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;optimizador&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;step&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pérdida&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;item&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;


&lt;span class=&quot;n&quot;&gt;entrenador&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Engine&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;entrenar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;strong&gt;Bucle de evaluación&lt;/strong&gt;. Sirve para todo lo que no es entrenamiento, a ser validación e inferencia.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;evaluar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;motor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;modelo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;eval&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;no_grad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;predicciones&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;modelo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;documentos&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;device&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;# validación&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;etiquetas&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;is&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;predicciones&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;etiquetas&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;device&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;# inferencia&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;predicciones&lt;/span&gt;


&lt;span class=&quot;n&quot;&gt;evaluador&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Engine&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;evaluar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;inferidor&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Engine&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;evaluar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Adjuntamos algunas métricas al evaluador. Notar que &lt;code&gt;entrenar&lt;/code&gt; devuelve el valor de la función de pérdida mientras que &lt;code&gt;evaluar&lt;/code&gt; devuelve predicciones.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Accuracy&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;attach&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;evaluador&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;accuracy&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;Loss&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;criterio&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;attach&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;evaluador&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;loss&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Evento&lt;/strong&gt;: al completar una época de entrenamiento.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Acción&lt;/strong&gt;: registrar métricas del dataset de &lt;strong&gt;entrenamiento&lt;/strong&gt;. Para ello usamos &lt;code&gt;evaluador.run(train_dl)&lt;/code&gt;.&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;nd&quot;&gt;@entrenador&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;on&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Events&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;EPOCH_COMPLETED&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;loguear_resultados_entrenamiento&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;entrenador&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;evaluador&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_dl&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;# accedemos a este atributo gracias a haber adjuntado métricas previamente&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;métricas&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;evaluador&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;metrics&lt;/span&gt;
    
    &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;sa&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;[&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;entrenador&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;epoch&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;02&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;] TRAIN  Accuracy: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;métricas&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;accuracy&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;.2f&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;  Loss: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;métricas&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;loss&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;.2f&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Evento&lt;/strong&gt;: al completar una época de entrenamiento. &lt;em&gt;Acá podría ser al completar X épocas para no validar tan seguido&lt;/em&gt;.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Acción&lt;/strong&gt;: registrar métricas del dataset de &lt;strong&gt;validación&lt;/strong&gt;. Para ello usamos &lt;code&gt;evaluador.run(valid_dl)&lt;/code&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Esta función podría hacer sido más parecida a la de arriba pero no lo es porque queremos calcular una métrica que no viene con &lt;em&gt;Ignite&lt;/em&gt;. Tenemos dos opciones, definir una métrica adjuntable como &lt;code&gt;ignite.metrics.Accuracy&lt;/code&gt; —que no lo hicimos y quizás hubiese sido lo mejor— o poner la lógica en la función, como vemos aquí.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;nd&quot;&gt;@entrenador&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;on&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Events&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;EPOCH_COMPLETED&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;loguear_resultados_validación&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;entrenador&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# esta artimaña tendrá sentido más adelante&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;evaluador&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;predicciones&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;evaluador&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;etiquetas&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;
    
    &lt;span class=&quot;n&quot;&gt;evaluador&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;valid_dl&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;# de todas las categorías nos quedamos con la más probable para cada muestra&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;predicciones&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;evaluador&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;predicciones&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argmax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dim&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cpu&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;etiquetas&lt;/span&gt;    &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;evaluador&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;etiquetas&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cpu&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    
    &lt;span class=&quot;n&quot;&gt;score&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;balanced_accuracy_score&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;etiquetas&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;predicciones&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;n&quot;&gt;métricas&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;evaluador&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;metrics&lt;/span&gt;
    
    &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;sa&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;[&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;entrenador&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;epoch&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;02&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;] VALID  Accuracy: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;métricas&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;accuracy&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;.2f&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;  Loss: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;métricas&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;loss&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;.2f&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;  Balanced accuracy: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;score&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;.2f&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&amp;quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Evento&lt;/strong&gt;: al procesar un lote de validación.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Acción&lt;/strong&gt;: almacenar predicciones y etiquetas.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Esto le da sentido a la artimaña que mencionamos. La misma sirve para instanciar listas vacías al inicio de la validación, a las que se le agregaran los resultados de cada lote.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;nd&quot;&gt;@evaluador&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;on&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Events&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ITERATION_COMPLETED&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;colectar_validaciones_lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;evaluador&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;evaluador&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;predicciones&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;evaluador&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;evaluador&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;etiquetas&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;evaluador&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Evento&lt;/strong&gt;: al completar el entrenamiento (todas las épocas).&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Acción&lt;/strong&gt;: realizar inferencias. Para ello usamos &lt;code&gt;inferidor.run(infer_dl)&lt;/code&gt;.&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;nd&quot;&gt;@entrenador&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;on&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Events&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;COMPLETED&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;colectar_inferencias&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;entrenador&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Realizando inferencias...&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;# mismo truco de antes&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;inferidor&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_pred&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;
    
    &lt;span class=&quot;n&quot;&gt;inferidor&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;infer_dl&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;# de todas las categorías nos quedamos con la más probable para cada muestra&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;y_pred&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inferidor&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_pred&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;argmax&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dim&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reshape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;# quizás sea un buen momento para recuperar las categorías originales&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;#y_pred = vocabulario_etiquetas.índices_a_tókenes(y_pred)&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;# ya que estamos, guardamos los resultados en un CSV&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DataFrame&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_pred&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to_csv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;submit.csv&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;header&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Evento&lt;/strong&gt;: al procesar un lote de inferencia.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Acción&lt;/strong&gt;: almacenar predicciones.&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;nd&quot;&gt;@inferidor&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;on&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Events&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ITERATION_COMPLETED&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;colectar_inferencias_lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inferidor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;inferidor&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_pred&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inferidor&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;state&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;output&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Finalmente largamos el entrenamiento con &lt;code&gt;entrenador.run(train_dl)&lt;/code&gt;. Este es el engranaje principal del mecanismo, que al completar bucles moverá a los otros engranajes (&lt;code&gt;Engine&lt;/code&gt;s, que no son literalmente enganajes pero puede que sea una buena metáfora).&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;entrenador&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_dl&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;max_epochs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;[01] VALID  Accuracy: 0.80  Loss: 1.11  Balanced accuracy: 0.75
[01] TRAIN  Accuracy: 0.98  Loss: 0.02
[02] VALID  Accuracy: 0.80  Loss: 1.11  Balanced accuracy: 0.75
[02] TRAIN  Accuracy: 0.98  Loss: 0.02
[03] VALID  Accuracy: 0.80  Loss: 1.11  Balanced accuracy: 0.75
[03] TRAIN  Accuracy: 0.98  Loss: 0.02
[04] VALID  Accuracy: 0.80  Loss: 1.11  Balanced accuracy: 0.75
[04] TRAIN  Accuracy: 0.98  Loss: 0.02
[05] VALID  Accuracy: 0.80  Loss: 1.11  Balanced accuracy: 0.75
[05] TRAIN  Accuracy: 0.98  Loss: 0.02
Realizando inferencias...
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Recursos&quot;&gt;Recursos&lt;a class=&quot;anchor-link&quot; href=&quot;#Recursos&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://neptune.ai/blog/model-training-libraries-pytorch-ecosystem&quot;&gt;8 Creators and Core Contributors Talk About Their Model Training Libraries From PyTorch Ecosystem&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;</content><author><name>Matías Battocchia</name></author><summary type="html"></summary></entry><entry><title type="html">Preprocesamiento de texto para NLP (parte 2)</title><link href="https://matiasbattocchia.github.io/datitos/Preprocesamiento-de-texto-para-NLP-parte-2.html" rel="alternate" type="text/html" title="Preprocesamiento de texto para NLP (parte 2)" /><published>2020-07-30T00:00:00-05:00</published><updated>2020-07-30T00:00:00-05:00</updated><id>https://matiasbattocchia.github.io/datitos/Preprocesamiento-de-texto-para-NLP-parte-2</id><content type="html" xml:base="https://matiasbattocchia.github.io/datitos/Preprocesamiento-de-texto-para-NLP-parte-2.html">&lt;!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-07-30-Preprocesamiento-de-texto-para-NLP-parte-2.ipynb
--&gt;

&lt;div class=&quot;container&quot; id=&quot;notebook-container&quot;&gt;
        
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;En la &lt;a href=&quot;Preprocesamiento-de-texto-para-NLP-parte-1.html&quot;&gt;primera parte&lt;/a&gt; llegamos a convertir esto&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;
    &lt;span class=&quot;s1&quot;&gt;&amp;#39;que se requiere para un prestamo personal&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s1&quot;&gt;&amp;#39;me piden mi numero de cuenta es mi cbu&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;en esto&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4160&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4683&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4484&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3703&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5294&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4011&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3825&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3275&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3854&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3319&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3554&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1532&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1462&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2151&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3319&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;950&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;donde dijimos que las partes fundamentales son la tokenización —separar a los documentos en unidades de información— y la numericalización —el asignarle a cada uno de los tókenes un número, más que nada para que la computadora, que gusta mucho de los números, sea feliz—.&lt;/p&gt;
&lt;p&gt;También habíamos dicho que &lt;strong&gt;un tóken es un atributo&lt;/strong&gt; pero no dijimos mucho más al respecto. Veamos cómo puede ser esto. La tarea de ejemplo es clasificar documentos. Estamos acustumbrados a tener muestras y etiquetas como &lt;code&gt;X&lt;/code&gt; e &lt;code&gt;y&lt;/code&gt; en las que la primera es una matriz de muestras (filas) y atributos (columnas), y la segunda suele ser una columna. Cuando el dataset está sin pre-procesar tenemos las muestras (filas) pero no los atributos (columnas), por lo general tenemos una única columna con los documentos en forma de strings, lo que mucha forma de atributos no tiene.&lt;/p&gt;
&lt;p&gt;Ahora que hemos pre-procesado el texto estamos a un paso de obtener los atributos. La función de los atributos es describir o caracterizar a las muestras. El modelo lee estos atributos para realizar inferencias. Hay distintas maneras de describir a los documentos, algunas más sofisticadas que otras, una intuitiva es aprovechar que los tókenes están numerados desde 0 hasta L (&lt;code&gt;len(vocabulario)&lt;/code&gt;) y otorgarle una columna a cada uno en la matriz de atributos de tamaño N x L (donde N es la cantidad de muestras).&lt;/p&gt;
&lt;p&gt;Hecho esto, solo resta contar cuántas veces aparece cada tóken en cada documento y asentarlo en la matriz.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;                  |  bien  hola  si    todo
-------------------------------------------
'hola todo bien'  |  1     1     0     1
'si bien bien'    |  2     0     1     0&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Como comentario, esta forma de describir los documentos ignora enteramente el órden de los tókenes, sabemos que el sentido de una oración puede cambir completamente si cambiamos algunas palabras de lugar. Para el problema en cuestión, no parece ser tan grave ya que para clasificar una pregunta podría bastar con reconocer algunas palabras claves como &lt;em&gt;cambio&lt;/em&gt; y &lt;em&gt;clave&lt;/em&gt; o &lt;em&gt;requisito&lt;/em&gt; y &lt;em&gt;préstamo&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;Ver &lt;a href=&quot;https://es.wikipedia.org/wiki/Tf-idf&quot;&gt;tf-idf&lt;/a&gt;.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;PyTorch&quot;&gt;PyTorch&lt;a class=&quot;anchor-link&quot; href=&quot;#PyTorch&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;El típico bucle de entrenamiento de PyTorch tiene esta pinta.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;época&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;N_ÉPOCAS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;datos_entrenamiento&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# reseteamos los gradientes&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;optimizador&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zero_grad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

        &lt;span class=&quot;n&quot;&gt;predicciones&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;red_neuronal&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;pérdida&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;criterio&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;predicciones&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;c1&quot;&gt;# calculamos los gradientes&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;pérdida&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;backward&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

        &lt;span class=&quot;c1&quot;&gt;# aplicamos los gradientes&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;optimizador&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;step&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Recordemos que a diferencia de otros modelos las redes neuronales revisitan varias veces el dataset, en lo que se llaman épocas, cada época es un recorrido por todas las muestras de entrenamiento.&lt;/p&gt;
&lt;p&gt;En una época el dataset se puede mostrar entero, de a una muestra, o como es común hoy en día de a grupos o lotes (&lt;em&gt;batches&lt;/em&gt;). La experiencia mostró que es útil variar el orden de las muestras en cada época.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;PyTorch provee ciertas facilidades para el manejo de los datos con las clases definidas en &lt;a href=&quot;https://pytorch.org/docs/stable/data.html&quot;&gt;torch.utils.data&lt;/a&gt; a ser:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code&gt;Dataset&lt;/code&gt;. Organiza los datos. Le pasamos un número o índice de muestra y nos devuelve la muestra usualmente como una tupla &lt;code&gt;(atributos, etiqueta)&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Sampler&lt;/code&gt;. Salvo que lo queramos de otra manera, se encarga de brindar un orden aleatoreo de los índices del dataset; uno diferente cada vez que le preguntamos.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;BatchSampler&lt;/code&gt;. Por defecto, se inicializa con un &lt;code&gt;Sampler&lt;/code&gt; y el tamaño de lote. Se encarga de armar grupos de índices; diferentes cada vez que le preguntamos.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;DataLoader&lt;/code&gt;. Valiéndose de los grupos de índices de &lt;code&gt;BatchSampler&lt;/code&gt;, obtiene muestras de &lt;code&gt;Dataset&lt;/code&gt;. De esta manera para cada época devuelve lotes de muestras al azar.  &lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Por &lt;code&gt;Sampler&lt;/code&gt; y &lt;code&gt;BatchSampler&lt;/code&gt; no nos detendremos ya el comportamiento por defecto, que es barajar el dataset en cada época y armar lotes del mismo tamaño es todo lo que necesitamos.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Dataset&quot;&gt;Dataset&lt;a class=&quot;anchor-link&quot; href=&quot;#Dataset&quot;&gt; &lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;torch.utils.data&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Dataset&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Textset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Dataset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;documentos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;etiquetas&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
            
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;documentos&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;documentos&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;etiquetas&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;etiquetas&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;or&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;full&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;documentos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nan&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;fm&quot;&gt;__len__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;documentos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;fm&quot;&gt;__getitem__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;item&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;documentos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;item&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;etiquetas&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;item&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Es una clase que necesita implementar &lt;code&gt;__len__&lt;/code&gt; y &lt;code&gt;__getitem__&lt;/code&gt;. Podría encargarse de levantar y pre-procesar el dataset, que por comodidad lo hemos cargado con Pandas y pre-procesado por fuera: el constructor (&lt;code&gt;__init__&lt;/code&gt;) podría recibir el nombre del archivo, leerlo y aplicarle las funciones pertinentes. No lo hemos hecho internamente porque el vocabulario debe nutrirse del dataset de entrenamiento ya pre-procesado [falta].&lt;/p&gt;
&lt;p&gt;También necesitaremos crear un &lt;code&gt;Textset&lt;/code&gt; para el dataset de inferencia, para el cual no contamos con las etiquetas. En el caso de no pasar etiquetas generamos una lista llena de NaNs del mismo largo que la lista de documentos.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_ds&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Textset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_índices&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;etiquetas_train_índices&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_ds&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;18093&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_ds&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10_000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;([8, 169, 1, 4652, 0, 17, 65], 40)&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Es bastante similar a lo que una lista de tuplas podría lograr, aunque fue una buena oportunidad para juntar los documentos y las etiquetas que luego de cargar el DataFrame y hasta ahora recorrieron caminos separados. Lo realmente importante es el &lt;code&gt;DataLoader&lt;/code&gt;, no podemos usar una lista como dataset porque requiere que sea una instancia de &lt;code&gt;Dataset&lt;/code&gt;.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;DataLoader&quot;&gt;DataLoader&lt;a class=&quot;anchor-link&quot; href=&quot;#DataLoader&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;&lt;code&gt;DataLoader&lt;/code&gt; es un &lt;em&gt;iterable&lt;/em&gt;. Los iterables son colecciones de elementos que se pueden recorrer; implementan el método &lt;code&gt;__iter__&lt;/code&gt;, del que se espera que devuelva un objeto &lt;em&gt;iterador&lt;/em&gt; (&lt;code&gt;iterador = iter(iterable)&lt;/code&gt;). A su vez el iterador implementa el método &lt;code&gt;__next__&lt;/code&gt; que se encarga devolver secuencialmente los elementos de la colección hasta que se agota; una vez que esto sucede el iterador debe ser descartado y en todo caso le pedimos al iterable que nos arme un nuevo iterador. Cuando usamos la construcción &lt;code&gt;for ítem in iterable&lt;/code&gt;, el intérprete de Python implícitamente obtiene un iterador.&lt;/p&gt;
&lt;p&gt;Ver la &lt;a href=&quot;https://docs.python.org/3/tutorial/classes.html#iterators&quot;&gt;sección de interables&lt;/a&gt; en el tutorial de Python.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lista&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;iter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;uno&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;dos&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;next&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lista&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;&amp;#39;uno&amp;#39;&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;next&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lista&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;&amp;#39;dos&amp;#39;&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;next&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lista&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_text output_error&quot;&gt;
&lt;pre&gt;
&lt;span class=&quot;ansi-red-fg&quot;&gt;---------------------------------------------------------------------------&lt;/span&gt;
&lt;span class=&quot;ansi-red-fg&quot;&gt;StopIteration&lt;/span&gt;                             Traceback (most recent call last)
&lt;span class=&quot;ansi-green-fg&quot;&gt;&amp;lt;ipython-input-203-cfa830c9416d&amp;gt;&lt;/span&gt; in &lt;span class=&quot;ansi-cyan-fg&quot;&gt;&amp;lt;module&amp;gt;&lt;/span&gt;
&lt;span class=&quot;ansi-green-fg&quot;&gt;----&amp;gt; 1&lt;/span&gt;&lt;span class=&quot;ansi-red-fg&quot;&gt; &lt;/span&gt;next&lt;span class=&quot;ansi-blue-fg&quot;&gt;(&lt;/span&gt;lista&lt;span class=&quot;ansi-blue-fg&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;ansi-red-fg&quot;&gt;StopIteration&lt;/span&gt;: &lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;No hay próximo elemento. Cuando se llega al fin del iterador se levanta la excepción &lt;code&gt;StopIteration&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Suficientes detalles por ahora. Todo esto para decir que &lt;code&gt;DataLoader&lt;/code&gt; es un iterable que particularmente devuelve un iterador distinto cada vez, a diferencia de una lista en la que los elementos siempre se recorren en el mismo orden. Es decir, se trata de una colección de lotes pero cada iterador agrupa lotes según como dicte &lt;code&gt;BatchSampler&lt;/code&gt;, que suele ser aleatorio.&lt;/p&gt;
&lt;p&gt;En cada &lt;strong&gt;época&lt;/strong&gt; le pedimos un iterador a &lt;code&gt;DataLoader&lt;/code&gt;, por lo que recorremos todo el &lt;code&gt;Dataset&lt;/code&gt; agrupado en lotes de manera diferente cada vez.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;torch.utils.data&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DataLoader&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;train_dl&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DataLoader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_ds&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;shuffle&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Le estamos diciendo a &lt;code&gt;DataLoader&lt;/code&gt; que queremos lotes de 32 muestras (&lt;code&gt;batch_size&lt;/code&gt;) y que el armado de los lotes sea aleatorio (&lt;code&gt;shuffle&lt;/code&gt;).&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;un_lote&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;next&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;iter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_dl&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;un_lote&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;[[tensor([  12, 5168,   26,    9,   16,    8,   24,   10,    8,   15,   49,   49,
            46,   16,   15,    8,    1,   62,   26,   12,    8,    7,   12,  157,
            44, 2082,    5,   62,    1,   76,    8,   74]),
  tensor([ 140,   10,   75,    4,    4,   22,   84, 1519,   48,   75,   27,  357,
           105,   40,   48, 1911,  213,  585,   14,   48,   19,  203,  102,  164,
            57,    0,    2,   22, 1009,  262,  274,  630]),
  tensor([  17,   51,  371, 1058,   64,    4,   71,   27,   17,    9,    1,    2,
            59,   57,    2,    6,    0,  928,   62,    6, 1973,    3,   17,  713,
            10,   36,   56,    4,   18,   21,    1,    5]),
  tensor([  56,   67,   83,    0,   22,  724,   18,   24,    3,  765,   64,  207,
          1454,    2,  765,   36,  179,    2,  358,   13,   38,  236,   56,    3,
             3,    0,    5,   32,    1,   98, 1009,    6])],
 tensor([144, 153, 247,   3,  55,   0, 223,  15,  18,   6,  26, 160,  89, 199,
         149,  49, 260, 285,  13,   3, 198,  18,  23,   0,   1, 103,  35, 112,
         128,  20, 128,   3])]&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Está bueno que ya veamos tensores de PyTorch porque vamos a necesitar los datos en forma de tensor para alimentar a la red neuronal. Sin embargo, algo no parece andar bien con el lote que acabamos de obtener.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;un_lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;2&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Tenemos dos elementos adentro del lote, podríamos pensar que el primero agrupa documentos y el segundo, etiquetas.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;un_lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]),&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;un_lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;(torch.Tensor, 32)&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Las etiquetas del lote están perfecto, son un tensor de una dimensión con largo 32.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;un_lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]),&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;un_lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;(list, 4)&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;En cambio la agrupación de documentos no tiene sentido. Es otra lista de tamaño 4 con tensores adentro. ¿Qué está pasando?&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Tensores&quot;&gt;Tensores&lt;a class=&quot;anchor-link&quot; href=&quot;#Tensores&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;El problema parece radicar en los tensores. Son estructuras que las podemos imaginar como una columna cuando tienen una dimensión, una tabla cuando son dos, un cubo cuando tres...&lt;/p&gt;
&lt;p&gt;Los tensores son similares a los &lt;code&gt;ndarrays&lt;/code&gt; de NumPy, con el aditivo que también pueden ser usados en la GPU para acelerar los cómputos. Ver más de tensores en el &lt;a href=&quot;https://pytorch.org/tutorials/beginner/blitz/tensor_tutorial.html&quot;&gt;tutorial de PyTorch&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;En el caso de los documentos que a la altura del &lt;code&gt;Dataset&lt;/code&gt; son listas de listas de índices, son dos dimensiones, y al llevarlos a una tabla vemos que tendríamos tantas filas como documentos y tantas columnas como índices tenga el documento más largo de la colección pero que &lt;strong&gt;no todos los documentos tienen tantos índices como columnas la tabla&lt;/strong&gt;.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;índices&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;índices&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;[[2, 2], [4, 4, 4, 4], [7, 7, 7, 7, 7, 7, 7]]&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;torch&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tensor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;índices&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_text output_error&quot;&gt;
&lt;pre&gt;
&lt;span class=&quot;ansi-red-fg&quot;&gt;---------------------------------------------------------------------------&lt;/span&gt;
&lt;span class=&quot;ansi-red-fg&quot;&gt;ValueError&lt;/span&gt;                                Traceback (most recent call last)
&lt;span class=&quot;ansi-green-fg&quot;&gt;&amp;lt;ipython-input-232-121200966211&amp;gt;&lt;/span&gt; in &lt;span class=&quot;ansi-cyan-fg&quot;&gt;&amp;lt;module&amp;gt;&lt;/span&gt;
&lt;span class=&quot;ansi-green-intense-fg ansi-bold&quot;&gt;      1&lt;/span&gt; &lt;span class=&quot;ansi-green-fg&quot;&gt;import&lt;/span&gt; torch
&lt;span class=&quot;ansi-green-intense-fg ansi-bold&quot;&gt;      2&lt;/span&gt; 
&lt;span class=&quot;ansi-green-fg&quot;&gt;----&amp;gt; 3&lt;/span&gt;&lt;span class=&quot;ansi-red-fg&quot;&gt; &lt;/span&gt;torch&lt;span class=&quot;ansi-blue-fg&quot;&gt;.&lt;/span&gt;tensor&lt;span class=&quot;ansi-blue-fg&quot;&gt;(&lt;/span&gt;índices&lt;span class=&quot;ansi-blue-fg&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;ansi-red-fg&quot;&gt;ValueError&lt;/span&gt;: expected sequence of length 2 at dim 1 (got 4)&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Como anticipamos, no le gustó nada.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;T&amp;#243;kenes-especiales&quot;&gt;T&amp;#243;kenes especiales&lt;a class=&quot;anchor-link&quot; href=&quot;#T&amp;#243;kenes-especiales&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Lo mencionamos al pasar, a veces se utilizan tókenes especiales como &lt;code&gt;&amp;lt;separador de palabra&amp;gt;&lt;/code&gt;, &lt;code&gt;&amp;lt;separador de oración&amp;gt;&lt;/code&gt;, &lt;code&gt;&amp;lt;inicio del texto&amp;gt;&lt;/code&gt;, &lt;code&gt;&amp;lt;fin del texto&amp;gt;&lt;/code&gt;. Hay de todo tipo, según la tarea a realizar. Uno que está presente generalmente en los proyectos es el tóken de relleno &lt;code&gt;&amp;lt;relleno&amp;gt;&lt;/code&gt; (en inglés &lt;em&gt;padding&lt;/em&gt;).&lt;/p&gt;
&lt;p&gt;El tóken de relleno nos va a servir para hacer que todos los documentos tengan el mismo largo y finalmente podamos convertirlos en un tensor. No lo vamos a hacer inmediatamente ya que no nos interesa que tengan el mismo largo en todo el dataset sino en todo el lote. Como los lotes son generados en el DataLoader, este último tendrá que encargarse de rellenar los documentos.&lt;/p&gt;
&lt;p&gt;Vamos a modificar &lt;code&gt;Vocab&lt;/code&gt; quien se encarga de la lista de tókenes para que incluya a &lt;code&gt;&amp;lt;relleno&amp;gt;&lt;/code&gt;.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# versión 4&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;np&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;itertools&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;chain&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;collections&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Counter&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Vocab&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;
    &lt;span class=&quot;nd&quot;&gt;@property&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;índice_relleno&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mapeo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken_relleno&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tóken_desconocido&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;lt;unk&amp;gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tóken_relleno&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;lt;pad&amp;gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;frecuencia_mínima&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;frecuencia_máxima&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                 &lt;span class=&quot;n&quot;&gt;longitud_mínima&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;longitud_máxima&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stop_words&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;límite_vocabulario&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken_desconocido&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tóken_desconocido&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken_relleno&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tóken_relleno&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;frecuencia_mínima&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;frecuencia_mínima&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;frecuencia_máxima&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;frecuencia_máxima&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;longitud_mínima&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;longitud_mínima&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;longitud_máxima&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;longitud_máxima&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stop_words&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stop_words&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;límite_vocabulario&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;límite_vocabulario&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;# ningún cambio aquí&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;reducir_vocabulario&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;contador_absoluto&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Counter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;chain&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
        
        &lt;span class=&quot;n&quot;&gt;contador_documentos&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Counter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;doc&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;contador_documentos&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;update&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;set&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;doc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
        
        &lt;span class=&quot;c1&quot;&gt;# frecuencia mínima&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;isinstance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;frecuencia_mínima&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# frecuencia de tóken&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;vocabulario_mín&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;frecuencia&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;contador_absoluto&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;most_common&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;frecuencia&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;frecuencia_mínima&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# frecuencia de documento&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;vocabulario_mín&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;frecuencia&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;contador_documentos&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;most_common&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;frecuencia&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;frecuencia_mínima&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        
        &lt;span class=&quot;c1&quot;&gt;# frecuencia máxima&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;isinstance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;frecuencia_máxima&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# frecuencia de tóken&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;vocabulario_máx&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;frecuencia&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;contador_absoluto&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;most_common&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;frecuencia_máxima&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;frecuencia&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# frecuencia de documento&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;vocabulario_máx&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;frecuencia&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;contador_documentos&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;most_common&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;frecuencia_máxima&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;frecuencia&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt;

        &lt;span class=&quot;c1&quot;&gt;# intersección de vocabulario_mín y vocabulario_máx preservando el órden&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;vocabulario&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vocabulario_mín&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vocabulario_máx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;

        &lt;span class=&quot;c1&quot;&gt;# longitud&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;vocabulario&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vocabulario&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;longitud_máxima&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;longitud_mínima&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        
        &lt;span class=&quot;c1&quot;&gt;# stop words&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;vocabulario&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vocabulario&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stop_words&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        
        &lt;span class=&quot;c1&quot;&gt;# límite&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;vocabulario&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vocabulario&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;límite_vocabulario&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vocabulario&lt;/span&gt;
        
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;fit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;vocabulario&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reducir_vocabulario&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken_desconocido&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;vocabulario&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken_desconocido&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken_relleno&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;vocabulario&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;insert&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken_relleno&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mapeo&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;índice&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;índice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;enumerate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vocabulario&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)}&lt;/span&gt;

        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;# ningún cambio aquí&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;transform&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken_desconocido&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# reemplazar&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mapeo&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken_desconocido&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;doc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;doc&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# ignorar&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;doc&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mapeo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;doc&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;# ningún cambio aquí&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;tókenes_a_índices&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;transform&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mapeo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;doc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;doc&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;# ningún cambio aquí&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;índices_a_tókenes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;mapeo_inverso&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mapeo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keys&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
        
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mapeo_inverso&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;índice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;índice&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;doc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;doc&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;fm&quot;&gt;__len__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mapeo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;El índice del tóken de relleno suele ser 0 y para continuar con esta tradición en vez de hacerle &lt;code&gt;append&lt;/code&gt; al vocabulario le hicimos un &lt;em&gt;prepend&lt;/em&gt; para que el tóken encabece el listado. Además usamos el decorador &lt;code&gt;@property&lt;/code&gt; para tener un atributo &lt;code&gt;índice_relleno&lt;/code&gt; (en vez de un método) que nos devuelva el índice del tóken.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Vocab&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_docs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;v&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;índice_relleno&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;0&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;La-funci&amp;#243;n-que-rellena&quot;&gt;La funci&amp;#243;n que rellena&lt;a class=&quot;anchor-link&quot; href=&quot;#La-funci&amp;#243;n-que-rellena&quot;&gt; &lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;rellenar_documentos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;largos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;índice_relleno&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;máximo_largo&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;max&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;largos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;doc&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;índice_relleno&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;máximo_largo&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;largos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;doc&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;enumerate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Le tenemos que pasar el lote, el largo o tamaño de cada documento del lote y el índice de relleno.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;índices&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;largos&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;rellenos&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rellenar_documentos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;índices&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;largos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;índice_relleno&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;rellenos&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;[[2, 2, 0, 0, 0, 0, 0], [4, 4, 4, 4, 0, 0, 0], [7, 7, 7, 7, 7, 7, 7]]&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tensor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rellenos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;tensor([[2, 2, 0, 0, 0, 0, 0],
        [4, 4, 4, 4, 0, 0, 0],
        [7, 7, 7, 7, 7, 7, 7]])&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;¡Ahora sí funcionó!&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Tama&amp;#241;o-del-documento&quot;&gt;Tama&amp;#241;o del documento&lt;a class=&quot;anchor-link&quot; href=&quot;#Tama&amp;#241;o-del-documento&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Vamos a incluir el tamaño del documento (en cantidad de tókenes/índices) junto a cada ítem del dataset ya que nos va a hacer falta para la función que rellena.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;torch.utils.data&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Dataset&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Textset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Dataset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;documentos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;etiquetas&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
            
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;documentos&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;documentos&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;etiquetas&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;etiquetas&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;or&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;full&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;documentos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nan&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;fm&quot;&gt;__len__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;documentos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;fm&quot;&gt;__getitem__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;item&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;documentos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;item&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;documentos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;item&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]),&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;etiquetas&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;item&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_ds&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Textset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_índices&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;etiquetas_train_índices&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;train_ds&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10_000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;([8, 169, 1, 4652, 0, 17, 65], 7, 40)&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Bonus:-AtributoDiccionario&quot;&gt;Bonus: &lt;strong&gt;Atri&lt;/strong&gt;buto&lt;strong&gt;Dicc&lt;/strong&gt;ionario&lt;a class=&quot;anchor-link&quot; href=&quot;#Bonus:-AtributoDiccionario&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;¿Alguna vez quisiste acceder a los elementos de un diccionario como si fuesen atributos de un objeto? Es decir así&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;uno&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;dos&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;tres&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;uno&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# =&amp;gt; 1&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;en vez de así&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;d&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;uno&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# =&amp;gt; 1&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Con esta magia ahora es posible:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# https://stackoverflow.com/questions/4984647/accessing-dict-keys-like-an-attribute&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;AtriDicc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;kwargs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;vm&quot;&gt;__dict__&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;dict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;kwargs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;fm&quot;&gt;__repr__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;repr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;vm&quot;&gt;__dict__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;AtriDicc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;uno&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dos&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tres&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;uno&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;1&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Vamos a &lt;em&gt;pimpiar&lt;/em&gt; la clase &lt;code&gt;Textset&lt;/code&gt; con esto para que en vez de devolver elementos del dataset como tuplas &lt;code&gt;(documento, largo, etiqueta)&lt;/code&gt; en el que debemos acordarnos que el orden de los elementos, devolvemos un &lt;code&gt;AtriDicc&lt;/code&gt; en el que accedemos las cosas por su nombre y es más cómodo que un diccionario.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;torch.utils.data&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Dataset&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Textset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Dataset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;documentos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;etiquetas&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
            
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;documentos&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;documentos&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;etiquetas&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;etiquetas&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;or&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;full&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;documentos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nan&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;fm&quot;&gt;__len__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;documentos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;fm&quot;&gt;__getitem__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;item&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;AtriDicc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;documento&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;documentos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;item&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;largo&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;documentos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;item&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]),&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;etiqueta&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;  &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;etiquetas&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;item&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
        &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_ds&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Textset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_índices&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;etiquetas_train_índices&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;train_ds&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10_000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;documento&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;[8, 169, 1, 4652, 0, 17, 65]&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Funci&amp;#243;n-collate&quot;&gt;Funci&amp;#243;n &lt;em&gt;collate&lt;/em&gt;&lt;a class=&quot;anchor-link&quot; href=&quot;#Funci&amp;#243;n-collate&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;&lt;em&gt;Collate&lt;/em&gt; significa juntar diferentes piezas de información para ver sus similaridades y diferencias, también puede ser colectar y organizar las hojas de un reporte, un libro. En el contexto de &lt;code&gt;DataLoader&lt;/code&gt; quiere decir arreglar el lote. Entonces esta función recibe una lista de elementos del &lt;code&gt;Dataset&lt;/code&gt;, en nuestro caso una lista de de &lt;code&gt;AtriDicc&lt;/code&gt;s, y debe devolver el lote en una forma útil y en lo posible realizar conversiones a tensores.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;DataLoader&lt;/code&gt; posee una &lt;em&gt;collate function&lt;/em&gt; por defecto que utiliza internamente y que en muchos casos funciona correctamente, pero otros como ahora que tenemos documentos de distinto largo nos toca definir una función propia.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;rellenar_lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;sd&quot;&gt;&amp;quot;&amp;quot;&amp;quot;Prepara lotes para ingresar a nn.Embedding&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;documentos&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;elemento&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;documento&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;elemento&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;largos&lt;/span&gt;     &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;elemento&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;largo&lt;/span&gt;     &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;elemento&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;etiquetas&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;elemento&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;etiqueta&lt;/span&gt;  &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;elemento&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;

    &lt;span class=&quot;n&quot;&gt;rellenos&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rellenar_documentos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;documentos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;largos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;índice_relleno&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;AtriDicc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;documentos&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tensor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rellenos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;etiquetas&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tensor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;etiquetas&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Cuando instanciamos un &lt;code&gt;DataLoader&lt;/code&gt; le pasamos la función que acabamos de definir.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_dl&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DataLoader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_ds&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;collate_fn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rellenar_lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;shuffle&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;un_lote&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;next&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;iter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_dl&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;un_lote&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;documentos&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;tensor([[781,  31,  17, 104, 111,   9, 383,  93,  18,  11, 489,   0,   0],
        [ 20,   4,  11,   7, 272,  78,  29,  96,   5, 396,  16,  86,  16],
        [ 26,  69,  17, 313,   4, 258,  22,   4, 102,   0,   0,   0,   0]])&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;un_lote&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;etiquetas&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;tensor([ 80, 316,  16])&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Funciona de maravillas.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Una-funci&amp;#243;n-alternativa&quot;&gt;Una funci&amp;#243;n alternativa&lt;a class=&quot;anchor-link&quot; href=&quot;#Una-funci&amp;#243;n-alternativa&quot;&gt; &lt;/a&gt;&lt;/h3&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;La función anterior es compatible con el módulo de PyTorch &lt;code&gt;nn.Embedding&lt;/code&gt; que suele se la puerta de entrada en los modelos de procesamiento de texto. Todavía no hemos hablado nada de los &lt;em&gt;embeddings&lt;/em&gt;. Quizás sea un momento para mencionar a &lt;code&gt;nn.EmbeddingBag&lt;/code&gt;, que tiene requerimientos completamente diferentes al primer módulo.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;offsetear_lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;sd&quot;&gt;&amp;quot;&amp;quot;&amp;quot;Prepara lotes para ingresar a nn.EmbeddingBag&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;documentos&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tensor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;elemento&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;documento&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;elemento&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;offsets&lt;/span&gt;    &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;elemento&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;largo&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;elemento&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][:&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; 
    &lt;span class=&quot;n&quot;&gt;etiquetas&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;elemento&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;etiqueta&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;elemento&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;AtriDicc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;documentos&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;documentos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;offsets&lt;/span&gt;    &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tensor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;offsets&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cumsum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dim&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;etiquetas&lt;/span&gt;  &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tensor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;etiquetas&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Esta función yuxtapone los documentos por un lado, y por otro (&lt;code&gt;offsets&lt;/code&gt;) indica cuándo comienza cada documento en ese continuo.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_dl&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DataLoader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_ds&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;collate_fn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;offsetear_lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;shuffle&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;un_lote&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;next&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;iter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_dl&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;un_lote&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;documentos&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;tensor([  35,   14,    8,  544,   46,    6, 2493,   30,  384,    2, 1062,   27,
         236,    5,  778,  378,   22,    4,   53,    1,  866,    9,   17, 1564,
         109,   68,  186,   16,    6, 1419])&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;un_lote&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;offsets&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;tensor([ 0,  9, 16])&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Avanzado:-Memory-pinning&quot;&gt;Avanzado: Memory pinning&lt;a class=&quot;anchor-link&quot; href=&quot;#Avanzado:-Memory-pinning&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://pytorch.org/docs/stable/data.html#memory-pinning&quot;&gt;https://pytorch.org/docs/stable/data.html#memory-pinning&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Esta técnica consiste en pre-disponibilizar los tensores en el GPU. Llevar un lote del disco o de la memoria a la GPU insume tiempo y puede causar un cuello de botella durante el entrenamiento.&lt;/p&gt;
&lt;p&gt;Pasar la opción &lt;code&gt;pin_memory=True&lt;/code&gt; al &lt;code&gt;DataLoader&lt;/code&gt; pondrá automáticamente a los tensores en la &lt;em&gt;pinned memory&lt;/em&gt;. Por defecto funciona con tensores y colecciones de tensores. Cuando los lotes son de un tipo personalizado (por ejemplo &lt;code&gt;AtriDicc&lt;/code&gt;), normal cuando se utiliza una &lt;em&gt;collate function&lt;/em&gt; propia, es necesario que el tipo defina el método &lt;code&gt;pin_memory&lt;/code&gt;.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;AttrDict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;kwargs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;vm&quot;&gt;__dict__&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;dict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;kwargs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;fm&quot;&gt;__repr__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;repr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;vm&quot;&gt;__dict__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;pin_memory&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;atributo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;valor&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;vm&quot;&gt;__dict__&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;items&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;
            &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;vm&quot;&gt;__dict__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;atributo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;valor&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pin_memory&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;hasattr&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;valor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;pin_memory&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;valor&lt;/span&gt;

        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;El-pre-procesamiento-hasta-ahora&quot;&gt;El pre-procesamiento hasta ahora&lt;a class=&quot;anchor-link&quot; href=&quot;#El-pre-procesamiento-hasta-ahora&quot;&gt; &lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vocabulario_documentos&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Vocab&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_docs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;train_índices&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vocabulario_documentos&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tókenes_a_índices&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_docs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;valid_índices&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vocabulario_documentos&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tókenes_a_índices&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;valid_docs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;infer_índices&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vocabulario_documentos&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tókenes_a_índices&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;infer_docs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_ds&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Textset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_índices&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;valid_ds&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Textset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;valid_índices&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;infer_ds&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Textset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;infer_índices&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Solo definimos el modelo, no lo entrenamos. Elegimos la función &lt;code&gt;offsetear_lote&lt;/code&gt; ya que el modelo usa &lt;code&gt;nn.EmbeddingBag&lt;/code&gt;.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;torch.utils.data&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DataLoader&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;train_dl&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DataLoader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_ds&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;shuffle&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;collate_fn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;offsetear_lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pin_memory&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# validación e inferencia no requieren `shuffle`&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;valid_dl&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DataLoader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;valid_ds&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;shuffle&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;collate_fn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;offsetear_lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pin_memory&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;infer_dl&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DataLoader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;infer_ds&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;batch_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;shuffle&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;collate_fn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;offsetear_lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pin_memory&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Hacemos unas definiciones necesarias. No es el punto de lo que queremos mostrar, lo podés pasar por alto. Para mayores detalles recomendamos ver &lt;a href=&quot;https://pytorch.org/tutorials/beginner/text_sentiment_ngrams_tutorial.html&quot;&gt;Text Classification with TorchText&lt;/a&gt;.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;torch.nn&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;nn&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;torch.nn.functional&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;F&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;DIM_EMBEDDINGS&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;8&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;ClasificadorBolsa&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Module&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vocab_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;embed_dim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num_class&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;super&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;embedding&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;EmbeddingBag&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vocab_size&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;embed_dim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sparse&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mode&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;max&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fc&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Linear&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;embed_dim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;num_class&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;forward&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;text&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;offsets&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;embedded&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;embedding&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;text&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;offsets&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;embedded&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;modelo&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ClasificadorBolsa&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vocabulario_documentos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;DIM_EMBEDDINGS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vocabulario_etiquetas&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;device&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Ídem.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cuda&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;is_available&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;device&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;device&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;cuda&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;device&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;device&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;cpu&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Nuevamente.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;optimizador&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;optim&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Adam&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;modelo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;parameters&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1e-3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;weight_decay&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1e-5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;criterio&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;CrossEntropyLoss&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Alto aquí. Así es como se usa un &lt;code&gt;DataLoader&lt;/code&gt;.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ÉPOCAS&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;época&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ÉPOCAS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train_dl&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;optimizador&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zero_grad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

        &lt;span class=&quot;n&quot;&gt;predicciones&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;modelo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;documentos&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;device&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;offsets&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;device&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;pérdida&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;criterio&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;predicciones&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;etiquetas&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;device&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

        &lt;span class=&quot;n&quot;&gt;pérdida&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;backward&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;optimizador&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;step&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Con esto concluye la segunda parte. Quedaron los &lt;em&gt;embeddings&lt;/em&gt; para la &lt;a href=&quot;Preprocesamiento-de-texto-para-NLP-parte-3.html&quot;&gt;tercera&lt;/a&gt;. Ahora deberíamos tener más control sobre la carga de datos en PyTorch. Muchos ejemplos de uso y tutoriales dan por sentada esta parte al utilizar datasets de ejemplos, que ya vienen pre-procesados y/o que la carga por defecto de PyTorch maneja sin inconvenientes.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;</content><author><name>Matías Battocchia</name></author><summary type="html"></summary></entry><entry><title type="html">Preprocesamiento de texto para NLP (parte 1)</title><link href="https://matiasbattocchia.github.io/datitos/Preprocesamiento-de-texto-para-NLP-parte-1.html" rel="alternate" type="text/html" title="Preprocesamiento de texto para NLP (parte 1)" /><published>2020-07-23T00:00:00-05:00</published><updated>2020-07-23T00:00:00-05:00</updated><id>https://matiasbattocchia.github.io/datitos/Preprocesamiento-de-texto-para-NLP-parte-1</id><content type="html" xml:base="https://matiasbattocchia.github.io/datitos/Preprocesamiento-de-texto-para-NLP-parte-1.html">&lt;!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-07-23-Preprocesamiento-de-texto-para-NLP-parte-1.ipynb
--&gt;

&lt;div class=&quot;container&quot; id=&quot;notebook-container&quot;&gt;
        
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Vamos a hacer un recorrido por los pasos básicos del pre-procesamiento de texto. Estos pasos son necesarios para transformar texto del lenguaje humano a un formato legible para máquinas para su posterior procesamiento, particularmente motiva esta publicación el procesamiento en &lt;a href=&quot;https://pytorch.org/&quot;&gt;PyTorch&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Veremos cómo realizar estos pasos con código propio, para mayor entendimiento de lo que está sucediendo, y con &lt;a href=&quot;https://spacy.io/&quot;&gt;spaCy&lt;/a&gt;, una herramienta de nuestro agrado.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;En concreto, los pasos son:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;Limpieza&lt;/strong&gt;, la remoción del contenido no deseado.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Normalización&lt;/strong&gt;, la conversión diferentes formas a una sola. &lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Tokenización&lt;/strong&gt;, la separación del texto en tókenes (unidades mínimas, por ejemplo palabras).&lt;/li&gt;
&lt;li&gt;Separación en &lt;strong&gt;conjuntos de datos&lt;/strong&gt;: entrenamiento, validación, prueba.&lt;/li&gt;
&lt;li&gt;Generación del &lt;strong&gt;vocabulario&lt;/strong&gt;, la lista de tókenes conocidos.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Numericalización&lt;/strong&gt;, el mapeo de tókenes a números enteros.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Estos pasos son comunes distintas aproximaciones al procesamiento del lenguaje. En la &lt;a href=&quot;Preprocesamiento-de-texto-para-NLP-parte-2.html&quot;&gt;parte 2&lt;/a&gt; mostraremos pasos útiles para abarcarlo usando &lt;em&gt;deep learning&lt;/em&gt;.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;Loteo&lt;/strong&gt;, la generación de porciones de muestras de entrenamiento.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Relleno&lt;/strong&gt;, la conversión del lote en un tensor de PyTorch.&lt;/li&gt;
&lt;li&gt;Carga de &lt;strong&gt;&lt;em&gt;embeddings&lt;/em&gt;&lt;/strong&gt;, opcionalmente el uso de &lt;em&gt;embeddings&lt;/em&gt; precalculados.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Nota: El órden de los primeros tres pasos (limpieza, normalización, tokenización) puede variar según conveniencia. El resto de los pasos mantiene el órden.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Dataset-de-ejemplo&quot;&gt;Dataset de ejemplo&lt;a class=&quot;anchor-link&quot; href=&quot;#Dataset-de-ejemplo&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;¿Qué sería de esta publicación sin algunos ejemplos? Vamos a usar el dataset de la competencia &lt;a href=&quot;https://metadata.fundacionsadosky.org.ar/competition/21&quot;&gt;clasificación de preguntas de clientes&lt;/a&gt; de Meta:Data.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pandas&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pd&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;read_csv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;train.csv&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sep&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;|&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;option_context&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;display.max_colwidth&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    
    &lt;span class=&quot;n&quot;&gt;display&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sample&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea &quot;&gt;
&lt;div&gt;
&lt;style scoped=&quot;&quot;&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;
  &lt;thead&gt;
    &lt;tr style=&quot;text-align: right;&quot;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;Pregunta&lt;/th&gt;
      &lt;th&gt;Intencion&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;9221&lt;/th&gt;
      &lt;td&gt;hice una compra y no tengo las acciones acreditadas&lt;/td&gt;
      &lt;td&gt;Cat_153&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1298&lt;/th&gt;
      &lt;td&gt;quiero saber si yo puedo solicitar un préstamo&lt;/td&gt;
      &lt;td&gt;Cat_248&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4488&lt;/th&gt;
      &lt;td&gt;perdi la credencial universitaria. como solicito una nueva?&lt;/td&gt;
      &lt;td&gt;Cat_294&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;28&lt;/th&gt;
      &lt;td&gt;cambiar moneda tarjeta debitar exterior&lt;/td&gt;
      &lt;td&gt;Cat_289&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;19970&lt;/th&gt;
      &lt;td&gt;quiero adherir al debito de la tarjeta el servicio epec. me pide que ingrese numero cuenta de digitos pero en la factura no aparece un numero&lt;/td&gt;
      &lt;td&gt;Cat_129&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3510&lt;/th&gt;
      &lt;td&gt;llegar tarjeta recargable solicití¬≠&lt;/td&gt;
      &lt;td&gt;Cat_293&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;14373&lt;/th&gt;
      &lt;td&gt;buenas tardes&lt;/td&gt;
      &lt;td&gt;Cat_19&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;5485&lt;/th&gt;
      &lt;td&gt;saber de cuanto es el pago mínimo de tarjeta visa&lt;/td&gt;
      &lt;td&gt;Cat_351&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;6752&lt;/th&gt;
      &lt;td&gt;verificar reclamo&lt;/td&gt;
      &lt;td&gt;Cat_135&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;10645&lt;/th&gt;
      &lt;td&gt;que sucede cuando se me vence el plazo fijo?&lt;/td&gt;
      &lt;td&gt;Cat_180&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Expresiones-regulares&quot;&gt;Expresiones regulares&lt;a class=&quot;anchor-link&quot; href=&quot;#Expresiones-regulares&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Si las expresiones regulares no te resultan familiares entonces vale la pena estudiarlas brevemente, ya que las usaremos. Podés mirar este &lt;a href=&quot;https://robologs.net/2019/05/05/como-utilizar-expresiones-regulares-regex-en-python&quot;&gt;tutorial&lt;/a&gt; que encontramos en la web.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;re&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Limpieza&quot;&gt;Limpieza&lt;a class=&quot;anchor-link&quot; href=&quot;#Limpieza&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Muchas técnicas modernas no realizan limpieza alguna. Dependiendo de lo que queramos hacer tal vez convenga deshacernos de algunos elementos. En el dataset de ejemplo los signos de puntuación no parecen tener gran relevancia, quizás tampoco la tengan los números (que aparentemente han sido removidos de antemano).&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;limpiar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;texto&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;puntuación&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;sa&quot;&gt;r&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;[,;.:¡!¿?@#$%&amp;amp;[\]()&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;lt;&amp;gt;~=+\-*/|&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\\&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;_^`&amp;quot;&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&amp;#39;&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;]&amp;#39;&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;# signos de puntuación&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;texto&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;re&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sub&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;puntuación&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39; &amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;texto&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;c1&quot;&gt;# dígitos [0-9]&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;texto&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;re&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sub&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;\d&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39; &amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;texto&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;texto&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;En esta función substituimos los signos de puntuación&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;, ; . : ¡ ! ¿ ? @ # $ % &amp;amp; [ ] ( ) { } &amp;lt; &amp;gt; ~ = + - * / | \ _ ^ ` &quot; '

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;por espacios (me gusta más; usar string vacío &lt;code&gt;''&lt;/code&gt; para eliminarlos) medieante expresiones regulares (algunos caracteres tuvieron que ser escapados anteponiendo &lt;code&gt;\&lt;/code&gt; por tener un significado especial para la expresión regular). Hacemos lo mismo con los dígitos. Veamos un ejemplo de funcionamiento.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;limpiar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;hoy 13 trabajan?&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;&amp;#39;hoy    trabajan &amp;#39;&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Otros elementos que podríamos pensar en remover son caracteres invisibles, espacios redundantes. Veremos que esto en particular también puede ser resulto en la tokenización.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Normalizaci&amp;#243;n&quot;&gt;Normalizaci&amp;#243;n&lt;a class=&quot;anchor-link&quot; href=&quot;#Normalizaci&amp;#243;n&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Normalizar es la tarea de llevar lo que puede ser expresado de múltiples maneras como fechas, números y abreviaturas a una única forma. Por ejemplo&lt;/p&gt;

&lt;pre&gt;&lt;code&gt; 13/03/30 -&amp;gt; trece de marzo de dos mil treinta
 DC -&amp;gt; departamento de computación

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Se trata de una práctica clásica de la época de los modelos de lenguaje probabilísticos, que intentaban reducir lo más posible la cantidad de palabras. En cierta forma 1 palabra = 1 atributo (lo que en los '90s conocimos como convertibilidad). Elegir atributos es ingeniería de atributos, la parte central del &lt;em&gt;machine learning&lt;/em&gt;, y lo justamente lo que el &lt;em&gt;deep learning&lt;/em&gt; busca automatizar.&lt;/p&gt;
&lt;p&gt;Sin embargo hay una normalización muy común hoy, el &lt;strong&gt;convertir todo el texto a minúsculas&lt;/strong&gt;. En el caso del español, una normalización común es la &lt;strong&gt;remoción de tildes&lt;/strong&gt;.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;normalizar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;texto&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# todo a minúsculas&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;texto&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;texto&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lower&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;# tildes y diacríticas&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;texto&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;re&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sub&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;á&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;a&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;texto&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;texto&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;re&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sub&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;é&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;e&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;texto&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;texto&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;re&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sub&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;í&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;i&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;texto&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;texto&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;re&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sub&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;ó&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;o&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;texto&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;texto&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;re&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sub&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;ú&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;u&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;texto&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;texto&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;re&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sub&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;ü&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;u&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;texto&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;texto&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;re&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sub&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;ñ&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;n&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;texto&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;texto&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;normalizar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Me podrán dar información de un préstamo personal&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;&amp;#39;me podran dar informacion de un prestamo personal&amp;#39;&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Hay una librería llamada &lt;a href=&quot;https://pypi.org/project/Unidecode&quot;&gt;unidecode&lt;/a&gt; que realiza transliteración: representa letras o palabras de un alfabeto en otro, útil si tenemos caracteres en ruso (cirílico) o chino (caracteres Han), aún útil para el alfabeto latino cuando queremos pasar de Unicode a ASCII (lo que substituiría las tildes).&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;pip install unidecode&lt;/code&gt;&lt;/pre&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;unidecode&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;unidecode&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;unidecode&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Me podrán dar información de un préstamo personal&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;&amp;#39;Me podran dar informacion de un prestamo personal&amp;#39;&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Una normalización que vale la pena intentar con este dataset es la &lt;strong&gt;correción ortográfica&lt;/strong&gt; con un paquete como &lt;a href=&quot;https://pypi.org/project/pyspellchecker&quot;&gt;pyspellchecker&lt;/a&gt;. Quizás con artículos de diarios en los que la redacción está más cuidada esto no valga la pena, pero en contextos más informales como este, conversaciones por char, Twitter, las palabras mal escritas en realidad refieren a una sola palabra y no a distintos significados.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Tokenizaci&amp;#243;n&quot;&gt;Tokenizaci&amp;#243;n&lt;a class=&quot;anchor-link&quot; href=&quot;#Tokenizaci&amp;#243;n&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Tokenizar es separar el texto en partes más pequeñas llamadas tókenes. Una unidad muy común es la palabras pero depende de lo que queramos hacer, si es que no hemos eliminado a los signos de puntuación estos también serían tókenes. Las palabras frecuentemente están compuestas por una raíz, prefijo y/o sufijo, por lo que podríamos decidir separarlos también. En inglés es común separar &lt;code&gt;it's&lt;/code&gt; en &lt;code&gt;it&lt;/code&gt; y &lt;code&gt;'s&lt;/code&gt;, si bien en español esta situación no es común.&lt;/p&gt;
&lt;p&gt;A diferencia de la limpieza y la normalización, la tokenización &lt;strong&gt;es un paso indispesable&lt;/strong&gt; en la preparación de texto para su procesamiento.&lt;/p&gt;
&lt;p&gt;Para el dataset en cuestión la tokenización es simple, vamos a separar seǵun espacios y demás caracteres invisibles como &lt;code&gt;\t&lt;/code&gt; (tabulación) y &lt;code&gt;\n&lt;/code&gt; (salto de línea). De haber signos de puntuación, pro ejemplo si quisiéramos procesar un documento extenso en oraciones, el proceso es más complejo ya que &lt;code&gt;final.&lt;/code&gt; tiene un punto en vez de un espacio, y no siempre los puntos demarcan el final de un tóken como en &lt;code&gt;A.M.&lt;/code&gt; y &lt;code&gt;P.M.&lt;/code&gt;.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Debemos definir si elementos como los signos de puntuación son tókenes o si simplemente delimitan palabras o tókenes, en cuyo caso desaparecerían en el proceso. Mismo con los caracteres invisibles, si estuviésemos haciendo un modelo que programe en Python, la indentación es fundamental y deberiera mantenerse.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;tokenizar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;texto&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# IMPORTANTE: podría devolver una lista vacía&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;texto&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;split&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;code&gt;split&lt;/code&gt; también se encarga de los caracteres invisibles repetidos.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tokenizar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;hola vengo       a flotar&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;[&amp;#39;hola&amp;#39;, &amp;#39;vengo&amp;#39;, &amp;#39;a&amp;#39;, &amp;#39;flotar&amp;#39;]&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Acá estamos cambiando el tipo de datos, ya que de un string hemos pasado a una lista de strings.&lt;/p&gt;
&lt;p&gt;Si la expresión dentro de la función no te resulta familiar, es una construcción llamada &lt;em&gt;list comprehension&lt;/em&gt; y es una manera muy efectiva de armar una lista. Es lo mismo que hacer&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lista&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[]&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;lista&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
&lt;span class=&quot;n&quot;&gt;lista&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;pero de una manera más expresiva y también más eficiente (está optimizado por el lenguaje)&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Varios modelos de lenguaje utilizan caracteres en vez de palabras como tókenes, esto es útil por varios motivos que listaremos más adelante. Otros utilizan partes de palabras como sílabas (las partes se determinan estadísticamente). Ver &lt;a href=&quot;https://arxiv.org/pdf/1508.07909.pdf&quot;&gt;https://arxiv.org/pdf/1508.07909.pdf&lt;/a&gt;.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Tokenizaci&amp;#243;n-utilizando-alguna-librer&amp;#237;a&quot;&gt;Tokenizaci&amp;#243;n utilizando alguna librer&amp;#237;a&lt;a class=&quot;anchor-link&quot; href=&quot;#Tokenizaci&amp;#243;n-utilizando-alguna-librer&amp;#237;a&quot;&gt; &lt;/a&gt;&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;pip install spacy
python -m spacy download es_core_news_sm&lt;/code&gt;&lt;/pre&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;spacy&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;nlp&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;spacy&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;load&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;es_core_news_sm&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;doc&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nlp&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Esto es una frase.&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;text&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;doc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;[&amp;#39;Esto&amp;#39;, &amp;#39;es&amp;#39;, &amp;#39;una&amp;#39;, &amp;#39;frase&amp;#39;, &amp;#39;.&amp;#39;]
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Otros-pre-procesos&quot;&gt;Otros pre-procesos&lt;a class=&quot;anchor-link&quot; href=&quot;#Otros-pre-procesos&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Clásicamente se aplicaban alguno de estos para reducir aún más la cantidad de palabras:&lt;/p&gt;
&lt;h4 id=&quot;Stemming&quot;&gt;&lt;em&gt;Stemming&lt;/em&gt;&lt;a class=&quot;anchor-link&quot; href=&quot;#Stemming&quot;&gt; &lt;/a&gt;&lt;/h4&gt;&lt;p&gt;&lt;em&gt;Stem&lt;/em&gt;, de raíz, reduce la inflección de las palabras, mapeando un grupo de palabras a la misma raíz, sin importar si la raíz es una palabras válida en el lenguaje.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt; caminando, caminar, camino -&amp;gt; camin

&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&quot;Lemmatization&quot;&gt;&lt;em&gt;Lemmatization&lt;/em&gt;&lt;a class=&quot;anchor-link&quot; href=&quot;#Lemmatization&quot;&gt; &lt;/a&gt;&lt;/h4&gt;&lt;p&gt;A diferencia del &lt;em&gt;stemming&lt;/em&gt;, la lematización reduce las palabras inflexadas a palabras que pertenecen al lenguaje. La raíz pasa a llamarse &lt;em&gt;lema&lt;/em&gt;.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Primera-parte-del-pre-procesamiento&quot;&gt;Primera parte del pre-procesamiento&lt;a class=&quot;anchor-link&quot; href=&quot;#Primera-parte-del-pre-procesamiento&quot;&gt; &lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;preprocesar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;texto&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;texto&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;limpiar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;texto&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;texto&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;normalizar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;texto&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;texto&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tokenizar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;texto&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;texto&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Conjuntos-de-datos&quot;&gt;Conjuntos de datos&lt;a class=&quot;anchor-link&quot; href=&quot;#Conjuntos-de-datos&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;En la competencias normalmente encontramos dos archivos, el de entrenamiento y el de inferencia —que le suelen llamar de prueba y es el que tenemos que predecir para entregar—. Del que suelen llamar &lt;code&gt;train&lt;/code&gt; también tenemos que obtener el de validación.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;infer_df&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;read_csv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;test.csv&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sep&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;,&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sklearn.model_selection&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train_test_split&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;train_df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;valid_df&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train_test_split&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;test_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;random_state&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;42&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;img src=&quot;https://www.googleapis.com/download/storage/v1/b/kaggle-user-content/o/inbox%2F3061129%2Fc9ef73f33bf2b505d48be10211ffa47c%2FScikit.jfif?generation=1580787055399439&amp;amp;alt=media&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Ahora estamos en condiciones de pre-procesar todo lo que tenemos:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_docs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;preprocesar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;doc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;doc&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train_df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Pregunta&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;values&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;valid_docs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;preprocesar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;doc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;doc&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;valid_df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Pregunta&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;values&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;infer_docs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;preprocesar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;doc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;doc&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;infer_df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Pregunta&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;values&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Hemos pasado de una Series de Pandas, array de NumPy o una &lt;strong&gt;lista de strings&lt;/strong&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Pregunta&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;values&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;array([&amp;#39;que se requiere para un préstamo personal?&amp;#39;,
       &amp;#39;me piden mi número de cuenta es mi cbu?&amp;#39;,
       &amp;#39;necesitar adherir aysa tarjeta&amp;#39;,
       &amp;#39;te financian igual un usado o un 0km?&amp;#39;], dtype=object)&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;a una &lt;strong&gt;lista de listas de strings&lt;/strong&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_docs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;[[&amp;#39;que&amp;#39;, &amp;#39;se&amp;#39;, &amp;#39;requiere&amp;#39;, &amp;#39;para&amp;#39;, &amp;#39;un&amp;#39;, &amp;#39;prestamo&amp;#39;, &amp;#39;personal&amp;#39;],
 [&amp;#39;me&amp;#39;, &amp;#39;piden&amp;#39;, &amp;#39;mi&amp;#39;, &amp;#39;numero&amp;#39;, &amp;#39;de&amp;#39;, &amp;#39;cuenta&amp;#39;, &amp;#39;es&amp;#39;, &amp;#39;mi&amp;#39;, &amp;#39;cbu&amp;#39;],
 [&amp;#39;necesitar&amp;#39;, &amp;#39;adherir&amp;#39;, &amp;#39;aysa&amp;#39;, &amp;#39;tarjeta&amp;#39;],
 [&amp;#39;te&amp;#39;, &amp;#39;financian&amp;#39;, &amp;#39;igual&amp;#39;, &amp;#39;un&amp;#39;, &amp;#39;usado&amp;#39;, &amp;#39;o&amp;#39;, &amp;#39;un&amp;#39;, &amp;#39;km&amp;#39;]]&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Un poco de nomenclatura: estamos llamando corpus a la colección de textos. Nos referimos también a los textos como documentos. También estamos usando el término lote (&lt;em&gt;batch&lt;/em&gt;) para referirnos a un (sub)conjunto de documentos.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Vocabulario&quot;&gt;Vocabulario&lt;a class=&quot;anchor-link&quot; href=&quot;#Vocabulario&quot;&gt; &lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Este paso es importante. Aquí definimos y limitamos la tókenes que vamos a utilizar. El lenguaje es infinito, para convertirlo en un problema tratable muchas veces los que hacemos es reducirlo. Clave para varias prácticas de reducción es contar las frecuencias de los tókenes, esto es, cuántas veces aparece cada tóken en todo el corpus. Como mencionamos las palabras más frecuentes no aportan mucha información y las más infrecuentes si bien son las que más información tienen no llegarán a ser representativas para nuestro modelo. Descartar palabras poco frecuentes también afecta a errores ortográficos.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Útil para este paso es la clase &lt;code&gt;Counter&lt;/code&gt; de la librería estándar de Python.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;collections&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Counter&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Counter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;a&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;b&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;c&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;a&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;b&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;a&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# obtener los dos elementos más comunes y sus frecuencias&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;most_common&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;[(&amp;#39;a&amp;#39;, 3), (&amp;#39;b&amp;#39;, 2)]&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Una función de la librería estándar llamada &lt;code&gt;chain&lt;/code&gt; nos dará una mano convirtiendo la lista de listas de tókenes en una lista de tókenes, similar a &lt;code&gt;numpy.flatten&lt;/code&gt;, ya que &lt;code&gt;Counter&lt;/code&gt; espera una lista con elementos a contar y nuestros tókenes están separados por documentos, hay que juntarlos.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;itertools&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;chain&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;chain&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;a&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;b&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;c&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;c&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;d&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;[&amp;#39;a&amp;#39;, &amp;#39;b&amp;#39;, &amp;#39;c&amp;#39;, &amp;#39;c&amp;#39;, &amp;#39;d&amp;#39;]&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;code&gt;chain&lt;/code&gt; encadena las listas que le pasamos como argumentos variables. Podemos usar el operador &lt;em&gt;splat&lt;/em&gt; &lt;code&gt;*&lt;/code&gt; para contentar a la función (convertir la lista principal en una serie de argumentos).&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;chain&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;a&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;b&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;c&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;c&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;d&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;[&amp;#39;a&amp;#39;, &amp;#39;b&amp;#39;, &amp;#39;c&amp;#39;, &amp;#39;c&amp;#39;, &amp;#39;d&amp;#39;]&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;En vez de una lista podemos pedir un conjunto (&lt;code&gt;set&lt;/code&gt;), en el que los elementos no se repiten. Este bien podría ser el vocabulario.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;set&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;chain&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;a&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;b&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;c&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;c&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;d&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;{&amp;#39;a&amp;#39;, &amp;#39;b&amp;#39;, &amp;#39;c&amp;#39;, &amp;#39;d&amp;#39;}&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;En definitiva, es la lista oficial de tókenes.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# versión 1&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Vocab&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;fit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vocabulario&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;set&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;chain&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
        
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;fm&quot;&gt;__len__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vocabulario&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Es importante generar el vocabulario con el dataset de entrenamiento, ya que como mencionamos se trata de la lista de palabras conocidas. Le agregamos un &lt;code&gt;__len__&lt;/code&gt; porque también es útil conocer el tamaño del vocabulario.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Vocab&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_docs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_text output_error&quot;&gt;
&lt;pre&gt;
&lt;span class=&quot;ansi-red-fg&quot;&gt;---------------------------------------------------------------------------&lt;/span&gt;
&lt;span class=&quot;ansi-red-fg&quot;&gt;NameError&lt;/span&gt;                                 Traceback (most recent call last)
&lt;span class=&quot;ansi-green-fg&quot;&gt;&amp;lt;ipython-input-3-04b70b8e4c3d&amp;gt;&lt;/span&gt; in &lt;span class=&quot;ansi-cyan-fg&quot;&gt;&amp;lt;module&amp;gt;&lt;/span&gt;
&lt;span class=&quot;ansi-green-fg&quot;&gt;----&amp;gt; 1&lt;/span&gt;&lt;span class=&quot;ansi-red-fg&quot;&gt; &lt;/span&gt;v &lt;span class=&quot;ansi-blue-fg&quot;&gt;=&lt;/span&gt; Vocab&lt;span class=&quot;ansi-blue-fg&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;ansi-blue-fg&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;ansi-blue-fg&quot;&gt;.&lt;/span&gt;fit&lt;span class=&quot;ansi-blue-fg&quot;&gt;(&lt;/span&gt;train_docs&lt;span class=&quot;ansi-blue-fg&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;ansi-green-intense-fg ansi-bold&quot;&gt;      2&lt;/span&gt; len&lt;span class=&quot;ansi-blue-fg&quot;&gt;(&lt;/span&gt;v&lt;span class=&quot;ansi-blue-fg&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;ansi-red-fg&quot;&gt;NameError&lt;/span&gt;: name &amp;#39;train_docs&amp;#39; is not defined&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;¿Qué pasa con las palabras que no están en la lista? Se las conoce como tókenen &lt;strong&gt;fuera del vocabulario&lt;/strong&gt; (&lt;em&gt;out-of-vocabulary&lt;/em&gt;, abreviado OOV). Estas requieren acciones especiales, podríamos&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ignorarlas&lt;/li&gt;
&lt;li&gt;reemplazarlas por un tóken especial&lt;/li&gt;
&lt;li&gt;inferirlas (ver más adelante, embeddings)&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# versión 1.1&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Vocab&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tóken_desconocido&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;lt;unk&amp;gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken_desconocido&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tóken_desconocido&lt;/span&gt;
        
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;fit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vocabulario&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;set&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;chain&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;
        
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken_desconocido&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vocabulario&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken_desconocido&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;transform&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken_desconocido&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# reemplazar&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vocabulario&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken_desconocido&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;doc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;doc&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# ignorar&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;doc&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vocabulario&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;doc&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;fm&quot;&gt;__len__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vocabulario&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Vocab&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_docs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;transform&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;poder&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;gestionar&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;clave&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;paso&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;pagina&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;desde&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;cuando&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;arranco&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;con&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;el&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;programa&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;de&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;millas&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;[[&amp;#39;poder&amp;#39;, &amp;#39;gestionar&amp;#39;, &amp;#39;clave&amp;#39;, &amp;#39;paso&amp;#39;, &amp;#39;pagina&amp;#39;],
 [&amp;#39;desde&amp;#39;, &amp;#39;cuando&amp;#39;, &amp;#39;&amp;lt;unk&amp;gt;&amp;#39;, &amp;#39;con&amp;#39;, &amp;#39;el&amp;#39;, &amp;#39;programa&amp;#39;, &amp;#39;de&amp;#39;, &amp;#39;millas&amp;#39;]]&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Numericalizaci&amp;#243;n&quot;&gt;Numericalizaci&amp;#243;n&lt;a class=&quot;anchor-link&quot; href=&quot;#Numericalizaci&amp;#243;n&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;También conocido como indexación. Así como a las unidades mínimas que consideramos las llamamos tókenes, a los números que los representan los llamamos &lt;strong&gt;índices&lt;/strong&gt;. Ya que el vocabulario tiene la lista de tókenes, le vamos a pedir una responsabilidad adicional: que mantenga una asignación entre tókenes y números enteros. Posiblemente ya te ha sucedido pasarle valores no númericos a un estimador y ver cómo falla.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vocabulario&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;a&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;b&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;c&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;d&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;lt;unk&amp;gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;índice&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;índice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;enumerate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vocabulario&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;{&amp;#39;a&amp;#39;: 0, &amp;#39;b&amp;#39;: 1, &amp;#39;c&amp;#39;: 2, &amp;#39;d&amp;#39;: 3, &amp;#39;&amp;lt;unk&amp;gt;&amp;#39;: 4}&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;que es lo mismo que&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mapeo&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{}&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;índice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;enumerate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vocabulario&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;mapeo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;índice&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;mapeo&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;{&amp;#39;a&amp;#39;: 0, &amp;#39;b&amp;#39;: 1, &amp;#39;c&amp;#39;: 2, &amp;#39;d&amp;#39;: 3, &amp;#39;&amp;lt;unk&amp;gt;&amp;#39;: 4}&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;¿Qué es lo que hace &lt;code&gt;enumerate&lt;/code&gt;? Como su nombre lo indica, enumera los elementos de una colección.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;enumerate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vocabulario&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;[(0, &amp;#39;a&amp;#39;), (1, &amp;#39;b&amp;#39;), (2, &amp;#39;c&amp;#39;), (3, &amp;#39;d&amp;#39;), (4, &amp;#39;&amp;lt;unk&amp;gt;&amp;#39;)]&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# versión 2&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Vocab&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tóken_desconocido&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;lt;unk&amp;gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken_desconocido&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tóken_desconocido&lt;/span&gt;
        
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;fit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;vocabulario&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;set&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;chain&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)))&lt;/span&gt;
        
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken_desconocido&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;vocabulario&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken_desconocido&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mapeo&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;índice&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;índice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;enumerate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vocabulario&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)}&lt;/span&gt;

        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;transform&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken_desconocido&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# reemplazar&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mapeo&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken_desconocido&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;doc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;doc&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# ignorar&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;doc&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mapeo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;doc&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;fm&quot;&gt;__len__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mapeo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Comprobemos que la nueva versión de &lt;code&gt;Vocab&lt;/code&gt; funciona como la anterior. Además veamos qué sucedo cuando no queremos el tóken para palabras fuera de vocabulario.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Vocab&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken_desconocido&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_docs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;transform&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;poder&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;gestionar&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;clave&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;paso&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;pagina&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;desde&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;cuando&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;arranco&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;con&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;el&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;programa&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;de&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;millas&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;[[&amp;#39;poder&amp;#39;, &amp;#39;gestionar&amp;#39;, &amp;#39;clave&amp;#39;, &amp;#39;paso&amp;#39;, &amp;#39;pagina&amp;#39;],
 [&amp;#39;desde&amp;#39;, &amp;#39;cuando&amp;#39;, &amp;#39;con&amp;#39;, &amp;#39;el&amp;#39;, &amp;#39;programa&amp;#39;, &amp;#39;de&amp;#39;, &amp;#39;millas&amp;#39;]]&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Ahora vamos a agregar métodos para convertir tókenes a índices y viceversa.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# versión 2.1&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Vocab&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tóken_desconocido&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;lt;unk&amp;gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken_desconocido&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tóken_desconocido&lt;/span&gt;
        
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;fit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# agregamos `sorted` porque el orden al aplicar `set` no está asegurado&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;vocabulario&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;sorted&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;set&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;chain&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))))&lt;/span&gt;
        
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken_desconocido&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;vocabulario&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken_desconocido&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mapeo&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;índice&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;índice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;enumerate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vocabulario&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)}&lt;/span&gt;

        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;transform&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken_desconocido&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# reemplazar&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mapeo&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken_desconocido&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;doc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;doc&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# ignorar&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;doc&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mapeo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;doc&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;tókenes_a_índices&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;transform&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mapeo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;doc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;doc&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;índices_a_tókenes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;mapeo_inverso&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mapeo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keys&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
        
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mapeo_inverso&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;índice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;índice&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;doc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;doc&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;fm&quot;&gt;__len__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mapeo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Vocab&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken_desconocido&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_docs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;v&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tókenes_a_índices&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;que&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;se&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;requiere&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;para&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;un&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;prestamo&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;personal&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;me&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;piden&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;mi&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;numero&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;de&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;cuenta&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;es&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;mi&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;cbu&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;[[4160, 4683, 4484, 3703, 5294, 4011, 3825],
 [3275, 3854, 3319, 3554, 1532, 1462, 2151, 3319, 950]]&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;índices_a_tókenes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4160&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4683&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4484&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3703&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5294&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;4011&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3825&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3275&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3854&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3319&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3554&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1532&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1462&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2151&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3319&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;950&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;[[&amp;#39;que&amp;#39;, &amp;#39;se&amp;#39;, &amp;#39;requiere&amp;#39;, &amp;#39;para&amp;#39;, &amp;#39;un&amp;#39;, &amp;#39;prestamo&amp;#39;, &amp;#39;personal&amp;#39;],
 [&amp;#39;me&amp;#39;, &amp;#39;piden&amp;#39;, &amp;#39;mi&amp;#39;, &amp;#39;numero&amp;#39;, &amp;#39;de&amp;#39;, &amp;#39;cuenta&amp;#39;, &amp;#39;es&amp;#39;, &amp;#39;mi&amp;#39;, &amp;#39;cbu&amp;#39;]]&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Casos-especiales&quot;&gt;Casos especiales&lt;a class=&quot;anchor-link&quot; href=&quot;#Casos-especiales&quot;&gt; &lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;¿Qué sucede con los documentos que al ser tokenizados regresan vacíos? ¿O con documentos compuestos enteramente por palabras fuera del vocabulario?&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;documentos_problemáticos&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;
    &lt;span class=&quot;s1&quot;&gt;&amp;#39;??? ???&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s1&quot;&gt;&amp;#39;Banks charge high fees for foreign ATM&amp;#39;&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;preprocesar&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;doc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;doc&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;documentos_problemáticos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;[[], [&amp;#39;banks&amp;#39;, &amp;#39;charge&amp;#39;, &amp;#39;high&amp;#39;, &amp;#39;fees&amp;#39;, &amp;#39;for&amp;#39;, &amp;#39;foreign&amp;#39;, &amp;#39;atm&amp;#39;]]&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Vocab&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_docs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;v&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;transform&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([[],&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;banks&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;charge&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;high&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;fees&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;for&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;foreign&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;[[], [&amp;#39;&amp;lt;unk&amp;gt;&amp;#39;, &amp;#39;&amp;lt;unk&amp;gt;&amp;#39;, &amp;#39;&amp;lt;unk&amp;gt;&amp;#39;, &amp;#39;&amp;lt;unk&amp;gt;&amp;#39;, &amp;#39;&amp;lt;unk&amp;gt;&amp;#39;, &amp;#39;&amp;lt;unk&amp;gt;&amp;#39;]]&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tókenes_a_índices&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([[],&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;banks&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;charge&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;high&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;fees&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;for&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;foreign&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;[[], [5583, 5583, 5583, 5583, 5583, 5583]]&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;índices_a_tókenes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([[],&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5583&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5583&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5583&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5583&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5583&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5583&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;[[], [&amp;#39;&amp;lt;unk&amp;gt;&amp;#39;, &amp;#39;&amp;lt;unk&amp;gt;&amp;#39;, &amp;#39;&amp;lt;unk&amp;gt;&amp;#39;, &amp;#39;&amp;lt;unk&amp;gt;&amp;#39;, &amp;#39;&amp;lt;unk&amp;gt;&amp;#39;, &amp;#39;&amp;lt;unk&amp;gt;&amp;#39;]]&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;La conclusión es que &lt;a href=&quot;https://www.youtube.com/watch?v=UiZWxx1i6iA&quot;&gt;no pasa nada&lt;/a&gt; (al menos por ahora).&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Bonus:-reducci&amp;#243;n-del-vocabulario&quot;&gt;Bonus: reducci&amp;#243;n del vocabulario&lt;a class=&quot;anchor-link&quot; href=&quot;#Bonus:-reducci&amp;#243;n-del-vocabulario&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;La idea es limitar los tókenes que vamos a utilizar. En cierta forma cada tóken es un atributo (&lt;em&gt;feature&lt;/em&gt;) y quisiéramos proveer atributos que sean de utilidad para el estimador.&lt;/p&gt;
&lt;p&gt;El lenguaje es infinito, para convertirlo en un problema tratable muchas veces los que hacemos es reducirlo. Clave para varias prácticas de reducción es contar las frecuencias de los tókenes, esto es, cuántas veces aparece cada tóken en todo el corpus. Como mencionamos las palabras más frecuentes no aportan mucha información y las más infrecuentes si bien son las que más información tienen no llegarán a ser representativas para nuestro modelo. Descartar palabras poco frecuentes también afecta a errores ortográficos.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Útil para este paso es la clase &lt;code&gt;Counter&lt;/code&gt; de la librería estándar de Python.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;collections&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Counter&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Counter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;a&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;b&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;c&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;a&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;b&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;a&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# obtener los elementos ordenados de más comunes a menos&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;most_common&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;[(&amp;#39;a&amp;#39;, 3), (&amp;#39;b&amp;#39;, 2), (&amp;#39;c&amp;#39;, 1)]&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Acerca de contar palabras, no te pierdas la &lt;a href=&quot;https://nbviewer.jupyter.org/url/norvig.com/ipython/How%20to%20Do%20Things%20with%20Words.ipynb#(2&quot;&gt;ley de Zipf&lt;/a&gt;-Models:-Bag-of-Words).&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;M&amp;#225;s-comunes&quot;&gt;M&amp;#225;s comunes&lt;a class=&quot;anchor-link&quot; href=&quot;#M&amp;#225;s-comunes&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Una estrategia simple es ordenar a los tókenes según frecuencia y poner un límite duro al vocabulario, de modo de quedarnos con los &lt;code&gt;límite&lt;/code&gt; más comunes.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;límite&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;vocabulario&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[:&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;límite&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;vocabulario&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;[&amp;#39;a&amp;#39;, &amp;#39;b&amp;#39;]&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Por-frecuencia-de-t&amp;#243;ken&quot;&gt;Por frecuencia de t&amp;#243;ken&lt;a class=&quot;anchor-link&quot; href=&quot;#Por-frecuencia-de-t&amp;#243;ken&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Podríamos descartar los que aparecen&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;más de &lt;code&gt;máximo&lt;/code&gt; veces,&lt;/li&gt;
&lt;li&gt;menos de &lt;code&gt;mínimo&lt;/code&gt; veces.&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;máximo&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;mínimo&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;vocabulario&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;frecuencia&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;most_common&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;máximo&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;frecuencia&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mínimo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;vocabulario&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;[&amp;#39;a&amp;#39;, &amp;#39;b&amp;#39;]&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Por-frecuencia-de-documento&quot;&gt;Por frecuencia de documento&lt;a class=&quot;anchor-link&quot; href=&quot;#Por-frecuencia-de-documento&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;O bien, en vez de contar las apariciones absolutas, contar en cuántos documentos aparece cada tóken. Un tóken que aparezca en todos los documentos no colaboraría en una tarea de clasificación, a distinguir documentos pero uno que aparezca en la mitad de los documentos podría ser útil para separarlos en dos grupos.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;c&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Counter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;hola&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;buen&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;día&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;hola&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;buenas&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;tardes&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;doc&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;update&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;set&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;doc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;most_common&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;[(&amp;#39;hola&amp;#39;, 2), (&amp;#39;buen&amp;#39;, 1), (&amp;#39;día&amp;#39;, 1), (&amp;#39;tardes&amp;#39;, 1), (&amp;#39;buenas&amp;#39;, 1)]&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Vamos a normalizar la frecuencias por la cantidad total de documentos ($D$) y de manera similar al punto anterior podríamos descartar los elementos que aparecen en:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;más del &lt;code&gt;máximo&lt;/code&gt; proporción de los documentos.&lt;/li&gt;
&lt;li&gt;menos del &lt;code&gt;mínimo&lt;/code&gt; proporción de los documentos.&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;D&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;máximo&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;mínimo&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;vocabulario&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;frecuencia&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;most_common&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;máximo&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;frecuencia&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;D&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mínimo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;vocabulario&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;[&amp;#39;buen&amp;#39;, &amp;#39;día&amp;#39;, &amp;#39;tardes&amp;#39;, &amp;#39;buenas&amp;#39;]&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Stop-words&quot;&gt;&lt;em&gt;Stop words&lt;/em&gt;&lt;a class=&quot;anchor-link&quot; href=&quot;#Stop-words&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Hay listas armadas de palabras muy comunes (&lt;em&gt;stop words&lt;/em&gt;). Podemos elaborarla de alguna manera o usar alguna existente.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;pip install nltk&lt;/code&gt;&lt;/pre&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;nltk&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;nltk&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;download&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;stopwords&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;nltk.corpus&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stopwords&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;stopwords&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;words&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;spanish&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stderr output_text&quot;&gt;
&lt;pre&gt;[nltk_data] Downloading package stopwords to /home/matias/nltk_data...
[nltk_data]   Package stopwords is already up-to-date!
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;[&amp;#39;de&amp;#39;, &amp;#39;la&amp;#39;, &amp;#39;que&amp;#39;, &amp;#39;el&amp;#39;, &amp;#39;en&amp;#39;, &amp;#39;y&amp;#39;, &amp;#39;a&amp;#39;, &amp;#39;los&amp;#39;, &amp;#39;del&amp;#39;, &amp;#39;se&amp;#39;]&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Un detalle a cuidar es que la tokenización usada para la lista de &lt;em&gt;stop words&lt;/em&gt; tiene que haber sido la misma o similar que la usada para los documentos.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;filtrar_stop_words&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;doc&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stopwords&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;words&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;spanish&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;doc&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;filtrar_stop_words&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;que&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;se&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;requiere&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;para&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;un&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;prestamo&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;personal&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;me&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;piden&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;mi&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;numero&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;de&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;cuenta&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;es&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;mi&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;cbu&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;[[&amp;#39;requiere&amp;#39;, &amp;#39;prestamo&amp;#39;, &amp;#39;personal&amp;#39;], [&amp;#39;piden&amp;#39;, &amp;#39;numero&amp;#39;, &amp;#39;cuenta&amp;#39;, &amp;#39;cbu&amp;#39;]]&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Por-longitud&quot;&gt;Por longitud&lt;a class=&quot;anchor-link&quot; href=&quot;#Por-longitud&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Esta técnica no requiere contar la frecuencia de los tókenes, simplemente filtramos tókenes muy cortos o muy largos ya que en general son ruidos.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;filtrar_por_longitud&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;máxima&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mínima&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;doc&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;máxima&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mínima&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;doc&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;filtrar_por_longitud&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;que&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;se&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;requiere&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;para&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;un&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;prestamo&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;personal&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;me&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;piden&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;mi&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;numero&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;de&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;cuenta&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;es&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;mi&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;cbu&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;máxima&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;9&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;mínima&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;[[&amp;#39;que&amp;#39;, &amp;#39;requiere&amp;#39;, &amp;#39;para&amp;#39;, &amp;#39;prestamo&amp;#39;, &amp;#39;personal&amp;#39;],
 [&amp;#39;piden&amp;#39;, &amp;#39;numero&amp;#39;, &amp;#39;cuenta&amp;#39;, &amp;#39;cbu&amp;#39;]]&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Implementaci&amp;#243;n&quot;&gt;Implementaci&amp;#243;n&lt;a class=&quot;anchor-link&quot; href=&quot;#Implementaci&amp;#243;n&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Veamos cómo acomodamos lo que hemos visto ahora en la clase &lt;code&gt;Vocab&lt;/code&gt;.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# versión 3&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;np&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;itertools&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;chain&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;collections&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Counter&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Vocab&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;():&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tóken_desconocido&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&amp;lt;unk&amp;gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;frecuencia_mínima&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;frecuencia_máxima&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                 &lt;span class=&quot;n&quot;&gt;longitud_mínima&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;longitud_máxima&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inf&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stop_words&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;límite_vocabulario&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken_desconocido&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tóken_desconocido&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;frecuencia_mínima&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;frecuencia_mínima&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;frecuencia_máxima&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;frecuencia_máxima&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;longitud_mínima&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;longitud_mínima&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;longitud_máxima&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;longitud_máxima&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stop_words&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;stop_words&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;límite_vocabulario&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;límite_vocabulario&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;reducir_vocabulario&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;contador_absoluto&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Counter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;chain&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
        
        &lt;span class=&quot;n&quot;&gt;contador_documentos&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Counter&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;doc&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;contador_documentos&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;update&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;set&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;doc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
        
        &lt;span class=&quot;c1&quot;&gt;# frecuencia mínima&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;isinstance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;frecuencia_mínima&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# frecuencia de tóken&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;vocabulario_mín&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;frecuencia&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;contador_absoluto&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;most_common&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;frecuencia&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;frecuencia_mínima&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# frecuencia de documento&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;vocabulario_mín&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;frecuencia&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;contador_documentos&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;most_common&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;frecuencia&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;frecuencia_mínima&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        
        &lt;span class=&quot;c1&quot;&gt;# frecuencia máxima&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;isinstance&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;frecuencia_máxima&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;int&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# frecuencia de tóken&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;vocabulario_máx&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;frecuencia&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;contador_absoluto&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;most_common&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;frecuencia_máxima&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;frecuencia&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# frecuencia de documento&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;vocabulario_máx&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;frecuencia&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;contador_documentos&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;most_common&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;frecuencia_máxima&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;frecuencia&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt;

        &lt;span class=&quot;c1&quot;&gt;# intersección de vocabulario_mín y vocabulario_máx preservando el órden&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;vocabulario&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vocabulario_mín&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vocabulario_máx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;

        &lt;span class=&quot;c1&quot;&gt;# longitud&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;vocabulario&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vocabulario&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;longitud_máxima&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;longitud_mínima&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        
        &lt;span class=&quot;c1&quot;&gt;# stop words&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;vocabulario&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vocabulario&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;not&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;stop_words&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        
        &lt;span class=&quot;c1&quot;&gt;# límite&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;vocabulario&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vocabulario&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;límite_vocabulario&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vocabulario&lt;/span&gt;
        
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;fit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;vocabulario&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reducir_vocabulario&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken_desconocido&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;vocabulario&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken_desconocido&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mapeo&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;índice&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;índice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;enumerate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vocabulario&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)}&lt;/span&gt;

        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;transform&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken_desconocido&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# reemplazar&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mapeo&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken_desconocido&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;doc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;doc&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# ignorar&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;doc&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mapeo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;doc&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;tókenes_a_índices&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;transform&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mapeo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tóken&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;doc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;doc&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;índices_a_tókenes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;mapeo_inverso&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mapeo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;keys&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
        
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mapeo_inverso&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;índice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;índice&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;doc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;doc&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lote&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;fm&quot;&gt;__len__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mapeo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Vocab&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;longitud_mínima&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_docs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;transform&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;poder&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;gestionar&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;clave&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;paso&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;pagina&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;desde&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;cuando&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;arranco&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;con&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;el&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;programa&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;de&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;millas&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;[[&amp;#39;poder&amp;#39;, &amp;#39;gestionar&amp;#39;, &amp;#39;clave&amp;#39;, &amp;#39;paso&amp;#39;, &amp;#39;pagina&amp;#39;],
 [&amp;#39;desde&amp;#39;, &amp;#39;cuando&amp;#39;, &amp;#39;&amp;lt;unk&amp;gt;&amp;#39;, &amp;#39;con&amp;#39;, &amp;#39;&amp;lt;unk&amp;gt;&amp;#39;, &amp;#39;programa&amp;#39;, &amp;#39;&amp;lt;unk&amp;gt;&amp;#39;, &amp;#39;millas&amp;#39;]]&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;El-pre-procesamiento-hasta-ahora&quot;&gt;El pre-procesamiento hasta ahora&lt;a class=&quot;anchor-link&quot; href=&quot;#El-pre-procesamiento-hasta-ahora&quot;&gt; &lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;v&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Vocab&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_docs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;train_índices&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tókenes_a_índices&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_docs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;valid_índices&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tókenes_a_índices&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;valid_docs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;infer_índices&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;v&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tókenes_a_índices&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;infer_docs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Con esto concluye la primera parte. Hay varias librerías que tienen clases que se encargan de efectuar los pasos que hemos visto. Tienen un comportamiento por defecto, que es configurable (los parámetros que hemos visto) y a su vez, personalizable, para reemplazar algunos o todos los pasos por código propio. En general son librerías desarrolladas por angloparlantes, funcionan &lt;em&gt;out-of-the-box&lt;/em&gt; bien para el inglés; cuando queremos procesar texto en español vale la pena tener más control sobre estos procesos.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://scikit-learn.org/stable/modules/generated/sklearn.feature_extraction.text.CountVectorizer.html&quot;&gt;CountVectorizer&lt;/a&gt; de scikit-learn.&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://docs.fast.ai/text.data.html#TextDataBunch.from_df&quot;&gt;TextDataBunch&lt;/a&gt; de fast.ai.&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Pre-procesando-las-etiquetas&quot;&gt;Pre-procesando las etiquetas&lt;a class=&quot;anchor-link&quot; href=&quot;#Pre-procesando-las-etiquetas&quot;&gt; &lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Las etiquetas del dataset también necesitan ser convertidas a números enteros consecutivos. No lo pensamos para este fin pero &lt;code&gt;Vocab&lt;/code&gt; sería útil en este aspecto. El único tema es que &lt;code&gt;Vocab.fit&lt;/code&gt; y demás métodos esperan listas de listas de tókenes y a las etiquetas las encontramos en forma de listas de tókenes simplemente.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Intencion&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;values&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;array([&amp;#39;Cat_248&amp;#39;, &amp;#39;Cat_42&amp;#39;, &amp;#39;Cat_132&amp;#39;, ..., &amp;#39;Cat_293&amp;#39;, &amp;#39;Cat_138&amp;#39;,
       &amp;#39;Cat_219&amp;#39;], dtype=object)&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Podemos llevar la columna de las etiquetas a una lista de listas con &lt;code&gt;train_df['Intencion'].values.reshape(-1,1)&lt;/code&gt;, de manera de poder interfacearlo con &lt;code&gt;Vocab&lt;/code&gt;. Algo como &lt;code&gt;train_df[['Intencion']].values&lt;/code&gt; para que Pandas devuelva un &lt;code&gt;DataFrame&lt;/code&gt; en vez de una &lt;code&gt;Series&lt;/code&gt; también funcionaría.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_etiquetas&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train_df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Intencion&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;values&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;valid_etiquetas&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;valid_df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Intencion&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;values&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;train_etiquetas&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;array([[&amp;#39;Cat_248&amp;#39;],
       [&amp;#39;Cat_42&amp;#39;],
       [&amp;#39;Cat_132&amp;#39;],
       ...,
       [&amp;#39;Cat_293&amp;#39;],
       [&amp;#39;Cat_138&amp;#39;],
       [&amp;#39;Cat_219&amp;#39;]], dtype=object)&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Todo lo que tenga que ver con limitación del vocabulario o agregado de tókenes especiales no nos interesa para este caso de uso.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;vocabulario_etiquetas&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Vocab&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tóken_desconocido&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_etiquetas&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;train_etiquetas&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vocabulario_etiquetas&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tókenes_a_índices&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_etiquetas&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;valid_etiquetas&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;vocabulario_etiquetas&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tókenes_a_índices&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;valid_etiquetas&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;train_etiquetas&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;[[6], [128], [0], [104], [6], [17], [8], [202], [306], [166]]&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Ya casi estamos. Solo debemos reconvertir a las etiquetas en una lista de índices (su dimensión original) con un recurso que ya conocemos.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_etiquetas&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;chain&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;train_etiquetas&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;valid_etiquetas&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;chain&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;valid_etiquetas&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;train_etiquetas&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;[6, 128, 0, 104, 6, 17, 8, 202, 306, 166]&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Ahora estás en condiciones de seguir con la &lt;a href=&quot;Preprocesamiento-de-texto-para-NLP-parte-2.html&quot;&gt;segunda parte&lt;/a&gt;.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Fuentes-consultadas&quot;&gt;Fuentes consultadas&lt;a class=&quot;anchor-link&quot; href=&quot;#Fuentes-consultadas&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://anie.me/On-Torchtext/&quot;&gt;http://anie.me/On-Torchtext/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://medium.com/@datamonsters/text-preprocessing-in-python-steps-tools-and-examples-bf025f872908&quot;&gt;https://medium.com/@datamonsters/text-preprocessing-in-python-steps-tools-and-examples-bf025f872908&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;</content><author><name>Matías Battocchia</name></author><summary type="html"></summary></entry><entry><title type="html">Graph isomorphism networks</title><link href="https://matiasbattocchia.github.io/datitos/Graph-isomorphism-network.html" rel="alternate" type="text/html" title="Graph isomorphism networks" /><published>2019-10-24T00:00:00-05:00</published><updated>2019-10-24T00:00:00-05:00</updated><id>https://matiasbattocchia.github.io/datitos/Graph-isomorphism-network</id><content type="html" xml:base="https://matiasbattocchia.github.io/datitos/Graph-isomorphism-network.html">&lt;!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2019-10-24-Graph-isomorphism-network.ipynb
--&gt;

&lt;div class=&quot;container&quot; id=&quot;notebook-container&quot;&gt;
        
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Estas notas corresponden a la sección de código de una charla que di en el seminario &lt;a href=&quot;https://twitter.com/machinlenin&quot;&gt;MachinLenin&lt;/a&gt; en 2019. Esta es la &lt;a href=&quot;https://docs.google.com/presentation/d/1y9-4LMrm0UPqwYYBWwTMn-ixBazD8-nRnr6EIn53Nig/edit?usp=sharing&quot;&gt;presentación&lt;/a&gt; que usé y este el &lt;a href=&quot;https://github.com/matiasbattocchia/gin&quot;&gt;repositorio&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Esta es una implementación simple, con fines didácticos y para nada eficiente de la publicación &lt;a href=&quot;https://arxiv.org/pdf/1810.00826.pdf&quot;&gt;How powerful are graph neural networks?&lt;/a&gt;. Para una implementación eficiente ver &lt;a href=&quot;https://docs.dgl.ai/api/python/nn.pytorch.html#ginconv&quot;&gt;GINConv&lt;/a&gt; de Deep Graph Library (DGL).&lt;/p&gt;
&lt;p&gt;La publicación mencionada fue la que elegí para comenzar a aprender sobre redes neuronales de grafos (&lt;em&gt;graph neural networks&lt;/em&gt; o GNN). Unas redes interesantes porque no todo es texto, ni todo son imágenes, ni tablas... una vasta cantidad de información se representa en forma de grafo, y estas redes se especializan en esta estructura de datos.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Publicaciones&quot;&gt;Publicaciones&lt;a class=&quot;anchor-link&quot; href=&quot;#Publicaciones&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Hoy en día si tuviese que recomendar lecturas introductorias, serían los &lt;em&gt;reviews&lt;/em&gt; de esta lista.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Reviews&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://arxiv.org/pdf/2003.00982.pdf&quot;&gt;Benchmarking Graph Neural Networks&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://arxiv.org/abs/1709.05584&quot;&gt;Representation Learning on Graphs: Methods and Applications&lt;/a&gt; | &lt;a href=&quot;http://snap.stanford.edu/proj/embeddings-www/&quot;&gt;http://snap.stanford.edu/proj/embeddings-www/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;Arquitecturas&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://arxiv.org/pdf/1710.10903&quot;&gt;GAT&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://arxiv.org/pdf/1810.00826&quot;&gt;GIN&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://arxiv.org/abs/1609.02907&quot;&gt;GCN&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://arxiv.org/pdf/1706.02216.pdf&quot;&gt;GraphSAGE&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;torch&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;networkx&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;nx&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;matplotlib&lt;/span&gt; inline
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Adjacency-matrix&quot;&gt;Adjacency matrix&lt;a class=&quot;anchor-link&quot; href=&quot;#Adjacency-matrix&quot;&gt; &lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;G&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nx&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;binomial_graph&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# TODO: numerar los nodos en el gráfico&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;nx&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;draw&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;G&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;A&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tensor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nx&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;adjacency_matrix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;G&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;todense&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dtype&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;float32&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;tensor([[0., 0., 1., 1., 0.],
        [0., 0., 0., 1., 1.],
        [1., 0., 0., 1., 1.],
        [1., 1., 1., 0., 1.],
        [0., 1., 1., 1., 0.]])&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;randint&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;low&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;high&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dtype&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;float32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;tensor([[0., 1.],
        [0., 0.],
        [1., 0.],
        [0., 0.],
        [0., 0.]])&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;A&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;@&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;tensor([[1., 0.],
        [0., 0.],
        [0., 1.],
        [1., 1.],
        [1., 0.]])&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Dataset&quot;&gt;Dataset&lt;a class=&quot;anchor-link&quot; href=&quot;#Dataset&quot;&gt; &lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;torch.utils.data&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;importlib&lt;/span&gt;  
&lt;span class=&quot;n&quot;&gt;gnns&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;importlib&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;import_module&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;powerful-gnns.util&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;GraphDataset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;utils&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Dataset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;sd&quot;&gt;&amp;quot;&amp;quot;&amp;quot; Levanta los datasets de Powerful-GNNS. &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dataset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;degree_as_tag&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;classes&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;gnns&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;load_data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dataset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;degree_as_tag&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;features&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;node_features&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;fm&quot;&gt;__len__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;fm&quot;&gt;__getitem__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;idx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;graph&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;idx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;adjacency_matrix&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nx&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;adjacency_matrix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;graph&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;g&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;todense&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        
        &lt;span class=&quot;n&quot;&gt;item&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{}&lt;/span&gt;

        &lt;span class=&quot;n&quot;&gt;item&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;adjacency_matrix&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tensor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;adjacency_matrix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dtype&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;float32&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;item&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;node_features&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;graph&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;node_features&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;item&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;label&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;graph&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;label&lt;/span&gt;
        
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;item&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DS&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;GraphDataset&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;PROTEINS&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;loading data
# classes: 2
# maximum node tag: 3
# data: 1113
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DL&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;utils&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DataLoader&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Net-modules&quot;&gt;Net modules&lt;a class=&quot;anchor-link&quot; href=&quot;#Net-modules&quot;&gt; &lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;GINConv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Module&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hidden_dim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;super&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;linear&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Linear&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hidden_dim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hidden_dim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;forward&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;sd&quot;&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        Params&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        ------&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        A [batch x nodes x nodes]: adjacency matrix&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        X [batch x nodes x features]: node features matrix&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        &lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        Returns&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        -------&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        X&amp;#39; [batch x nodes x features]: updated node features matrix&lt;/span&gt;
&lt;span class=&quot;sd&quot;&gt;        &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;X&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;linear&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;A&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;@&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;X&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;functional&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;relu&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;GNN&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Module&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;input_dim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hidden_dim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;output_dim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_layers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;nb&quot;&gt;super&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;fm&quot;&gt;__init__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;in_proj&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Linear&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;input_dim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hidden_dim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;convs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ModuleList&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;_&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_layers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
            &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;convs&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;GINConv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hidden_dim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
        
        &lt;span class=&quot;c1&quot;&gt;# In order to perform graph classification, each hidden state&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# [batch x nodes x hidden_dim] is concatenated, resulting in&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# [batch x nodes x hiddem_dim*(1+n_layers)], then aggregated&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# along nodes dimension, without keeping that dimension:&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;# [batch x hiddem_dim*(1+n_layers)].&lt;/span&gt;
        &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;out_proj&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Linear&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hidden_dim&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_layers&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;output_dim&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;forward&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;X&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;in_proj&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;n&quot;&gt;hidden_states&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        
        &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;layer&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;convs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;X&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;layer&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
            &lt;span class=&quot;n&quot;&gt;hidden_states&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;append&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;n&quot;&gt;X&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hidden_states&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;dim&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dim&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;n&quot;&gt;X&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;bp&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;out_proj&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Train-loop&quot;&gt;Train loop&lt;a class=&quot;anchor-link&quot; href=&quot;#Train-loop&quot;&gt; &lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;GNN&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;input_dim&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;features&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hidden_dim&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;output_dim&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DS&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;classes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_layers&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;criterion&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nn&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;CrossEntropyLoss&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;torch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;optim&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Adam&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;parameters&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;lr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.01&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;EPOCHS&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;epoch&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;EPOCHS&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;running_loss&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.0&lt;/span&gt;
    
    &lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;batch&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;enumerate&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DL&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;A&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;batch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;adjacency_matrix&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;X&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;batch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;node_features&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;labels&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;batch&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;label&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
                
        &lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;zero_grad&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

        &lt;span class=&quot;n&quot;&gt;outputs&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;A&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;criterion&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;outputs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;labels&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;backward&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;optimizer&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;step&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

        &lt;span class=&quot;n&quot;&gt;running_loss&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;loss&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;item&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
    
    &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;sa&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;epoch&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt; - loss: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;running_loss&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;si&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;0 - loss: 1.2691171061103663
1 - loss: 0.32851389047806046
2 - loss: 0.944981049655904
3 - loss: 0.2894633889519622
4 - loss: 0.3056941165221455
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;TODO&quot;&gt;TODO&lt;a class=&quot;anchor-link&quot; href=&quot;#TODO&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;Dropout&lt;/li&gt;
&lt;li&gt;Mini-batches (&lt;code&gt;collate_fn&lt;/code&gt; for padding)&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Batch normalization&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Extended neighborhood &lt;code&gt;X = self.linear(X + A @ X + A**2 @ X)&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;Node classification&lt;/li&gt;
&lt;li&gt;Link prediction&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;</content><author><name>Matías Battocchia</name></author><summary type="html"></summary></entry><entry><title type="html">Grafos</title><link href="https://matiasbattocchia.github.io/datitos/Grafos.html" rel="alternate" type="text/html" title="Grafos" /><published>2019-09-27T00:00:00-05:00</published><updated>2019-09-27T00:00:00-05:00</updated><id>https://matiasbattocchia.github.io/datitos/Grafos</id><content type="html" xml:base="https://matiasbattocchia.github.io/datitos/Grafos.html">&lt;!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2019-09-27-Grafos.ipynb
--&gt;

&lt;div class=&quot;container&quot; id=&quot;notebook-container&quot;&gt;
        
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Este es el material de una clase que doy en Digital House en el curso de ciencia de datos.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;&amp;#191;Qu&amp;#233;-es-un-grafo?&quot;&gt;&amp;#191;Qu&amp;#233; es un grafo?&lt;a class=&quot;anchor-link&quot; href=&quot;#&amp;#191;Qu&amp;#233;-es-un-grafo?&quot;&gt; &lt;/a&gt;&lt;/h3&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;img src=&quot;https://upload.wikimedia.org/wikipedia/commons/5/5b/6n-graf.svg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;ul&gt;
&lt;li&gt;Red — grafo, &lt;em&gt;graph&lt;/em&gt;&lt;ul&gt;
&lt;li&gt;Nodos — vértices, &lt;em&gt;nodes&lt;/em&gt;&lt;/li&gt;
&lt;li&gt;Conexiones — aristas, bordes, &lt;em&gt;edges&lt;/em&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;&amp;#191;Para-qu&amp;#233;-sirven?&quot;&gt;&amp;#191;Para qu&amp;#233; sirven?&lt;a class=&quot;anchor-link&quot; href=&quot;#&amp;#191;Para-qu&amp;#233;-sirven?&quot;&gt; &lt;/a&gt;&lt;/h3&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h4 id=&quot;Redes-de-transporte&quot;&gt;Redes de transporte&lt;a class=&quot;anchor-link&quot; href=&quot;#Redes-de-transporte&quot;&gt; &lt;/a&gt;&lt;/h4&gt;&lt;p&gt;&lt;img src=&quot;https://sites.google.com/site/aplicaciongrafos/_/rsrc/1320026146976/home/ciudades.PNG&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h4 id=&quot;Redes-de-interacci&amp;#243;n&quot;&gt;Redes de interacci&amp;#243;n&lt;a class=&quot;anchor-link&quot; href=&quot;#Redes-de-interacci&amp;#243;n&quot;&gt; &lt;/a&gt;&lt;/h4&gt;&lt;p&gt;&lt;img src=&quot;https://upload.wikimedia.org/wikipedia/commons/thumb/e/ef/Network_representation_of_brain_connectivity.JPG/1280px-Network_representation_of_brain_connectivity.JPG&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h4 id=&quot;Redes-de-comunicaci&amp;#243;n&quot;&gt;Redes de comunicaci&amp;#243;n&lt;a class=&quot;anchor-link&quot; href=&quot;#Redes-de-comunicaci&amp;#243;n&quot;&gt; &lt;/a&gt;&lt;/h4&gt;&lt;p&gt;&lt;img src=&quot;https://www.researchgate.net/profile/Santiago_Bianco/publication/309278789/figure/fig25/AS:750920430284803@1556044790504/Ejemplo-de-red-de-comunicacion-con-componentes-electronicos-y-su-posible-modelizacion.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Es una estructura de datos útil para representar:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;redes sociales&lt;/li&gt;
&lt;li&gt;máquinas de estado&lt;/li&gt;
&lt;li&gt;moléculas&lt;/li&gt;
&lt;li&gt;mapas conceptuales&lt;/li&gt;
&lt;li&gt;estructura del lenguaje&lt;/li&gt;
&lt;li&gt;redes de transporte&lt;/li&gt;
&lt;li&gt;y mucho más...&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Ver &lt;a href=&quot;https://es.wikipedia.org/wiki/Anexo:Glosario_de_teor%C3%ADa_de_grafos&quot;&gt;glosario de teoría de grafos&lt;/a&gt;.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;NetworkX&quot;&gt;NetworkX&lt;a class=&quot;anchor-link&quot; href=&quot;#NetworkX&quot;&gt; &lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;a href=&quot;https://networkx.github.io&quot;&gt;https://networkx.github.io&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;NetworkX es un paquete de Python para la creación, manipulación, y el estudio de la estructura, dinámica, y las funciones de las redes complejas.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;!&lt;/span&gt;pip install --upgrade networkx
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;matplotlib&lt;/span&gt; inline

&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;networkx&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;nx&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;G&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nx&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Graph&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;G&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;add_node&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Buenos Aires&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;G&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;add_node&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Córdoba&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;G&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;add_node&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Mendoza&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;nx&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;draw&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;G&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;G&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;add_edge&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Buenos Aires&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Córdoba&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;distancia&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;647&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;G&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;add_edge&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Buenos Aires&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Mendoza&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;distancia&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;948&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;G&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;add_edge&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Córdoba&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;      &lt;span class=&quot;s1&quot;&gt;&amp;#39;Mendoza&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;distancia&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;682&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;nx&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;draw&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;G&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;G&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;add_edge&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Tucumán&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Salta&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;distancia&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;227&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;nx&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;draw&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;G&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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ePH4uShFtMXzDgHq0ZLwnZ+aiS/++IWm7hO5nLB1dXXdMGqf/vSnb+uwLdfE1Ezsf/V0Wz/vEGApLQlfM9aQdcZ8bJs+Hp1vHhY2AJatJev4RscuNBS9iIi56Iha76Z44oknhA2AZWtJ+C5MV5tynE1bB+LrX/9cU44FQA4drfimPZXm9NY+kQCsVEvCN9jfE93lxr61fSIBqEdLwrf3ocb3d7RPJAD1aEn41q3tjke2rY9Sqb6vL5U+WlPm9noAVqol4YuIeGpoICrlzrq+tlLujCeHPJ8PgJVrWfj2bOmNpx8bjDVdKxvho30iB+0eAkBdWvo8viv7PdonEoDV0vLHEkXYJxKA1VOI8F1hn0gAbrVChQ8AbrWW3dwCAK0gfACkInwApCJ8AKQifACkInwApCJ8AKQifACkInwApCJ8AKQifACkInwApCJ8AKQifACkInwApCJ8AKQifACkInwApCJ8AKQifACkInwApCJ8AKQifACkInwApCJ8AKQifACkInwApCJ8AKQifACkInwApCJ8AKQifACkInwApCJ8AKQifACkInwApCJ8AKQifACkInwApCJ8AKQifACkInwApCJ8AKQifACkInwApCJ8AKQifACkInwApCJ8AKQifACkInwApCJ8AKQifACkInwApCJ8AKQifACkInwApCJ8AKQifACkInwApCJ8AKQifACkInwApCJ8AKQifACkInwApCJ8AKQifACkInwApCJ8AKQifACkInwApCJ8AKQifACkInwApCJ8AKQifACkInwApCJ8AKQifACkInwApCJ8AKQifACkInwApCJ8AKQifACkInwApCJ8AKQifACkInwApCJ8AKQifACkInwApCJ8AKQifACkInwApCJ8AKQifACkInwApCJ8AKQifACkInwApCJ8AKQifACkInwApCJ8AKQifACkInwApCJ8AKQifACkInwApCJ8AKQifACkInwApCJ8AKQifACkInwApCJ8AKQifACkInwApCJ8AKQifACkInwApCJ8AKQifACkInwApCJ8AKQifACkInwApCJ8AKQifACkInwApCJ8AKQifACkInwApCJ8AKQifACkInwApCJ8AKQifACkInwApCJ8AKQifACkInwApCJ8AKQifACkInwApCJ8AKQifACkInwApCJ8AKQifACkInwApCJ8AKQifACkInwApCJ8AKQifACkInwApCJ8AKQifACkInwApCJ8AKQifACkInwApCJ8AKQifACkInwApCJ8AKQifACkInwApCJ8AKQifACkInwApCJ8AKQifACkInwApCJ8AKQifACkInwApCJ8AKQifACkInwApCJ8AKQifACkInwApCJ8AKQifACkInwApCJ8AKQifACkInwApCJ8AKQifACkInwApCJ8AKRSbvUAANxezk/NxP5XTsfo2IW4MF2Nnko5Bvt74lsPbY6713a3erwo1Wq1WquHAKD9vf7uZDxz+GS8dOJcRETMVOev/l2l3BG1iBjavj6efGQg9mzpbdGUwgdAE/z85VOx79BoTFfnYqmqlEoRlXJnPP3YYDz+ha2rNt+1XOoEoCEfRe9YXJqdv+nn1moRl2bnYt+hYxERLYmfm1sAqNvr707GvkOjy4retS7Nzse+Q6MxfHryFk12Y8IHQN2eOXwypqtzdX3tdHUunj18sskT3ZzwAVCX81Mz8dKJc0u+preUWi3ixePnYmJqprmD3YTwAVCX/a+cbvgYpYjY/2rjx1kJ4QOgLqNjFxYsWajHdHU+Rs9cbNJEy+OuTqBtFX2hdLv7y1/+EuPj4zE+Ph5jY2NX317576PrvhSxblvD3+fC9GwTpl0+4QPaztILpcfiJ786UYiF0kU0PT29KGQ3elutVqOvry/6+/sXvN29e3f09fXFgTN3xu/+p/Fo9VS6mvCTLZ/wAW3lZgulp/8/gs8fHY/fnDjf0oXSq+Xy5cvXPTO73ttLly5FX1/foqANDg7G0NDQgo/39PREqVS64fc999Jb8cfxEw1d7qyUO2Jw4511f3097NwCtI2VLJS+Yk1XRzz92I62i1+1Wo2zZ8/eNGZjY2Nx8eLF2LBhw6KYffxMrb+/P3p7e5eM2Uqcn5qJL/74hYbC113uiN//4CuremnaGR/QFhpdKL17c2/s3tzay55zc3Nx/vz5ZV1mnJycjLvvvntRvLZs2RIPP/zwgo/fdddd0dGx+vcqrlvbHY9sWx+/PDZe15KGUiniy9vXr/rrscIHtIVmLJT+2eMPN3mqiPn5+Xj//fdveDZ27ccmJiait7d30dlYf39/fPazn10QuHXr1kVnZ2fT5222p4YG4r/ePB+XZlf+b1Mpd8aTQwO3YKqlCR9QeM1cKL2cs4tarRYffPDBsl4zO3v2bPT09Fz3JpD7779/wfvr16+Prq7VvZHjVtuzpTeefmywzkvQgy05Cxc+oPCatVD65787GX+3tXzToJ09ezbWrFlz3dfIBgYGFry/YcOGuOOOOxr/IdvYlddP2+XpDG5uAQrv+7/4Uxx87b2GjzM9+pu488iB656dXXv5sa+vLyqVShMmz2X49GQ8e/hkvHj8XJTir3fYRvz1eXxf3r4+nhwaaOnrrcIHFN4//cd/xwujZxs+zqODG+Lf//FzTZiIpUxMzcT+V0/H6JmLcWF6NnoqXTG48c7Y+2AxNhZwqRMovJ5Kc35VrfZC6azuXtsd3/vSfa0e44bs1QkU3mB/T3SXG/t11YqF0hST8AGFt/ehzQ0foxYRex9s/Di0P+EDCu/KQul6Nxxp1UJpikn4gLbw1NBAVMr1Lehu1UJpikn4gLZwZaH0mq6V/dpq5UJpisldnUDbaLeF0hSTdXxA22mXhdIUk/ABbavoC6UpJuEDIBU3twCQivABkIrwAZCK8AGQivABkIrwAZCK8AGQivABkIrwAZCK8AGQivABkIrwAZCK8AGQivABkMr/Adf8BzRwFWSeAAAAAElFTkSuQmCC
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Subgrafo&lt;/strong&gt;: subconjunto de nodos y conexiones.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Componente conectada&lt;/strong&gt;: grupo de nodos conectados.&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;G&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nodes&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;NodeView((&amp;#39;Buenos Aires&amp;#39;, &amp;#39;Córdoba&amp;#39;, &amp;#39;Mendoza&amp;#39;, &amp;#39;Tucumán&amp;#39;, &amp;#39;Salta&amp;#39;))&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;G&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;edges&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;EdgeView([(&amp;#39;Buenos Aires&amp;#39;, &amp;#39;Córdoba&amp;#39;), (&amp;#39;Buenos Aires&amp;#39;, &amp;#39;Mendoza&amp;#39;), (&amp;#39;Córdoba&amp;#39;, &amp;#39;Mendoza&amp;#39;), (&amp;#39;Tucumán&amp;#39;, &amp;#39;Salta&amp;#39;)])&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# grado de un nodo (cantidad de conexiones)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;G&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;degree&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Mendoza&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;2&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Graficando&quot;&gt;Graficando&lt;a class=&quot;anchor-link&quot; href=&quot;#Graficando&quot;&gt; &lt;/a&gt;&lt;/h3&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# posiciones de los nodos; elegir un *layout*&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;pos&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nx&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;planar_layout&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;G&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# dibujar etiquetas&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;nx&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;draw_networkx_labels&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;G&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pos&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# dibujar nodos&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;nx&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;draw_networkx_nodes&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;G&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pos&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# dibujar conexiones&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;nx&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;draw_networkx_edges&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;G&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pos&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pos&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Graficar grafos no es una tarea sencilla y NetworkX lo deja en mano de otras aplicaciones, como &lt;a href=&quot;https://gephi.org&quot;&gt;Gephi&lt;/a&gt;.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Tipos-de-grafos&quot;&gt;Tipos de grafos&lt;a class=&quot;anchor-link&quot; href=&quot;#Tipos-de-grafos&quot;&gt; &lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Dirigido&quot;&gt;Dirigido&lt;a class=&quot;anchor-link&quot; href=&quot;#Dirigido&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;&lt;code&gt;nx.DiGraph&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://upload.wikimedia.org/wikipedia/commons/a/a2/Directed.svg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Multigrafo&quot;&gt;Multigrafo&lt;a class=&quot;anchor-link&quot; href=&quot;#Multigrafo&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;&lt;code&gt;nx.MultiGraph&lt;/code&gt;, &lt;code&gt;nx.MultiDiGraph&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://upload.wikimedia.org/wikipedia/commons/c/c9/Multi-pseudograph.svg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Algoritmos-comunes&quot;&gt;Algoritmos comunes&lt;a class=&quot;anchor-link&quot; href=&quot;#Algoritmos-comunes&quot;&gt; &lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Grafo-de-ejemplo:-Familias-florentinas&quot;&gt;Grafo de ejemplo: Familias florentinas&lt;a class=&quot;anchor-link&quot; href=&quot;#Grafo-de-ejemplo:-Familias-florentinas&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Familias que se disputaron el control político de la ciudad de Florencia alrededor de 1430. Dos facciones fueron dominantes en la disputa: Medicis y Strozzis.&lt;/p&gt;
&lt;p&gt;Dataset de uniones maritales y de negocio entre familias.&lt;/p&gt;
&lt;p&gt;Fuente: &lt;em&gt;Padgett, J. F., &amp;amp; Ansell, C. K. (1993). Robust Action and the Rise of the Medici, 1400-1434. American Journal of Sociology, 98(6), 1259-1319.&lt;/em&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;G&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nx&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;florentine_families_graph&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;nx&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;draw_networkx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;G&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;G&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nodes&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;NodeView((&amp;#39;Acciaiuoli&amp;#39;, &amp;#39;Medici&amp;#39;, &amp;#39;Castellani&amp;#39;, &amp;#39;Peruzzi&amp;#39;, &amp;#39;Strozzi&amp;#39;, &amp;#39;Barbadori&amp;#39;, &amp;#39;Ridolfi&amp;#39;, &amp;#39;Tornabuoni&amp;#39;, &amp;#39;Albizzi&amp;#39;, &amp;#39;Salviati&amp;#39;, &amp;#39;Pazzi&amp;#39;, &amp;#39;Bischeri&amp;#39;, &amp;#39;Guadagni&amp;#39;, &amp;#39;Ginori&amp;#39;, &amp;#39;Lamberteschi&amp;#39;))&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Componentes-conectadas&quot;&gt;Componentes conectadas&lt;a class=&quot;anchor-link&quot; href=&quot;#Componentes-conectadas&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Component_(graph_theory&quot;&gt;https://en.wikipedia.org/wiki/Component_(graph_theory&lt;/a&gt;)&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://upload.wikimedia.org/wikipedia/commons/8/85/Pseudoforest.svg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# el grafo de ejemplo solo tiene una componente conectada&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;sub_graph&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nx&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;connected_components&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;G&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;):&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sub_graph&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;{&amp;#39;Strozzi&amp;#39;, &amp;#39;Bischeri&amp;#39;, &amp;#39;Acciaiuoli&amp;#39;, &amp;#39;Salviati&amp;#39;, &amp;#39;Pazzi&amp;#39;, &amp;#39;Castellani&amp;#39;, &amp;#39;Ridolfi&amp;#39;, &amp;#39;Albizzi&amp;#39;, &amp;#39;Peruzzi&amp;#39;, &amp;#39;Medici&amp;#39;, &amp;#39;Ginori&amp;#39;, &amp;#39;Lamberteschi&amp;#39;, &amp;#39;Barbadori&amp;#39;, &amp;#39;Tornabuoni&amp;#39;, &amp;#39;Guadagni&amp;#39;}
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;El-camino-m&amp;#225;s-corto&quot;&gt;El camino m&amp;#225;s corto&lt;a class=&quot;anchor-link&quot; href=&quot;#El-camino-m&amp;#225;s-corto&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Shortest_path_problem&quot;&gt;https://en.wikipedia.org/wiki/Shortest_path_problem&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://upload.wikimedia.org/wikipedia/commons/3/3b/Shortest_path_with_direct_weights.svg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Camino&lt;/strong&gt;: secuencia de nodos conectados.&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&quot;Aplicaciones&quot;&gt;Aplicaciones&lt;a class=&quot;anchor-link&quot; href=&quot;#Aplicaciones&quot;&gt; &lt;/a&gt;&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;Google Maps&lt;/li&gt;
&lt;li&gt;LinkedIn&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nx&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shortest_path&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;G&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;source&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Medici&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;target&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Strozzi&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;weight&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;[&amp;#39;Medici&amp;#39;, &amp;#39;Ridolfi&amp;#39;, &amp;#39;Strozzi&amp;#39;]&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;&amp;#193;rbol-recubridor-m&amp;#237;nimo&quot;&gt;&amp;#193;rbol recubridor m&amp;#237;nimo&lt;a class=&quot;anchor-link&quot; href=&quot;#&amp;#193;rbol-recubridor-m&amp;#237;nimo&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Minimum_spanning_tree&quot;&gt;https://en.wikipedia.org/wiki/Minimum_spanning_tree&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://upload.wikimedia.org/wikipedia/commons/d/d2/Minimum_spanning_tree.svg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
&lt;h4 id=&quot;Aplicaciones&quot;&gt;Aplicaciones&lt;a class=&quot;anchor-link&quot; href=&quot;#Aplicaciones&quot;&gt; &lt;/a&gt;&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;Tendido de redes&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mst&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nx&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;minimum_spanning_tree&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;G&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;weight&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;nx&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;draw_networkx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mst&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Pagerank&quot;&gt;Pagerank&lt;a class=&quot;anchor-link&quot; href=&quot;#Pagerank&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/PageRank&quot;&gt;https://en.wikipedia.org/wiki/PageRank&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://upload.wikimedia.org/wikipedia/en/8/8b/PageRanks-Example.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rank&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nx&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pagerank&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;G&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;weight&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;sorted&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rank&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;items&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;lambda&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;item&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;item&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reverse&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;[(&amp;#39;Medici&amp;#39;, 0.14581844065218275),
 (&amp;#39;Guadagni&amp;#39;, 0.09839859717156552),
 (&amp;#39;Strozzi&amp;#39;, 0.08809849082725613),
 (&amp;#39;Albizzi&amp;#39;, 0.079121502380729),
 (&amp;#39;Tornabuoni&amp;#39;, 0.07127928374676082)]&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Ejemplo de uso en aprendizaje automático: &lt;a href=&quot;https://towardsdatascience.com/investor-network-of-influence-f80f2a1af43f&quot;&gt;Red de influencia de inversores&lt;/a&gt;.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Intermediaci&amp;#243;n&quot;&gt;Intermediaci&amp;#243;n&lt;a class=&quot;anchor-link&quot; href=&quot;#Intermediaci&amp;#243;n&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Betweenness_centrality&quot;&gt;https://en.wikipedia.org/wiki/Betweenness_centrality&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://upload.wikimedia.org/wikipedia/commons/6/60/Graph_betweenness.svg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rank&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nx&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;betweenness_centrality&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;G&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;weight&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;sorted&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rank&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;items&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;lambda&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;item&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;item&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;reverse&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;[(&amp;#39;Medici&amp;#39;, 0.521978021978022),
 (&amp;#39;Guadagni&amp;#39;, 0.2545787545787546),
 (&amp;#39;Albizzi&amp;#39;, 0.21245421245421245),
 (&amp;#39;Salviati&amp;#39;, 0.14285714285714288),
 (&amp;#39;Ridolfi&amp;#39;, 0.11355311355311355)]&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Modularidad&quot;&gt;Modularidad&lt;a class=&quot;anchor-link&quot; href=&quot;#Modularidad&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Modularity_(networks&quot;&gt;https://en.wikipedia.org/wiki/Modularity_(networks&lt;/a&gt;)&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://www.pnas.org/content/pnas/103/23/8577/F1.large.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nx&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;algorithms&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;community&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;modularity_max&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;greedy_modularity_communities&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;G&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;[frozenset({&amp;#39;Acciaiuoli&amp;#39;,
            &amp;#39;Medici&amp;#39;,
            &amp;#39;Pazzi&amp;#39;,
            &amp;#39;Ridolfi&amp;#39;,
            &amp;#39;Salviati&amp;#39;,
            &amp;#39;Tornabuoni&amp;#39;}),
 frozenset({&amp;#39;Barbadori&amp;#39;, &amp;#39;Bischeri&amp;#39;, &amp;#39;Castellani&amp;#39;, &amp;#39;Peruzzi&amp;#39;, &amp;#39;Strozzi&amp;#39;}),
 frozenset({&amp;#39;Albizzi&amp;#39;, &amp;#39;Ginori&amp;#39;, &amp;#39;Guadagni&amp;#39;, &amp;#39;Lamberteschi&amp;#39;})]&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;&amp;#205;ndice-Adamic/Adar&quot;&gt;&amp;#205;ndice Adamic/Adar&lt;a class=&quot;anchor-link&quot; href=&quot;#&amp;#205;ndice-Adamic/Adar&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Adamic/Adar_index&quot;&gt;https://en.wikipedia.org/wiki/Adamic/Adar_index&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://www.researchgate.net/profile/Giulio_Rossetti/publication/281319964/figure/fig7/AS:614383981961223@1523491964917/Link-Prediction-an-example.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
&lt;h4 id=&quot;Aplicaciones&quot;&gt;Aplicaciones&lt;a class=&quot;anchor-link&quot; href=&quot;#Aplicaciones&quot;&gt; &lt;/a&gt;&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;Recomendación de contactos&lt;/li&gt;
&lt;li&gt;Recomendación de productos&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;predicciones&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nx&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;adamic_adar_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;G&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ebunch&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Medici&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Strozzi&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Medici&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Pazzi&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)])&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;predicción&lt;/span&gt; &lt;span class=&quot;ow&quot;&gt;in&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;predicciones&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;predicción&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;(&amp;#39;Medici&amp;#39;, &amp;#39;Strozzi&amp;#39;, 0.9102392266268373)
(&amp;#39;Medici&amp;#39;, &amp;#39;Pazzi&amp;#39;, 1.4426950408889634)
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Pandas&quot;&gt;Pandas&lt;a class=&quot;anchor-link&quot; href=&quot;#Pandas&quot;&gt; &lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pandas&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pd&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;URL&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;http://cdn.buenosaires.gob.ar/datosabiertos/datasets/bicicletas-publicas/recorridos-realizados-2019.csv&amp;#39;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;ARCHIVO&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;muestreo_recorridos.csv.gz&amp;#39;&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;read_csv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ARCHIVO&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;low_memory&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;info&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;&amp;lt;class &amp;#39;pandas.core.frame.DataFrame&amp;#39;&amp;gt;
RangeIndex: 2850451 entries, 0 to 2850450
Data columns (total 19 columns):
id_usuario                    object
edad_usuario                  float64
genero_usuario                object
fecha_origen_recorrido        object
id_estacion_origen            object
nombre_estacion_origen        object
direccion_estacion_origen     object
capacidad_estacion_origen     float64
lat_estacion_origen           float64
long_estacion_origen          float64
duracion_recorrido            object
fecha_destino_recorrido       object
id_estacion_destino           object
nombre_estacion_destino       object
direccion_estacion_destino    object
capacidad_estacion_destino    float64
lat_estacion_destino          float64
long_estacion_destino         float64
servicio                      object
dtypes: float64(7), object(12)
memory usage: 413.2+ MB
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;head&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea output_execute_result&quot;&gt;
&lt;div&gt;
&lt;style scoped=&quot;&quot;&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;
  &lt;thead&gt;
    &lt;tr style=&quot;text-align: right;&quot;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;id_usuario&lt;/th&gt;
      &lt;th&gt;edad_usuario&lt;/th&gt;
      &lt;th&gt;genero_usuario&lt;/th&gt;
      &lt;th&gt;fecha_origen_recorrido&lt;/th&gt;
      &lt;th&gt;id_estacion_origen&lt;/th&gt;
      &lt;th&gt;nombre_estacion_origen&lt;/th&gt;
      &lt;th&gt;direccion_estacion_origen&lt;/th&gt;
      &lt;th&gt;capacidad_estacion_origen&lt;/th&gt;
      &lt;th&gt;lat_estacion_origen&lt;/th&gt;
      &lt;th&gt;long_estacion_origen&lt;/th&gt;
      &lt;th&gt;duracion_recorrido&lt;/th&gt;
      &lt;th&gt;fecha_destino_recorrido&lt;/th&gt;
      &lt;th&gt;id_estacion_destino&lt;/th&gt;
      &lt;th&gt;nombre_estacion_destino&lt;/th&gt;
      &lt;th&gt;direccion_estacion_destino&lt;/th&gt;
      &lt;th&gt;capacidad_estacion_destino&lt;/th&gt;
      &lt;th&gt;lat_estacion_destino&lt;/th&gt;
      &lt;th&gt;long_estacion_destino&lt;/th&gt;
      &lt;th&gt;servicio&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;137063_0&lt;/td&gt;
      &lt;td&gt;26.0&lt;/td&gt;
      &lt;td&gt;FEMENINO&lt;/td&gt;
      &lt;td&gt;2019-01-07 17:06:49&lt;/td&gt;
      &lt;td&gt;156.0&lt;/td&gt;
      &lt;td&gt;Plaza Alemania&lt;/td&gt;
      &lt;td&gt;Plaza Alemania: Del Libertador Av y Cavia&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;-34.577849&lt;/td&gt;
      &lt;td&gt;-58.407966&lt;/td&gt;
      &lt;td&gt;0 days 00:24:48.000000000&lt;/td&gt;
      &lt;td&gt;2019-01-07 17:31:37&lt;/td&gt;
      &lt;td&gt;170.0&lt;/td&gt;
      &lt;td&gt;San Luis y Ecuador&lt;/td&gt;
      &lt;td&gt;San Luis 2862 entre Ecuador y Boulogne Sur Mer&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;-34.599733&lt;/td&gt;
      &lt;td&gt;-58.405966&lt;/td&gt;
      &lt;td&gt;antiguo&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;79103&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;2019-06-10 11:51:12&lt;/td&gt;
      &lt;td&gt;29.0&lt;/td&gt;
      &lt;td&gt;Parque Centenario&lt;/td&gt;
      &lt;td&gt;Patricias Argentinas Av. y Estivao&lt;/td&gt;
      &lt;td&gt;30.0&lt;/td&gt;
      &lt;td&gt;-34.607941&lt;/td&gt;
      &lt;td&gt;-58.433557&lt;/td&gt;
      &lt;td&gt;0 days 00:24:57.000000000&lt;/td&gt;
      &lt;td&gt;2019-06-10 12:16:09&lt;/td&gt;
      &lt;td&gt;87.0&lt;/td&gt;
      &lt;td&gt;Guayaquil&lt;/td&gt;
      &lt;td&gt;Guayaquil y Doblas&lt;/td&gt;
      &lt;td&gt;16.0&lt;/td&gt;
      &lt;td&gt;-34.619845&lt;/td&gt;
      &lt;td&gt;-58.431494&lt;/td&gt;
      &lt;td&gt;nuevo&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;387321&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;2019-07-30 15:20:38&lt;/td&gt;
      &lt;td&gt;289.0&lt;/td&gt;
      &lt;td&gt;BARRANCAS DE BELGRANO&lt;/td&gt;
      &lt;td&gt;Sucre, Antonio Jose De, Mcal. y Vertiz Virrey Av.&lt;/td&gt;
      &lt;td&gt;24.0&lt;/td&gt;
      &lt;td&gt;-34.559793&lt;/td&gt;
      &lt;td&gt;-58.448432&lt;/td&gt;
      &lt;td&gt;0 days 00:51:39.000000000&lt;/td&gt;
      &lt;td&gt;2019-07-30 16:12:17&lt;/td&gt;
      &lt;td&gt;175.0&lt;/td&gt;
      &lt;td&gt;Constitución&lt;/td&gt;
      &lt;td&gt;Garay, Juan De Av. 1050&lt;/td&gt;
      &lt;td&gt;36.0&lt;/td&gt;
      &lt;td&gt;-34.626741&lt;/td&gt;
      &lt;td&gt;-58.380935&lt;/td&gt;
      &lt;td&gt;nuevo&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;113196&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;2019-04-28 00:59:32&lt;/td&gt;
      &lt;td&gt;56.0&lt;/td&gt;
      &lt;td&gt;Plaza Palermo Viejo&lt;/td&gt;
      &lt;td&gt;Costa Rica y Armenia&lt;/td&gt;
      &lt;td&gt;16.0&lt;/td&gt;
      &lt;td&gt;-34.588567&lt;/td&gt;
      &lt;td&gt;-58.425999&lt;/td&gt;
      &lt;td&gt;0 days 00:21:24.000000000&lt;/td&gt;
      &lt;td&gt;2019-04-28 01:20:56&lt;/td&gt;
      &lt;td&gt;69.0&lt;/td&gt;
      &lt;td&gt;Ecuador&lt;/td&gt;
      &lt;td&gt;Ecuador 1226&lt;/td&gt;
      &lt;td&gt;16.0&lt;/td&gt;
      &lt;td&gt;-34.596101&lt;/td&gt;
      &lt;td&gt;-58.404609&lt;/td&gt;
      &lt;td&gt;nuevo&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;248012&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;2019-06-12 15:04:26&lt;/td&gt;
      &lt;td&gt;153.0&lt;/td&gt;
      &lt;td&gt;JUAN MANUEL DE BLANES&lt;/td&gt;
      &lt;td&gt;Blanes, Juan Manuel 383&lt;/td&gt;
      &lt;td&gt;16.0&lt;/td&gt;
      &lt;td&gt;-34.630777&lt;/td&gt;
      &lt;td&gt;-58.362070&lt;/td&gt;
      &lt;td&gt;0 days 00:13:16.000000000&lt;/td&gt;
      &lt;td&gt;2019-06-12 15:17:42&lt;/td&gt;
      &lt;td&gt;126.0&lt;/td&gt;
      &lt;td&gt;MINISTERIO DE JUSTICIA  Y SEGURIDAD&lt;/td&gt;
      &lt;td&gt;Regimiento De Patricios Av. y Araoz De Lamadri...&lt;/td&gt;
      &lt;td&gt;16.0&lt;/td&gt;
      &lt;td&gt;-34.640267&lt;/td&gt;
      &lt;td&gt;-58.369224&lt;/td&gt;
      &lt;td&gt;nuevo&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;El DataFrame debe contener al menos dos columnas con nombres de nodos (origen y destino) y cero o más columnas con atributos de las conexiones.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Cada fila se procesa como una conexión&lt;/strong&gt;.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;minutos_viaje&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to_timedelta&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;duracion_recorrido&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;unit&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;minute&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;errors&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;coerce&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pre_grafo&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;groupby&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;nombre_estacion_origen&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;nombre_estacion_destino&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt; \
    &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;minutos_viaje&lt;/span&gt; \
    &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;numeric_only&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; \
    &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to_frame&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; \
    &lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reset_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;pre_grafo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;head&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea output_execute_result&quot;&gt;
&lt;div&gt;
&lt;style scoped=&quot;&quot;&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;
  &lt;thead&gt;
    &lt;tr style=&quot;text-align: right;&quot;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;nombre_estacion_origen&lt;/th&gt;
      &lt;th&gt;nombre_estacion_destino&lt;/th&gt;
      &lt;th&gt;minutos_viaje&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;11 de septiembre&lt;/td&gt;
      &lt;td&gt;11 de septiembre&lt;/td&gt;
      &lt;td&gt;00:59:58.833333&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;11 de septiembre&lt;/td&gt;
      &lt;td&gt;Arribeños&lt;/td&gt;
      &lt;td&gt;00:08:51&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;11 de septiembre&lt;/td&gt;
      &lt;td&gt;BARRANCAS DE BELGRANO&lt;/td&gt;
      &lt;td&gt;00:14:15&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;11 de septiembre&lt;/td&gt;
      &lt;td&gt;Balbín&lt;/td&gt;
      &lt;td&gt;00:10:22&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;11 de septiembre&lt;/td&gt;
      &lt;td&gt;Catedral&lt;/td&gt;
      &lt;td&gt;00:54:11&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;estaciones&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;nx&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;convert_matrix&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;from_pandas_edgelist&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;pre_grafo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;source&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;nombre_estacion_origen&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;target&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;nombre_estacion_destino&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;edge_attr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;minutos_viaje&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;create_using&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nx&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;MultiDiGraph&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nx&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;draw&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;estaciones&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;😱 😱 😱&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Pr&amp;#225;ctica&quot;&gt;Pr&amp;#225;ctica&lt;a class=&quot;anchor-link&quot; href=&quot;#Pr&amp;#225;ctica&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;h3 id=&quot;Dataset&quot;&gt;Dataset&lt;a class=&quot;anchor-link&quot; href=&quot;#Dataset&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;&lt;a href=&quot;https://data.buenosaires.gob.ar/dataset/bicicletas-publicas&quot;&gt;https://data.buenosaires.gob.ar/dataset/bicicletas-publicas&lt;/a&gt;&lt;/p&gt;
&lt;h4 id=&quot;M&amp;#225;s-datasets&quot;&gt;M&amp;#225;s datasets&lt;a class=&quot;anchor-link&quot; href=&quot;#M&amp;#225;s-datasets&quot;&gt; &lt;/a&gt;&lt;/h4&gt;&lt;p&gt;&lt;a href=&quot;https://snap.stanford.edu/data/&quot;&gt;https://snap.stanford.edu/data/&lt;/a&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Ideas&quot;&gt;Ideas&lt;a class=&quot;anchor-link&quot; href=&quot;#Ideas&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;https://medium.com/@fcatalano/bicisendas-en-buenos-aires-a29f62bc9e7c&quot;&gt;https://medium.com/@fcatalano/bicisendas-en-buenos-aires-a29f62bc9e7c&lt;/a&gt; — &quot;La red de bicicletas fue diagramada como un &lt;strong&gt;grafo dirigido&lt;/strong&gt;. Esto, porque nos interesaba representar los recorridos realizados respetando el sentido de los viajes.&quot;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Análisis exploratorio del dataset&lt;/li&gt;
&lt;li&gt;Análisis de &lt;em&gt;in-degree&lt;/em&gt; y &lt;em&gt;out-degree&lt;/em&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;https://towardsdatascience.com/buenos-aires-bicycle-lanes-ii-1a40b13ccc25&quot;&gt;https://towardsdatascience.com/buenos-aires-bicycle-lanes-ii-1a40b13ccc25&lt;/a&gt; — &quot;[...] we built a graph &lt;strong&gt;where two users shared a link if and only if at least one of them had taken a bicycle at approximately the same time from the same station, and returned them together&lt;/strong&gt; (also to the same station).&quot;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Distribución grados&lt;/li&gt;
&lt;li&gt;Análisis exploratorio del grafo&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&quot;https://medium.com/@martinpalazzo/buenos-aires-bicycle-lanes-iii-d0ca4539e767&quot;&gt;https://medium.com/@martinpalazzo/buenos-aires-bicycle-lanes-iii-d0ca4539e767&lt;/a&gt; — &quot;The first step to understand the communities of stations is to build a network where each node is a station and &lt;strong&gt;each edge between station is the quantity of bicycle journeys&lt;/strong&gt;.&quot;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Modularidad&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;</content><author><name>Matías Battocchia</name></author><summary type="html"></summary></entry><entry><title type="html">Pandas (parte 1)</title><link href="https://matiasbattocchia.github.io/datitos/Pandas-parte-1.html" rel="alternate" type="text/html" title="Pandas (parte 1)" /><published>2018-11-11T00:00:00-06:00</published><updated>2018-11-11T00:00:00-06:00</updated><id>https://matiasbattocchia.github.io/datitos/Pandas-parte-1</id><content type="html" xml:base="https://matiasbattocchia.github.io/datitos/Pandas-parte-1.html">&lt;!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2018-11-11-Pandas-parte-1.ipynb
--&gt;

&lt;div class=&quot;container&quot; id=&quot;notebook-container&quot;&gt;
        
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pandas&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pd&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Estructuras-de-datos&quot;&gt;Estructuras de datos&lt;a class=&quot;anchor-link&quot; href=&quot;#Estructuras-de-datos&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Dos tipos de datos muy usados en Python son las listas (&lt;code&gt;list&lt;/code&gt;) y los diccionarios (&lt;code&gt;dict&lt;/code&gt;). Ambos son útiles para coleccionar valores de todo tipo.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lista&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;hidrógeno&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;helio&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;litio&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;lista&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;[&amp;#39;hidrógeno&amp;#39;, &amp;#39;helio&amp;#39;, &amp;#39;litio&amp;#39;]&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Podemos referenciar un valor coleccionado utilizando el &lt;strong&gt;operador índice&lt;/strong&gt; &lt;code&gt;[ ]&lt;/code&gt;. Las listas &lt;em&gt;indexan&lt;/em&gt; por posición. En Python se empieza contar desde cero, por lo tanto las posiciones también.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# get&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;lista&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;&amp;#39;hidrógeno&amp;#39;&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# set&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;lista&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;?&amp;#39;&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;lista&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;[&amp;#39;?&amp;#39;, &amp;#39;helio&amp;#39;, &amp;#39;litio&amp;#39;]&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Los diccionarios son colecciones de pares &lt;code&gt;etiqueta:valor&lt;/code&gt; e indexan por etiqueta. No es posible referenciar a un elemento por posición.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;diccionario&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;s1&quot;&gt;&amp;#39;H&amp;#39;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;hidrógeno&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s1&quot;&gt;&amp;#39;He&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;helio&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s1&quot;&gt;&amp;#39;Li&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;litio&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;diccionario&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;{&amp;#39;H&amp;#39;: &amp;#39;hidrógeno&amp;#39;, &amp;#39;He&amp;#39;: &amp;#39;helio&amp;#39;, &amp;#39;Li&amp;#39;: &amp;#39;litio&amp;#39;}&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# get&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;diccionario&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;H&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;&amp;#39;hidrógeno&amp;#39;&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# set&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;diccionario&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Be&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;berilio&amp;#39;&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;diccionario&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;{&amp;#39;H&amp;#39;: &amp;#39;hidrógeno&amp;#39;, &amp;#39;He&amp;#39;: &amp;#39;helio&amp;#39;, &amp;#39;Li&amp;#39;: &amp;#39;litio&amp;#39;, &amp;#39;Be&amp;#39;: &amp;#39;berilio&amp;#39;}&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Pandas&quot;&gt;Pandas&lt;a class=&quot;anchor-link&quot; href=&quot;#Pandas&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Una &lt;code&gt;Series&lt;/code&gt; es un objeto unidimensional, similar a una columna en una tabla. Se comporta comporta como una lista y también le asigna una etiqueta a cada elemento en la colección, comportándose como un diccionario. Por defecto, cada elemento recibirá una etiqueta que va de 0 a N-1, donde N es la longitud/tamaño de la colección.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# creación de una Series a partir de una lista arbitraria&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Series&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;hidrógeno&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;helio&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;litio&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;0    hidrógeno
1        helio
2        litio
dtype: object&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;strong&gt;Nota&lt;/strong&gt;: &lt;em&gt;dtype&lt;/em&gt; es el tipo de los elementos de la colección. En este caso &lt;code&gt;object&lt;/code&gt; hace referencia a &lt;em&gt;objetos en general&lt;/em&gt;, es decir, cualquier tipo de objeto: entero (&lt;code&gt;int&lt;/code&gt;), flotante (&lt;code&gt;float&lt;/code&gt;), texto (&lt;code&gt;str&lt;/code&gt;), etcétera.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# creación de una Series especificando un índice&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Series&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;hidrógeno&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;helio&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;litio&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;H&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;He&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Li&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;H     hidrógeno
He        helio
Li        litio
dtype: object&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# creación de una Series a partir de un diccionario (las etiquetas serán los valores del índice)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Series&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;({&lt;/span&gt;
    &lt;span class=&quot;s1&quot;&gt;&amp;#39;H&amp;#39;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;hidrógeno&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s1&quot;&gt;&amp;#39;He&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;helio&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;s1&quot;&gt;&amp;#39;Li&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;litio&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;})&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;H     hidrógeno
He        helio
Li        litio
dtype: object&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# obtener el índice&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;Index([&amp;#39;H&amp;#39;, &amp;#39;He&amp;#39;, &amp;#39;Li&amp;#39;], dtype=&amp;#39;object&amp;#39;)&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;El índice es un objeto del tipo &lt;code&gt;Index&lt;/code&gt;, aportado por Pandas.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# obtener los elementos&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;values&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;array([&amp;#39;hidrógeno&amp;#39;, &amp;#39;helio&amp;#39;, &amp;#39;litio&amp;#39;], dtype=object)&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Los valores se coleccionan en arreglos de NumPy (objetos del tipo &lt;code&gt;array&lt;/code&gt;). Los arreglos son similares a las listas, tienen más funcionalidades.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# el índice se utiliza para seleccionar elementos específicos&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;H&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;&amp;#39;hidrógeno&amp;#39;&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# los valores se pueden cambiar o agregar mediante asignación como si se tratase de un diccionario&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Be&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;berilio&amp;#39;&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;H     hidrógeno
He        helio
Li        litio
Be      berilio
dtype: object&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;hr /&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Un &lt;code&gt;DataFrame&lt;/code&gt; es una estructura tabular (bidimensional) compuesta por filas y columnas, similar a una hoja de cálculo, una tabla de una base de datos, o a un &lt;code&gt;data.frame&lt;/code&gt; del lenguaje R.&lt;/p&gt;
&lt;p&gt;Se puede pensar al &lt;code&gt;DataFrame&lt;/code&gt; como una &lt;code&gt;Series&lt;/code&gt; de &lt;code&gt;Series&lt;/code&gt;: una &lt;code&gt;Series&lt;/code&gt; cuyo índice son los nombres de las columnas y cuyos elementos son &lt;code&gt;Series&lt;/code&gt; que se comportan como columnas. El índice de las &lt;code&gt;Series&lt;/code&gt;-columna son los nombres de las filas.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# creación de un DataFrame a partir de una lista de listas&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DataFrame&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.008&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;4.003&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;6.941&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;9.012&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea output_execute_result&quot;&gt;
&lt;div&gt;
&lt;style scoped=&quot;&quot;&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;
  &lt;thead&gt;
    &lt;tr style=&quot;text-align: right;&quot;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;th&gt;1&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;1.008&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;4.003&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;3&lt;/td&gt;
      &lt;td&gt;6.941&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;9.012&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# creación de un DataFrame especificando índice y columnas&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DataFrame&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;
   &lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;1.008&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;4.003&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;6.941&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
    &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;9.012&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]],&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;H&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;He&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Li&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Be&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;columns&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;número_atómico&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;masa_atómica&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea output_execute_result&quot;&gt;
&lt;div&gt;
&lt;style scoped=&quot;&quot;&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;
  &lt;thead&gt;
    &lt;tr style=&quot;text-align: right;&quot;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;número_atómico&lt;/th&gt;
      &lt;th&gt;masa_atómica&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;H&lt;/th&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;1.008&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;He&lt;/th&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;4.003&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;Li&lt;/th&gt;
      &lt;td&gt;3&lt;/td&gt;
      &lt;td&gt;6.941&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;Be&lt;/th&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;9.012&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Otras formas de inicializar un &lt;code&gt;DataFrame&lt;/code&gt;, usando:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;diccionario de listas&lt;/li&gt;
&lt;li&gt;diccionario de diccionarios&lt;/li&gt;
&lt;li&gt;lista de diccionarios&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# obtener los nombres de las filas&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;Index([&amp;#39;H&amp;#39;, &amp;#39;He&amp;#39;, &amp;#39;Li&amp;#39;, &amp;#39;Be&amp;#39;], dtype=&amp;#39;object&amp;#39;)&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# obtener los nombres de las columnas&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;columns&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;Index([&amp;#39;número_atómico&amp;#39;, &amp;#39;masa_atómica&amp;#39;], dtype=&amp;#39;object&amp;#39;)&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# obtener solo los valores&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;values&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;array([[1.   , 1.008],
       [2.   , 4.003],
       [3.   , 6.941],
       [4.   , 9.012]])&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;strong&gt;Nota&lt;/strong&gt;: Los nombres de columnas también son un índice (&lt;code&gt;Index&lt;/code&gt;). Recapitulando, las &lt;code&gt;Series&lt;/code&gt; tiene un índice y los &lt;code&gt;DataFrame&lt;/code&gt;s tienen dos. Como Pandas piensa la tabla como una colección de columnas, para obtener un valor de una celda primero hay que acceder a la columna y luego a la fila.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# podemos seleccionar una columna, obtendremos una Series&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;masa_atómica&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;H     1.008
He    4.003
Li    6.941
Be    9.012
Name: masa_atómica, dtype: float64&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# podemos cambiar o crear una columna mediante asignación, normalmente de una Series; usamos la del ejemplo anterior&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;nombre&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;s&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea output_execute_result&quot;&gt;
&lt;div&gt;
&lt;style scoped=&quot;&quot;&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;
  &lt;thead&gt;
    &lt;tr style=&quot;text-align: right;&quot;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;número_atómico&lt;/th&gt;
      &lt;th&gt;masa_atómica&lt;/th&gt;
      &lt;th&gt;nombre&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;H&lt;/th&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;1.008&lt;/td&gt;
      &lt;td&gt;hidrógeno&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;He&lt;/th&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;4.003&lt;/td&gt;
      &lt;td&gt;helio&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;Li&lt;/th&gt;
      &lt;td&gt;3&lt;/td&gt;
      &lt;td&gt;6.941&lt;/td&gt;
      &lt;td&gt;litio&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;Be&lt;/th&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;9.012&lt;/td&gt;
      &lt;td&gt;berilio&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# porque una columna es una Series, podemos usar el índice de la Series para obtener el valor de la celda&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;masa_atómica&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;][&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;He&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;4.003&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;strong&gt;Nota&lt;/strong&gt;: Los índices se corresponden con las dimensiones del objeto, un valor de una celda no tiene índices, por lo que es un objeto cero-dimensional, también llamado &lt;em&gt;escalar&lt;/em&gt;.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Carga-de-datos&quot;&gt;Carga de datos&lt;a class=&quot;anchor-link&quot; href=&quot;#Carga-de-datos&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Ver más: &lt;a href=&quot;http://pandas.pydata.org/pandas-docs/stable/io.html&quot;&gt;http://pandas.pydata.org/pandas-docs/stable/io.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Pandas importa y exporta datos de y hacia gran cantidad de formatos.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h4 id=&quot;CSV&quot;&gt;CSV&lt;a class=&quot;anchor-link&quot; href=&quot;#CSV&quot;&gt; &lt;/a&gt;&lt;/h4&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;read_csv&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;datos/properati_básico.csv.gz&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Para exportar un &lt;code&gt;DataFrame&lt;/code&gt; a un archivo CSV podemos usar&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;df.to_csv('archivo.csv')&lt;/code&gt;&lt;/pre&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h4 id=&quot;Excel&quot;&gt;Excel&lt;a class=&quot;anchor-link&quot; href=&quot;#Excel&quot;&gt; &lt;/a&gt;&lt;/h4&gt;&lt;p&gt;Requiere un paquete adicional.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;!pip install xlrd

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Leer una hoja de cálculo.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;pd.read_excel('datos/archivo.xlsx')&lt;/code&gt;&lt;/pre&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h4 id=&quot;SQL&quot;&gt;SQL&lt;a class=&quot;anchor-link&quot; href=&quot;#SQL&quot;&gt; &lt;/a&gt;&lt;/h4&gt;&lt;p&gt;El siguiente código muestra cómo consultar una base de datos.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;import sqlite3

conexión = sqlite3.connect('datos/db.sqlite')
consulta = &quot;SELECT * FROM tabla&quot;

pd.read_sql(consulta, conexión)&lt;/code&gt;&lt;/pre&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h4 id=&quot;BigQuery&quot;&gt;BigQuery&lt;a class=&quot;anchor-link&quot; href=&quot;#BigQuery&quot;&gt; &lt;/a&gt;&lt;/h4&gt;&lt;p&gt;Requiere un paquete adicional.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;!pip install pandas-gbq

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;El resto es parecido a importar desde una base de datos relacional.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;consulta = &quot;SELECT * FROM tabla&quot;

pd.read_gbq(consulta, project_id='properati-data-public')&lt;/code&gt;&lt;/pre&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Inspecci&amp;#243;n&quot;&gt;Inspecci&amp;#243;n&lt;a class=&quot;anchor-link&quot; href=&quot;#Inspecci&amp;#243;n&quot;&gt; &lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# ver primeras filas; probar tail para las últimas&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;head&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea output_execute_result&quot;&gt;
&lt;div&gt;
&lt;style scoped=&quot;&quot;&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;
  &lt;thead&gt;
    &lt;tr style=&quot;text-align: right;&quot;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;fecha&lt;/th&gt;
      &lt;th&gt;tipo&lt;/th&gt;
      &lt;th&gt;lat&lt;/th&gt;
      &lt;th&gt;lon&lt;/th&gt;
      &lt;th&gt;precio&lt;/th&gt;
      &lt;th&gt;superficie_total&lt;/th&gt;
      &lt;th&gt;superficie_cubierta&lt;/th&gt;
      &lt;th&gt;ambientes&lt;/th&gt;
      &lt;th&gt;barrio&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;2017-11-01&lt;/td&gt;
      &lt;td&gt;departamento&lt;/td&gt;
      &lt;td&gt;-34.629118&lt;/td&gt;
      &lt;td&gt;-58.480835&lt;/td&gt;
      &lt;td&gt;275000.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;5.0&lt;/td&gt;
      &lt;td&gt;FLORESTA&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;2017-11-03&lt;/td&gt;
      &lt;td&gt;departamento&lt;/td&gt;
      &lt;td&gt;-34.627120&lt;/td&gt;
      &lt;td&gt;-58.475595&lt;/td&gt;
      &lt;td&gt;268000.0&lt;/td&gt;
      &lt;td&gt;134.0&lt;/td&gt;
      &lt;td&gt;122.0&lt;/td&gt;
      &lt;td&gt;4.0&lt;/td&gt;
      &lt;td&gt;FLORESTA&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;2017-11-03&lt;/td&gt;
      &lt;td&gt;departamento&lt;/td&gt;
      &lt;td&gt;-34.630429&lt;/td&gt;
      &lt;td&gt;-58.486193&lt;/td&gt;
      &lt;td&gt;88000.0&lt;/td&gt;
      &lt;td&gt;37.0&lt;/td&gt;
      &lt;td&gt;34.0&lt;/td&gt;
      &lt;td&gt;2.0&lt;/td&gt;
      &lt;td&gt;FLORESTA&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;2017-11-09&lt;/td&gt;
      &lt;td&gt;departamento&lt;/td&gt;
      &lt;td&gt;-34.628319&lt;/td&gt;
      &lt;td&gt;-58.479828&lt;/td&gt;
      &lt;td&gt;134900.0&lt;/td&gt;
      &lt;td&gt;70.0&lt;/td&gt;
      &lt;td&gt;70.0&lt;/td&gt;
      &lt;td&gt;3.0&lt;/td&gt;
      &lt;td&gt;FLORESTA&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;2017-11-14&lt;/td&gt;
      &lt;td&gt;departamento&lt;/td&gt;
      &lt;td&gt;-34.620887&lt;/td&gt;
      &lt;td&gt;-58.491288&lt;/td&gt;
      &lt;td&gt;69000.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;50.0&lt;/td&gt;
      &lt;td&gt;2.0&lt;/td&gt;
      &lt;td&gt;FLORESTA&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;El método &lt;code&gt;info&lt;/code&gt; nos informa de ambos índices (filas y columnas), incluyendo cantidades. Nombres de columnas, tipos de datos, cantidades de valores no nulos, uso de memoria RAM.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;info&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;&amp;lt;class &amp;#39;pandas.core.frame.DataFrame&amp;#39;&amp;gt;
RangeIndex: 24258 entries, 0 to 24257
Data columns (total 9 columns):
 #   Column               Non-Null Count  Dtype  
---  ------               --------------  -----  
 0   fecha                24258 non-null  object 
 1   tipo                 24258 non-null  object 
 2   lat                  24258 non-null  float64
 3   lon                  24258 non-null  float64
 4   precio               23141 non-null  float64
 5   superficie_total     22261 non-null  float64
 6   superficie_cubierta  22664 non-null  float64
 7   ambientes            20533 non-null  float64
 8   barrio               24258 non-null  object 
dtypes: float64(6), object(3)
memory usage: 1.7+ MB
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;El método &lt;code&gt;describe&lt;/code&gt; muestra estadísticas básicas acerca de las columnas númericas. Aplica sobre todas las columnas númericas, incluso sobre aquellas en las que no tiene sentido hacer estadísticas (lat y lon por ejemplo).&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;describe&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea output_execute_result&quot;&gt;
&lt;div&gt;
&lt;style scoped=&quot;&quot;&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;
  &lt;thead&gt;
    &lt;tr style=&quot;text-align: right;&quot;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;lat&lt;/th&gt;
      &lt;th&gt;lon&lt;/th&gt;
      &lt;th&gt;precio&lt;/th&gt;
      &lt;th&gt;superficie_total&lt;/th&gt;
      &lt;th&gt;superficie_cubierta&lt;/th&gt;
      &lt;th&gt;ambientes&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;count&lt;/th&gt;
      &lt;td&gt;24258.000000&lt;/td&gt;
      &lt;td&gt;24258.000000&lt;/td&gt;
      &lt;td&gt;2.314100e+04&lt;/td&gt;
      &lt;td&gt;22261.000000&lt;/td&gt;
      &lt;td&gt;22664.000000&lt;/td&gt;
      &lt;td&gt;20533.000000&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;mean&lt;/th&gt;
      &lt;td&gt;-34.599238&lt;/td&gt;
      &lt;td&gt;-58.436230&lt;/td&gt;
      &lt;td&gt;2.779905e+05&lt;/td&gt;
      &lt;td&gt;133.717578&lt;/td&gt;
      &lt;td&gt;137.000176&lt;/td&gt;
      &lt;td&gt;2.874056&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;std&lt;/th&gt;
      &lt;td&gt;0.026307&lt;/td&gt;
      &lt;td&gt;0.039340&lt;/td&gt;
      &lt;td&gt;3.611446e+05&lt;/td&gt;
      &lt;td&gt;1633.426319&lt;/td&gt;
      &lt;td&gt;2418.268251&lt;/td&gt;
      &lt;td&gt;1.690704&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;min&lt;/th&gt;
      &lt;td&gt;-34.695717&lt;/td&gt;
      &lt;td&gt;-58.529982&lt;/td&gt;
      &lt;td&gt;4.870050e+03&lt;/td&gt;
      &lt;td&gt;0.000000&lt;/td&gt;
      &lt;td&gt;1.000000&lt;/td&gt;
      &lt;td&gt;1.000000&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;25%&lt;/th&gt;
      &lt;td&gt;-34.618590&lt;/td&gt;
      &lt;td&gt;-58.464357&lt;/td&gt;
      &lt;td&gt;1.200000e+05&lt;/td&gt;
      &lt;td&gt;46.000000&lt;/td&gt;
      &lt;td&gt;41.000000&lt;/td&gt;
      &lt;td&gt;2.000000&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;50%&lt;/th&gt;
      &lt;td&gt;-34.598897&lt;/td&gt;
      &lt;td&gt;-58.436198&lt;/td&gt;
      &lt;td&gt;1.800000e+05&lt;/td&gt;
      &lt;td&gt;70.000000&lt;/td&gt;
      &lt;td&gt;62.000000&lt;/td&gt;
      &lt;td&gt;3.000000&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;75%&lt;/th&gt;
      &lt;td&gt;-34.580350&lt;/td&gt;
      &lt;td&gt;-58.403884&lt;/td&gt;
      &lt;td&gt;2.990000e+05&lt;/td&gt;
      &lt;td&gt;120.000000&lt;/td&gt;
      &lt;td&gt;104.000000&lt;/td&gt;
      &lt;td&gt;4.000000&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;max&lt;/th&gt;
      &lt;td&gt;-34.536066&lt;/td&gt;
      &lt;td&gt;-58.353946&lt;/td&gt;
      &lt;td&gt;1.350000e+07&lt;/td&gt;
      &lt;td&gt;184000.000000&lt;/td&gt;
      &lt;td&gt;263960.000000&lt;/td&gt;
      &lt;td&gt;38.000000&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Indexaci&amp;#243;n&quot;&gt;Indexaci&amp;#243;n&lt;a class=&quot;anchor-link&quot; href=&quot;#Indexaci&amp;#243;n&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Por indexación nos referimos a la selección de un subconjunto de un &lt;code&gt;DataFrame&lt;/code&gt; o de una &lt;code&gt;Series&lt;/code&gt;. Por ahora hemos visto un uso básico de los corchetes &lt;code&gt;[ ]&lt;/code&gt;, el operador índice, para acceder a columnas de un &lt;code&gt;DataFrame&lt;/code&gt; y a valores de una &lt;code&gt;Series&lt;/code&gt;. En el caso de las &lt;code&gt;Series&lt;/code&gt; los casos de uso del operador no difieren prácticamente de lo que se puede hacer con un arreglo de NumPy, sin embargo en el caso de los &lt;code&gt;DataFrame&lt;/code&gt;s se complejiza ya que permite seleccionar por filas (no lo vimos) o por columnas (sí lo vimos).&lt;/p&gt;
&lt;p&gt;Los corchetes existen en Pandas por conveniencia para hacer algunas operaciones más simples, lo cual también traerá aparejado limitaciones. Pandas va a determinar si estamos queriendo acceder a la tabla usando el índice que se llama &lt;em&gt;index&lt;/em&gt; (nombres filas) o el que se llama &lt;em&gt;columns&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;A su vez &lt;strong&gt;hay dos maneras de utilizar los índices&lt;/strong&gt;:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;por etiqueta (como en los diccionarios),&lt;/li&gt;
&lt;li&gt;por posición (como en las listas).&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Esta modalidad dual no está presente en los diccionarios, que no pueden ser indexados por posición, ni en las listas, que no pueden ser indexadas por etiqueta. Está presente en Pandas y nos permite acceder a los datos de la forma conveniente según el caso.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# un nombre columna, devuelve una Series&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;barrio&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;head&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;0    FLORESTA
1    FLORESTA
2    FLORESTA
3    FLORESTA
4    FLORESTA
Name: barrio, dtype: object&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;strong&gt;No es posible obtener una sola fila&lt;/strong&gt; con &lt;code&gt;[ ]&lt;/code&gt;, pero sí un subconjunto de filas y también un subconjunto de columnas. Antes de mostrar cómo hacerlo, introducimos tres nuevos conceptos: &lt;code&gt;slice&lt;/code&gt;, lista de índices y máscara booleana.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Cortes&quot;&gt;Cortes&lt;a class=&quot;anchor-link&quot; href=&quot;#Cortes&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Existe en Python un tipo de objeto llamado &lt;code&gt;slice&lt;/code&gt;, traducido como corte o rebanada, cuyo fin es ayudar a producir sublistas a partir de listas, &quot;cortando&quot; una lista desde una posición inicial hasta una posición final. En realidad la lista original no es modificada sino que se devuelve una nueva, usando los elementos que ya existen en la original (los objetos no son copiados).&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;frutas&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;naranja&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;banana&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;ananá&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;durazno&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;uva&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;frutas&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;[&amp;#39;naranja&amp;#39;, &amp;#39;banana&amp;#39;, &amp;#39;ananá&amp;#39;, &amp;#39;durazno&amp;#39;, &amp;#39;uva&amp;#39;]&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Sabemos cómo obtener valores individuales.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;frutas&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;&amp;#39;ananá&amp;#39;&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Supongamos que nos interesa conseguir una sublista con las tres primeras frutas, serían los elementos en las posiciones 0, 1, 2, por lo que deberíamos cortar desde 0 hasta 3 (no inclusive).&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;corte&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;slice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;corte&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;slice(0, 3, None)&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;frutas&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;corte&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;[&amp;#39;naranja&amp;#39;, &amp;#39;banana&amp;#39;, &amp;#39;ananá&amp;#39;]&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Podemos obtener el mismo resultado con un atajo. Los atajos reciben el nombre de &lt;strong&gt;azúcar sintáctica&lt;/strong&gt;, son expresiones cómodas para idiomas frecuentes, que existen en paralelo a las formas regulares del lenguaje.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;frutas&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;[&amp;#39;naranja&amp;#39;, &amp;#39;banana&amp;#39;, &amp;#39;ananá&amp;#39;]&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# si la posición inicial está ausente, se entiende que va desde el principio&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;frutas&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;[&amp;#39;naranja&amp;#39;, &amp;#39;banana&amp;#39;, &amp;#39;ananá&amp;#39;]&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# si la posición final está ausente, se entiende que va hasta el final&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;frutas&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;[&amp;#39;durazno&amp;#39;, &amp;#39;uva&amp;#39;]&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# esto no parece útil ahora pero lo será más adelante&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;frutas&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;[&amp;#39;naranja&amp;#39;, &amp;#39;banana&amp;#39;, &amp;#39;ananá&amp;#39;, &amp;#39;durazno&amp;#39;, &amp;#39;uva&amp;#39;]&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# ídem pero sin azúcar&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;corte&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;slice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;corte&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;slice(None, None, None)&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;frutas&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;corte&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;[&amp;#39;naranja&amp;#39;, &amp;#39;banana&amp;#39;, &amp;#39;ananá&amp;#39;, &amp;#39;durazno&amp;#39;, &amp;#39;uva&amp;#39;]&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Listas-de-&amp;#237;ndices-y-m&amp;#225;scaras-booleanas&quot;&gt;Listas de &amp;#237;ndices y m&amp;#225;scaras booleanas&lt;a class=&quot;anchor-link&quot; href=&quot;#Listas-de-&amp;#237;ndices-y-m&amp;#225;scaras-booleanas&quot;&gt; &lt;/a&gt;&lt;/h3&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Los arreglos de NumPy son como las listas de Python pero con funcionalidades agregadas. Admiten indexado por posición, por corte y añaden nuevas maneras de formar sub-arreglos, mediante&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;listas o rangos de posiciones,&lt;/li&gt;
&lt;li&gt;listas de valores booleanos, llamadas máscaras.&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;np&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;frutas&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;naranja&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;banana&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;ananá&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;durazno&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;uva&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;frutas&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;array([&amp;#39;naranja&amp;#39;, &amp;#39;banana&amp;#39;, &amp;#39;ananá&amp;#39;, &amp;#39;durazno&amp;#39;, &amp;#39;uva&amp;#39;], dtype=&amp;#39;&amp;lt;U7&amp;#39;)&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h4 id=&quot;Listas-de-posiciones&quot;&gt;Listas de posiciones&lt;a class=&quot;anchor-link&quot; href=&quot;#Listas-de-posiciones&quot;&gt; &lt;/a&gt;&lt;/h4&gt;&lt;p&gt;Supongamos que queremos obtener los elementos naranja, ananá, uva. A diferencia de las listas que solo permiten enteros o cortes, NumPy nos permite pasar una lista con las posiciones de interés.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# en vez de usar un escalar (int, str...) usamos una lista&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;frutas&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;array([&amp;#39;naranja&amp;#39;, &amp;#39;ananá&amp;#39;, &amp;#39;uva&amp;#39;], dtype=&amp;#39;&amp;lt;U7&amp;#39;)&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;En Python existe un tipo de objeto llamado rango (&lt;code&gt;range&lt;/code&gt;), que se puede crear —como casi todos los tipos de objetos en el lenguaje— utilizando una función homónima, que representa una colección de números desde un valor inicial hasta un valor final (no inclusive) utilizando un intervalo determinado. A diferencia de &lt;code&gt;slice&lt;/code&gt;, los rangos pueden ser convertidos en listas.&lt;/p&gt;
&lt;p&gt;Si se trata de un patrón regular, es mejor definir un rango antes que una lista.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# desde cero hasta cinco contando de a dos&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;rango&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;range&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;rango&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;range(0, 5, 2)&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# pueden ser convertidos en listas&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rango&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;[0, 2, 4]&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# se obtienen los mismos resultados&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;frutas&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;rango&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;array([&amp;#39;naranja&amp;#39;, &amp;#39;ananá&amp;#39;, &amp;#39;uva&amp;#39;], dtype=&amp;#39;&amp;lt;U7&amp;#39;)&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h4 id=&quot;M&amp;#225;scaras&quot;&gt;M&amp;#225;scaras&lt;a class=&quot;anchor-link&quot; href=&quot;#M&amp;#225;scaras&quot;&gt; &lt;/a&gt;&lt;/h4&gt;&lt;p&gt;&lt;strong&gt;La máscara debe tener el mismo largo que el arreglo&lt;/strong&gt; y estar compuesta por valores booleanos (&lt;code&gt;bool&lt;/code&gt;). En este caso, cinco elementos.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;máscara&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;frutas&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;máscara&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;array([&amp;#39;naranja&amp;#39;, &amp;#39;ananá&amp;#39;, &amp;#39;uva&amp;#39;], dtype=&amp;#39;&amp;lt;U7&amp;#39;)&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Se filtran aquellos elementos cuya posición se corresponde con las posiciones de los valores &lt;code&gt;False&lt;/code&gt; de la máscara, se seleccionan aquellos donde &lt;code&gt;True&lt;/code&gt;. La máscara sirve para ocultar algunas partes y mostrar otras.&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;Podemos utilizar una lista de etiquetas para obtener un subconjunto de columnas.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# lista de nombres de columnas, devuelve un DataFrame&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;barrio&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;ambientes&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;precio&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;head&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea output_execute_result&quot;&gt;
&lt;div&gt;
&lt;style scoped=&quot;&quot;&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;
  &lt;thead&gt;
    &lt;tr style=&quot;text-align: right;&quot;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;barrio&lt;/th&gt;
      &lt;th&gt;ambientes&lt;/th&gt;
      &lt;th&gt;precio&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;FLORESTA&lt;/td&gt;
      &lt;td&gt;5.0&lt;/td&gt;
      &lt;td&gt;275000.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;FLORESTA&lt;/td&gt;
      &lt;td&gt;4.0&lt;/td&gt;
      &lt;td&gt;268000.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;FLORESTA&lt;/td&gt;
      &lt;td&gt;2.0&lt;/td&gt;
      &lt;td&gt;88000.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;FLORESTA&lt;/td&gt;
      &lt;td&gt;3.0&lt;/td&gt;
      &lt;td&gt;134900.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;FLORESTA&lt;/td&gt;
      &lt;td&gt;2.0&lt;/td&gt;
      &lt;td&gt;69000.0&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Podemos utilizar un corte para obtener un subconjunto de filas &lt;strong&gt;por posición&lt;/strong&gt;.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea output_execute_result&quot;&gt;
&lt;div&gt;
&lt;style scoped=&quot;&quot;&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;
  &lt;thead&gt;
    &lt;tr style=&quot;text-align: right;&quot;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;fecha&lt;/th&gt;
      &lt;th&gt;tipo&lt;/th&gt;
      &lt;th&gt;lat&lt;/th&gt;
      &lt;th&gt;lon&lt;/th&gt;
      &lt;th&gt;precio&lt;/th&gt;
      &lt;th&gt;superficie_total&lt;/th&gt;
      &lt;th&gt;superficie_cubierta&lt;/th&gt;
      &lt;th&gt;ambientes&lt;/th&gt;
      &lt;th&gt;barrio&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;2017-11-01&lt;/td&gt;
      &lt;td&gt;departamento&lt;/td&gt;
      &lt;td&gt;-34.629118&lt;/td&gt;
      &lt;td&gt;-58.480835&lt;/td&gt;
      &lt;td&gt;275000.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;5.0&lt;/td&gt;
      &lt;td&gt;FLORESTA&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;2017-11-03&lt;/td&gt;
      &lt;td&gt;departamento&lt;/td&gt;
      &lt;td&gt;-34.627120&lt;/td&gt;
      &lt;td&gt;-58.475595&lt;/td&gt;
      &lt;td&gt;268000.0&lt;/td&gt;
      &lt;td&gt;134.0&lt;/td&gt;
      &lt;td&gt;122.0&lt;/td&gt;
      &lt;td&gt;4.0&lt;/td&gt;
      &lt;td&gt;FLORESTA&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;2017-11-03&lt;/td&gt;
      &lt;td&gt;departamento&lt;/td&gt;
      &lt;td&gt;-34.630429&lt;/td&gt;
      &lt;td&gt;-58.486193&lt;/td&gt;
      &lt;td&gt;88000.0&lt;/td&gt;
      &lt;td&gt;37.0&lt;/td&gt;
      &lt;td&gt;34.0&lt;/td&gt;
      &lt;td&gt;2.0&lt;/td&gt;
      &lt;td&gt;FLORESTA&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;2017-11-09&lt;/td&gt;
      &lt;td&gt;departamento&lt;/td&gt;
      &lt;td&gt;-34.628319&lt;/td&gt;
      &lt;td&gt;-58.479828&lt;/td&gt;
      &lt;td&gt;134900.0&lt;/td&gt;
      &lt;td&gt;70.0&lt;/td&gt;
      &lt;td&gt;70.0&lt;/td&gt;
      &lt;td&gt;3.0&lt;/td&gt;
      &lt;td&gt;FLORESTA&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;2017-11-14&lt;/td&gt;
      &lt;td&gt;departamento&lt;/td&gt;
      &lt;td&gt;-34.620887&lt;/td&gt;
      &lt;td&gt;-58.491288&lt;/td&gt;
      &lt;td&gt;69000.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;50.0&lt;/td&gt;
      &lt;td&gt;2.0&lt;/td&gt;
      &lt;td&gt;FLORESTA&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;strong&gt;Nota&lt;/strong&gt;: En muchos casos los nombres de filas van a coincidir con las posiciones de filas, ya que si no especificamos un índice, el índice por defecto que asigna Pandas a las filas va de 0 a N-1, siendo N la cantidad de filas. &lt;strong&gt;Estas etiquetas coinciden con la posición&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;También podemos utilizar una máscara. Hay formas muy prácticas de generar máscaras, la que se presenta a continuación solo tiene fines demostrativos y jamás volverá a ser utilizada.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# la función len nos dice la cantidad de filas del DataFrame&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;cantidad_filas&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;len&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# usando la función np.null armamos un arreglo tan largo como la tabla, lleno de un valor especificado (False)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;máscara&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;full&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;cantidad_filas&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# retocamos la máscara para recuperar solo las primeras dos filas&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;máscara&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;máscara&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;máscara&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea output_execute_result&quot;&gt;
&lt;div&gt;
&lt;style scoped=&quot;&quot;&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;
  &lt;thead&gt;
    &lt;tr style=&quot;text-align: right;&quot;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;fecha&lt;/th&gt;
      &lt;th&gt;tipo&lt;/th&gt;
      &lt;th&gt;lat&lt;/th&gt;
      &lt;th&gt;lon&lt;/th&gt;
      &lt;th&gt;precio&lt;/th&gt;
      &lt;th&gt;superficie_total&lt;/th&gt;
      &lt;th&gt;superficie_cubierta&lt;/th&gt;
      &lt;th&gt;ambientes&lt;/th&gt;
      &lt;th&gt;barrio&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;2017-11-01&lt;/td&gt;
      &lt;td&gt;departamento&lt;/td&gt;
      &lt;td&gt;-34.629118&lt;/td&gt;
      &lt;td&gt;-58.480835&lt;/td&gt;
      &lt;td&gt;275000.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;5.0&lt;/td&gt;
      &lt;td&gt;FLORESTA&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;2017-11-03&lt;/td&gt;
      &lt;td&gt;departamento&lt;/td&gt;
      &lt;td&gt;-34.627120&lt;/td&gt;
      &lt;td&gt;-58.475595&lt;/td&gt;
      &lt;td&gt;268000.0&lt;/td&gt;
      &lt;td&gt;134.0&lt;/td&gt;
      &lt;td&gt;122.0&lt;/td&gt;
      &lt;td&gt;4.0&lt;/td&gt;
      &lt;td&gt;FLORESTA&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Resumimos las capacidades de &lt;code&gt;[ ]&lt;/code&gt;:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Una etiqueta de columna, devuelve una columna.&lt;/li&gt;
&lt;li&gt;Una lista de etiquetas de columnas, devuelve una subtabla.&lt;/li&gt;
&lt;li&gt;Un corte de posiciones de filas, devuelve una subtabla.&lt;/li&gt;
&lt;li&gt;Una máscara de posiciones de filas, devuelve una subtabla.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Se nota el comportamiento de filas por sus posiciones y columnas por sus etiquetas.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Alternativamente se puede acceder a una columna como si fuera un atributo del &lt;code&gt;DataFrame&lt;/code&gt;.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# funciona como df[&amp;#39;barrio&amp;#39;]; es como df$barrio en R&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;barrio&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;head&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;0    FLORESTA
1    FLORESTA
2    FLORESTA
3    FLORESTA
4    FLORESTA
Name: barrio, dtype: object&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Filas-y-columnas&quot;&gt;Filas y columnas&lt;a class=&quot;anchor-link&quot; href=&quot;#Filas-y-columnas&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;¿Qué pasa si queremos filtrar utilizando ambos índices simultáneamente? En principio podríamos hacer&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;df[columnas][filas]

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;sin embargo esta manera efectúa dos selecciones, una seguida de la otra, no es simultánea, lo que traerá más adelante implicancias para la asignación. Para esta situación Pandas provee las siguientes formas de indexar.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;loc[filas, columnas]&lt;/code&gt; para acceder por etiquetas,&lt;/li&gt;
&lt;li&gt;&lt;code&gt;iloc[filas, columnas]&lt;/code&gt; para acceder por posición.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Es un poco confuso al principio, la i de &lt;code&gt;iloc&lt;/code&gt; hace pensar en la fila (o en la columna) número i, o sea en la posición i.&lt;/p&gt;
&lt;p&gt;La limitación de estas formas es que &lt;strong&gt;no es posible mezclar etiquetas con posiciones&lt;/strong&gt;; por ejemplo posición de filas y etiquetas de columnas, una combinación bastante deseable.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# esta línea de código desordena las filas para que sus etiquetas ya no coincidan con&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# el orden que las filas tienen en la tabla (no hace falta entender esta línea en este momento);&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# el método sample sirve para obtener una muestra al azar de filas &lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sample&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;frac&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;random_state&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;42&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;head&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea output_execute_result&quot;&gt;
&lt;div&gt;
&lt;style scoped=&quot;&quot;&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;
  &lt;thead&gt;
    &lt;tr style=&quot;text-align: right;&quot;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;fecha&lt;/th&gt;
      &lt;th&gt;tipo&lt;/th&gt;
      &lt;th&gt;lat&lt;/th&gt;
      &lt;th&gt;lon&lt;/th&gt;
      &lt;th&gt;precio&lt;/th&gt;
      &lt;th&gt;superficie_total&lt;/th&gt;
      &lt;th&gt;superficie_cubierta&lt;/th&gt;
      &lt;th&gt;ambientes&lt;/th&gt;
      &lt;th&gt;barrio&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;19411&lt;/th&gt;
      &lt;td&gt;2018-02-23&lt;/td&gt;
      &lt;td&gt;ph&lt;/td&gt;
      &lt;td&gt;-34.640644&lt;/td&gt;
      &lt;td&gt;-58.500677&lt;/td&gt;
      &lt;td&gt;128000.0&lt;/td&gt;
      &lt;td&gt;65.0&lt;/td&gt;
      &lt;td&gt;60.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;VILLA LURO&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;17819&lt;/th&gt;
      &lt;td&gt;2018-02-28&lt;/td&gt;
      &lt;td&gt;departamento&lt;/td&gt;
      &lt;td&gt;-34.643719&lt;/td&gt;
      &lt;td&gt;-58.372644&lt;/td&gt;
      &lt;td&gt;86000.0&lt;/td&gt;
      &lt;td&gt;34.0&lt;/td&gt;
      &lt;td&gt;32.0&lt;/td&gt;
      &lt;td&gt;1.0&lt;/td&gt;
      &lt;td&gt;BARRACAS&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;14611&lt;/th&gt;
      &lt;td&gt;2018-02-07&lt;/td&gt;
      &lt;td&gt;departamento&lt;/td&gt;
      &lt;td&gt;-34.573595&lt;/td&gt;
      &lt;td&gt;-58.442591&lt;/td&gt;
      &lt;td&gt;194150.0&lt;/td&gt;
      &lt;td&gt;58.0&lt;/td&gt;
      &lt;td&gt;48.0&lt;/td&gt;
      &lt;td&gt;2.0&lt;/td&gt;
      &lt;td&gt;COLEGIALES&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;22362&lt;/th&gt;
      &lt;td&gt;2018-02-20&lt;/td&gt;
      &lt;td&gt;casa&lt;/td&gt;
      &lt;td&gt;-34.611046&lt;/td&gt;
      &lt;td&gt;-58.503044&lt;/td&gt;
      &lt;td&gt;245000.0&lt;/td&gt;
      &lt;td&gt;112.0&lt;/td&gt;
      &lt;td&gt;112.0&lt;/td&gt;
      &lt;td&gt;2.0&lt;/td&gt;
      &lt;td&gt;VILLA DEVOTO&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;16962&lt;/th&gt;
      &lt;td&gt;2018-04-11&lt;/td&gt;
      &lt;td&gt;departamento&lt;/td&gt;
      &lt;td&gt;-34.605809&lt;/td&gt;
      &lt;td&gt;-58.453481&lt;/td&gt;
      &lt;td&gt;142900.0&lt;/td&gt;
      &lt;td&gt;47.0&lt;/td&gt;
      &lt;td&gt;40.0&lt;/td&gt;
      &lt;td&gt;2.0&lt;/td&gt;
      &lt;td&gt;VILLA CRESPO&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h4 id=&quot;Por-etiquetas&quot;&gt;Por etiquetas&lt;a class=&quot;anchor-link&quot; href=&quot;#Por-etiquetas&quot;&gt; &lt;/a&gt;&lt;/h4&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# valor de una celda, fila y columna; devuelve un escalar (valor suelto)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;fecha&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;&amp;#39;2018-02-21&amp;#39;&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;La selección de todas las columnas en R se logra con &lt;code&gt;df[filas,]&lt;/code&gt; pero en Python esta sintaxis no es válida, opciones son &lt;code&gt;df.loc[filas]&lt;/code&gt; o &lt;code&gt;df.loc[filas, :]&lt;/code&gt;.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# un fila puntual, todas las columnas; devuelve una Series&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;fecha                    2018-02-21
tipo                   departamento
lat                         -34.629
lon                        -58.4797
precio                        92000
superficie_total                 48
superficie_cubierta              48
ambientes                         3
barrio                     FLORESTA
Name: 100, dtype: object&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# varias filas (lista de etiquetas), una columna; devuelve una Series&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;fecha&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;1      2017-11-03
10     2017-11-29
100    2018-02-21
Name: fecha, dtype: object&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# varias filas, varias columnas; devuelve un DataFrame&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;superficie_cubierta&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;superficie_total&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea output_execute_result&quot;&gt;
&lt;div&gt;
&lt;style scoped=&quot;&quot;&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;
  &lt;thead&gt;
    &lt;tr style=&quot;text-align: right;&quot;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;superficie_cubierta&lt;/th&gt;
      &lt;th&gt;superficie_total&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;122.0&lt;/td&gt;
      &lt;td&gt;134.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;10&lt;/th&gt;
      &lt;td&gt;341.0&lt;/td&gt;
      &lt;td&gt;401.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;100&lt;/th&gt;
      &lt;td&gt;48.0&lt;/td&gt;
      &lt;td&gt;48.0&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;La selección de todas las filas en R se logra con &lt;code&gt;df[,columnas]&lt;/code&gt; pero en Python esta sintáxis no es válida, se requiere de un corte total &lt;code&gt;slice(None)&lt;/code&gt; o más común, su azúcar sintáctica &lt;code&gt;df.loc[:, columnas]&lt;/code&gt;.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# todas las filas, algunas columnas; devuelve un DataFrame&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;superficie_cubierta&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;superficie_total&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;head&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea output_execute_result&quot;&gt;
&lt;div&gt;
&lt;style scoped=&quot;&quot;&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;
  &lt;thead&gt;
    &lt;tr style=&quot;text-align: right;&quot;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;superficie_cubierta&lt;/th&gt;
      &lt;th&gt;superficie_total&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;19411&lt;/th&gt;
      &lt;td&gt;60.0&lt;/td&gt;
      &lt;td&gt;65.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;17819&lt;/th&gt;
      &lt;td&gt;32.0&lt;/td&gt;
      &lt;td&gt;34.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;14611&lt;/th&gt;
      &lt;td&gt;48.0&lt;/td&gt;
      &lt;td&gt;58.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;22362&lt;/th&gt;
      &lt;td&gt;112.0&lt;/td&gt;
      &lt;td&gt;112.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;16962&lt;/th&gt;
      &lt;td&gt;40.0&lt;/td&gt;
      &lt;td&gt;47.0&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Si bien las máscaras trabajan por posición y la indexación de &lt;code&gt;loc&lt;/code&gt; es por etiquetas, funcionan de todas formas — es confuso pero será uno de los idiomas más útiles e incluso hasta cobrará sentido más adelante.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# utilizamos la máscara del ejemplo anterior&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;máscara&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;superficie_cubierta&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;superficie_total&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea output_execute_result&quot;&gt;
&lt;div&gt;
&lt;style scoped=&quot;&quot;&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;
  &lt;thead&gt;
    &lt;tr style=&quot;text-align: right;&quot;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;superficie_cubierta&lt;/th&gt;
      &lt;th&gt;superficie_total&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;19411&lt;/th&gt;
      &lt;td&gt;60.0&lt;/td&gt;
      &lt;td&gt;65.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;17819&lt;/th&gt;
      &lt;td&gt;32.0&lt;/td&gt;
      &lt;td&gt;34.0&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;strong&gt;IMPORTANTE&lt;/strong&gt;: Pandas hace su propia interpretación de los cortes en la indexación por etiquetas.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Ambos extremos son inclusivos.&lt;/li&gt;
&lt;li&gt;Van de un valor del índice a otro según su orden en el índice.&lt;/li&gt;
&lt;/ol&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# casteamos Index a lista para que sea más legible&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;columns&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;[&amp;#39;fecha&amp;#39;,
 &amp;#39;tipo&amp;#39;,
 &amp;#39;lat&amp;#39;,
 &amp;#39;lon&amp;#39;,
 &amp;#39;precio&amp;#39;,
 &amp;#39;superficie_total&amp;#39;,
 &amp;#39;superficie_cubierta&amp;#39;,
 &amp;#39;ambientes&amp;#39;,
 &amp;#39;barrio&amp;#39;]&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Por ejemplo, &lt;code&gt;slice('tipo', 'precio')&lt;/code&gt; tiene el mismo efecto que &lt;code&gt;['tipo', 'lat', 'lon', 'precio']&lt;/code&gt;.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;tipo&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;precio&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;tipo      departamento
lat            -34.629
lon           -58.4797
precio           92000
Name: 100, dtype: object&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Veamos el caso de las etiquetas de las filas.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# imprimir solo las primeras diez etiquetas&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)[:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;[19411, 17819, 14611, 22362, 16962, 19442, 15399, 12244, 6674, 4715]&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Un corte desde la tercera etiqueta (14611) hasta la quinta (16962), &lt;code&gt;slice(14611, 16962)&lt;/code&gt;, es como pasar la lista &lt;code&gt;[14611, 22362, 16962]&lt;/code&gt;. Si el orden del índice fuese otro, la selección generada por el mismo corte, sería otra.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;14611&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;16962&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea output_execute_result&quot;&gt;
&lt;div&gt;
&lt;style scoped=&quot;&quot;&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;
  &lt;thead&gt;
    &lt;tr style=&quot;text-align: right;&quot;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;fecha&lt;/th&gt;
      &lt;th&gt;tipo&lt;/th&gt;
      &lt;th&gt;lat&lt;/th&gt;
      &lt;th&gt;lon&lt;/th&gt;
      &lt;th&gt;precio&lt;/th&gt;
      &lt;th&gt;superficie_total&lt;/th&gt;
      &lt;th&gt;superficie_cubierta&lt;/th&gt;
      &lt;th&gt;ambientes&lt;/th&gt;
      &lt;th&gt;barrio&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;14611&lt;/th&gt;
      &lt;td&gt;2018-02-07&lt;/td&gt;
      &lt;td&gt;departamento&lt;/td&gt;
      &lt;td&gt;-34.573595&lt;/td&gt;
      &lt;td&gt;-58.442591&lt;/td&gt;
      &lt;td&gt;194150.0&lt;/td&gt;
      &lt;td&gt;58.0&lt;/td&gt;
      &lt;td&gt;48.0&lt;/td&gt;
      &lt;td&gt;2.0&lt;/td&gt;
      &lt;td&gt;COLEGIALES&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;22362&lt;/th&gt;
      &lt;td&gt;2018-02-20&lt;/td&gt;
      &lt;td&gt;casa&lt;/td&gt;
      &lt;td&gt;-34.611046&lt;/td&gt;
      &lt;td&gt;-58.503044&lt;/td&gt;
      &lt;td&gt;245000.0&lt;/td&gt;
      &lt;td&gt;112.0&lt;/td&gt;
      &lt;td&gt;112.0&lt;/td&gt;
      &lt;td&gt;2.0&lt;/td&gt;
      &lt;td&gt;VILLA DEVOTO&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;16962&lt;/th&gt;
      &lt;td&gt;2018-04-11&lt;/td&gt;
      &lt;td&gt;departamento&lt;/td&gt;
      &lt;td&gt;-34.605809&lt;/td&gt;
      &lt;td&gt;-58.453481&lt;/td&gt;
      &lt;td&gt;142900.0&lt;/td&gt;
      &lt;td&gt;47.0&lt;/td&gt;
      &lt;td&gt;40.0&lt;/td&gt;
      &lt;td&gt;2.0&lt;/td&gt;
      &lt;td&gt;VILLA CRESPO&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h4 id=&quot;Por-posici&amp;#243;n&quot;&gt;Por posici&amp;#243;n&lt;a class=&quot;anchor-link&quot; href=&quot;#Por-posici&amp;#243;n&quot;&gt; &lt;/a&gt;&lt;/h4&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# primeras filas; cuando se indexa por posición no se le presta atención a las etiquetas&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;iloc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea output_execute_result&quot;&gt;
&lt;div&gt;
&lt;style scoped=&quot;&quot;&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;
  &lt;thead&gt;
    &lt;tr style=&quot;text-align: right;&quot;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;fecha&lt;/th&gt;
      &lt;th&gt;tipo&lt;/th&gt;
      &lt;th&gt;lat&lt;/th&gt;
      &lt;th&gt;lon&lt;/th&gt;
      &lt;th&gt;precio&lt;/th&gt;
      &lt;th&gt;superficie_total&lt;/th&gt;
      &lt;th&gt;superficie_cubierta&lt;/th&gt;
      &lt;th&gt;ambientes&lt;/th&gt;
      &lt;th&gt;barrio&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;19411&lt;/th&gt;
      &lt;td&gt;2018-02-23&lt;/td&gt;
      &lt;td&gt;ph&lt;/td&gt;
      &lt;td&gt;-34.640644&lt;/td&gt;
      &lt;td&gt;-58.500677&lt;/td&gt;
      &lt;td&gt;128000.0&lt;/td&gt;
      &lt;td&gt;65.0&lt;/td&gt;
      &lt;td&gt;60.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;VILLA LURO&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;17819&lt;/th&gt;
      &lt;td&gt;2018-02-28&lt;/td&gt;
      &lt;td&gt;departamento&lt;/td&gt;
      &lt;td&gt;-34.643719&lt;/td&gt;
      &lt;td&gt;-58.372644&lt;/td&gt;
      &lt;td&gt;86000.0&lt;/td&gt;
      &lt;td&gt;34.0&lt;/td&gt;
      &lt;td&gt;32.0&lt;/td&gt;
      &lt;td&gt;1.0&lt;/td&gt;
      &lt;td&gt;BARRACAS&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;14611&lt;/th&gt;
      &lt;td&gt;2018-02-07&lt;/td&gt;
      &lt;td&gt;departamento&lt;/td&gt;
      &lt;td&gt;-34.573595&lt;/td&gt;
      &lt;td&gt;-58.442591&lt;/td&gt;
      &lt;td&gt;194150.0&lt;/td&gt;
      &lt;td&gt;58.0&lt;/td&gt;
      &lt;td&gt;48.0&lt;/td&gt;
      &lt;td&gt;2.0&lt;/td&gt;
      &lt;td&gt;COLEGIALES&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;22362&lt;/th&gt;
      &lt;td&gt;2018-02-20&lt;/td&gt;
      &lt;td&gt;casa&lt;/td&gt;
      &lt;td&gt;-34.611046&lt;/td&gt;
      &lt;td&gt;-58.503044&lt;/td&gt;
      &lt;td&gt;245000.0&lt;/td&gt;
      &lt;td&gt;112.0&lt;/td&gt;
      &lt;td&gt;112.0&lt;/td&gt;
      &lt;td&gt;2.0&lt;/td&gt;
      &lt;td&gt;VILLA DEVOTO&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;16962&lt;/th&gt;
      &lt;td&gt;2018-04-11&lt;/td&gt;
      &lt;td&gt;departamento&lt;/td&gt;
      &lt;td&gt;-34.605809&lt;/td&gt;
      &lt;td&gt;-58.453481&lt;/td&gt;
      &lt;td&gt;142900.0&lt;/td&gt;
      &lt;td&gt;47.0&lt;/td&gt;
      &lt;td&gt;40.0&lt;/td&gt;
      &lt;td&gt;2.0&lt;/td&gt;
      &lt;td&gt;VILLA CRESPO&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;strong&gt;IMPORTANTE&lt;/strong&gt;: con &lt;code&gt;iloc&lt;/code&gt; las columnas se seleccionan por su posición, no por sus etiquetas.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# casteamos Index a lista para que sea más legible&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;columns&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;[&amp;#39;fecha&amp;#39;,
 &amp;#39;tipo&amp;#39;,
 &amp;#39;lat&amp;#39;,
 &amp;#39;lon&amp;#39;,
 &amp;#39;precio&amp;#39;,
 &amp;#39;superficie_total&amp;#39;,
 &amp;#39;superficie_cubierta&amp;#39;,
 &amp;#39;ambientes&amp;#39;,
 &amp;#39;barrio&amp;#39;]&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# fecha está en la posición 0 en el índice de las columnas, tipo está en la posición 1&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;iloc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;head&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea output_execute_result&quot;&gt;
&lt;div&gt;
&lt;style scoped=&quot;&quot;&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;
  &lt;thead&gt;
    &lt;tr style=&quot;text-align: right;&quot;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;fecha&lt;/th&gt;
      &lt;th&gt;tipo&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;19411&lt;/th&gt;
      &lt;td&gt;2018-02-23&lt;/td&gt;
      &lt;td&gt;ph&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;17819&lt;/th&gt;
      &lt;td&gt;2018-02-28&lt;/td&gt;
      &lt;td&gt;departamento&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;14611&lt;/th&gt;
      &lt;td&gt;2018-02-07&lt;/td&gt;
      &lt;td&gt;departamento&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;22362&lt;/th&gt;
      &lt;td&gt;2018-02-20&lt;/td&gt;
      &lt;td&gt;casa&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;16962&lt;/th&gt;
      &lt;td&gt;2018-04-11&lt;/td&gt;
      &lt;td&gt;departamento&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;strong&gt;IMPORTANTE&lt;/strong&gt;: &lt;code&gt;iloc&lt;/code&gt; no acepta máscaras.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Resumen&quot;&gt;Resumen&lt;a class=&quot;anchor-link&quot; href=&quot;#Resumen&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;Como con listas, es posible indexar por posición.&lt;/li&gt;
&lt;li&gt;Como con diccionarios, es posible indexar por etiqueta.&lt;/li&gt;
&lt;li&gt;Como con arreglos de NumPy, es posible indexar por máscaras booleanas.&lt;/li&gt;
&lt;li&gt;Cualquiera de estos indexadores pueden ser escalares (&lt;code&gt;int&lt;/code&gt;, &lt;code&gt;str&lt;/code&gt;, ...), listas, o cortes.&lt;/li&gt;
&lt;li&gt;Funcionan en filas y columnas.&lt;/li&gt;
&lt;li&gt;Funcionan en índices jerárquicos (próximo tema).&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Asignaci&amp;#243;n&quot;&gt;Asignaci&amp;#243;n&lt;a class=&quot;anchor-link&quot; href=&quot;#Asignaci&amp;#243;n&quot;&gt; &lt;/a&gt;&lt;/h3&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Las distintas formas de indexar también sirven para guardar valores.&lt;/p&gt;
&lt;p&gt;Supongamos que nos informan que las propiedades con etiquetas 333 y 666 están mal anotadas como departamentos, que en realidad son casas.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;333&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;666&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea output_execute_result&quot;&gt;
&lt;div&gt;
&lt;style scoped=&quot;&quot;&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;
  &lt;thead&gt;
    &lt;tr style=&quot;text-align: right;&quot;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;fecha&lt;/th&gt;
      &lt;th&gt;tipo&lt;/th&gt;
      &lt;th&gt;lat&lt;/th&gt;
      &lt;th&gt;lon&lt;/th&gt;
      &lt;th&gt;precio&lt;/th&gt;
      &lt;th&gt;superficie_total&lt;/th&gt;
      &lt;th&gt;superficie_cubierta&lt;/th&gt;
      &lt;th&gt;ambientes&lt;/th&gt;
      &lt;th&gt;barrio&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;333&lt;/th&gt;
      &lt;td&gt;2017-12-06&lt;/td&gt;
      &lt;td&gt;departamento&lt;/td&gt;
      &lt;td&gt;-34.552416&lt;/td&gt;
      &lt;td&gt;-58.456552&lt;/td&gt;
      &lt;td&gt;120000.0&lt;/td&gt;
      &lt;td&gt;37.0&lt;/td&gt;
      &lt;td&gt;33.0&lt;/td&gt;
      &lt;td&gt;1.0&lt;/td&gt;
      &lt;td&gt;NUÑEZ&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;666&lt;/th&gt;
      &lt;td&gt;2018-03-25&lt;/td&gt;
      &lt;td&gt;departamento&lt;/td&gt;
      &lt;td&gt;-34.556262&lt;/td&gt;
      &lt;td&gt;-58.464462&lt;/td&gt;
      &lt;td&gt;377944.0&lt;/td&gt;
      &lt;td&gt;110.0&lt;/td&gt;
      &lt;td&gt;108.0&lt;/td&gt;
      &lt;td&gt;4.0&lt;/td&gt;
      &lt;td&gt;NUÑEZ&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# asignamos el valor casa a las filas deseadas en la columna correspondiente&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;333&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;666&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;tipo&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;casa&amp;#39;&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;333&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;666&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea output_execute_result&quot;&gt;
&lt;div&gt;
&lt;style scoped=&quot;&quot;&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;
  &lt;thead&gt;
    &lt;tr style=&quot;text-align: right;&quot;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;fecha&lt;/th&gt;
      &lt;th&gt;tipo&lt;/th&gt;
      &lt;th&gt;lat&lt;/th&gt;
      &lt;th&gt;lon&lt;/th&gt;
      &lt;th&gt;precio&lt;/th&gt;
      &lt;th&gt;superficie_total&lt;/th&gt;
      &lt;th&gt;superficie_cubierta&lt;/th&gt;
      &lt;th&gt;ambientes&lt;/th&gt;
      &lt;th&gt;barrio&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;333&lt;/th&gt;
      &lt;td&gt;2017-12-06&lt;/td&gt;
      &lt;td&gt;casa&lt;/td&gt;
      &lt;td&gt;-34.552416&lt;/td&gt;
      &lt;td&gt;-58.456552&lt;/td&gt;
      &lt;td&gt;120000.0&lt;/td&gt;
      &lt;td&gt;37.0&lt;/td&gt;
      &lt;td&gt;33.0&lt;/td&gt;
      &lt;td&gt;1.0&lt;/td&gt;
      &lt;td&gt;NUÑEZ&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;666&lt;/th&gt;
      &lt;td&gt;2018-03-25&lt;/td&gt;
      &lt;td&gt;casa&lt;/td&gt;
      &lt;td&gt;-34.556262&lt;/td&gt;
      &lt;td&gt;-58.464462&lt;/td&gt;
      &lt;td&gt;377944.0&lt;/td&gt;
      &lt;td&gt;110.0&lt;/td&gt;
      &lt;td&gt;108.0&lt;/td&gt;
      &lt;td&gt;4.0&lt;/td&gt;
      &lt;td&gt;NUÑEZ&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Adicionalmente nos reportan que el precio de la propiedad con etiqueta 666 ha sido actualizado.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;666&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;fecha&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;precio&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;2018-10-28&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;510000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# pasamos una lista de etiquetas para que devuelva un DataFrame,&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# esto es válido más allá de que sea una lista de un solo elemento&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;666&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea output_execute_result&quot;&gt;
&lt;div&gt;
&lt;style scoped=&quot;&quot;&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;
  &lt;thead&gt;
    &lt;tr style=&quot;text-align: right;&quot;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;fecha&lt;/th&gt;
      &lt;th&gt;tipo&lt;/th&gt;
      &lt;th&gt;lat&lt;/th&gt;
      &lt;th&gt;lon&lt;/th&gt;
      &lt;th&gt;precio&lt;/th&gt;
      &lt;th&gt;superficie_total&lt;/th&gt;
      &lt;th&gt;superficie_cubierta&lt;/th&gt;
      &lt;th&gt;ambientes&lt;/th&gt;
      &lt;th&gt;barrio&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;666&lt;/th&gt;
      &lt;td&gt;2018-10-28&lt;/td&gt;
      &lt;td&gt;casa&lt;/td&gt;
      &lt;td&gt;-34.556262&lt;/td&gt;
      &lt;td&gt;-58.464462&lt;/td&gt;
      &lt;td&gt;510000.0&lt;/td&gt;
      &lt;td&gt;110.0&lt;/td&gt;
      &lt;td&gt;108.0&lt;/td&gt;
      &lt;td&gt;4.0&lt;/td&gt;
      &lt;td&gt;NUÑEZ&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;&amp;#205;ndices-jer&amp;#225;rquicos&quot;&gt;&amp;#205;ndices jer&amp;#225;rquicos&lt;a class=&quot;anchor-link&quot; href=&quot;#&amp;#205;ndices-jer&amp;#225;rquicos&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Hasta ahora vimos cómo trabajar con índices creados por defecto (cuando las etiquetas van de 0 a N-1) y con índices impuestos al cargar un archivo (las etiquetas de las columnas), sin embargo el índice puede ser modificado según necesidad. Hay varias formas de definir un nuevo índice, una muy común es elegir a una columna para que se convierta en el nuevo índice.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;barrio&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;inplace&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;head&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea output_execute_result&quot;&gt;
&lt;div&gt;
&lt;style scoped=&quot;&quot;&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;
  &lt;thead&gt;
    &lt;tr style=&quot;text-align: right;&quot;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;fecha&lt;/th&gt;
      &lt;th&gt;tipo&lt;/th&gt;
      &lt;th&gt;lat&lt;/th&gt;
      &lt;th&gt;lon&lt;/th&gt;
      &lt;th&gt;precio&lt;/th&gt;
      &lt;th&gt;superficie_total&lt;/th&gt;
      &lt;th&gt;superficie_cubierta&lt;/th&gt;
      &lt;th&gt;ambientes&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;barrio&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;VILLA LURO&lt;/th&gt;
      &lt;td&gt;2018-02-23&lt;/td&gt;
      &lt;td&gt;ph&lt;/td&gt;
      &lt;td&gt;-34.640644&lt;/td&gt;
      &lt;td&gt;-58.500677&lt;/td&gt;
      &lt;td&gt;128000.0&lt;/td&gt;
      &lt;td&gt;65.0&lt;/td&gt;
      &lt;td&gt;60.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;BARRACAS&lt;/th&gt;
      &lt;td&gt;2018-02-28&lt;/td&gt;
      &lt;td&gt;departamento&lt;/td&gt;
      &lt;td&gt;-34.643719&lt;/td&gt;
      &lt;td&gt;-58.372644&lt;/td&gt;
      &lt;td&gt;86000.0&lt;/td&gt;
      &lt;td&gt;34.0&lt;/td&gt;
      &lt;td&gt;32.0&lt;/td&gt;
      &lt;td&gt;1.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;COLEGIALES&lt;/th&gt;
      &lt;td&gt;2018-02-07&lt;/td&gt;
      &lt;td&gt;departamento&lt;/td&gt;
      &lt;td&gt;-34.573595&lt;/td&gt;
      &lt;td&gt;-58.442591&lt;/td&gt;
      &lt;td&gt;194150.0&lt;/td&gt;
      &lt;td&gt;58.0&lt;/td&gt;
      &lt;td&gt;48.0&lt;/td&gt;
      &lt;td&gt;2.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;VILLA DEVOTO&lt;/th&gt;
      &lt;td&gt;2018-02-20&lt;/td&gt;
      &lt;td&gt;casa&lt;/td&gt;
      &lt;td&gt;-34.611046&lt;/td&gt;
      &lt;td&gt;-58.503044&lt;/td&gt;
      &lt;td&gt;245000.0&lt;/td&gt;
      &lt;td&gt;112.0&lt;/td&gt;
      &lt;td&gt;112.0&lt;/td&gt;
      &lt;td&gt;2.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;VILLA CRESPO&lt;/th&gt;
      &lt;td&gt;2018-04-11&lt;/td&gt;
      &lt;td&gt;departamento&lt;/td&gt;
      &lt;td&gt;-34.605809&lt;/td&gt;
      &lt;td&gt;-58.453481&lt;/td&gt;
      &lt;td&gt;142900.0&lt;/td&gt;
      &lt;td&gt;47.0&lt;/td&gt;
      &lt;td&gt;40.0&lt;/td&gt;
      &lt;td&gt;2.0&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;strong&gt;Nota&lt;/strong&gt;: Muchos métodos que transforman &lt;code&gt;DataFrame&lt;/code&gt;s nos devuelven un nuevo &lt;code&gt;DataFrame&lt;/code&gt;, mientras que el original permanece intacto. El argumento &lt;code&gt;inplace=True&lt;/code&gt; se usa para que el método transforme el &lt;code&gt;DataFrame&lt;/code&gt; original; en este caso el método no devuelve nada (&lt;code&gt;None&lt;/code&gt;).&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Al convertir a la columna barrio en índice, esta columna dejó de existir. Esto quiere decir que no podemos invocar a la columna como antes, haciendo &lt;code&gt;df['barrio']&lt;/code&gt; o &lt;code&gt;df.barrio&lt;/code&gt;, en todo caso podemos pedir &lt;code&gt;df.index&lt;/code&gt;. Es importante recordar que aunque las etiquetas de las filas parezcan una columna, &lt;strong&gt;no lo son&lt;/strong&gt;, así como las etiquetas de las columnas aunque parecen ser una fila, tampoco lo son.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;De aquí en más, podemos hacer indexación con las nuevas etiquetas.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# traer todas las propiedades en Palermo&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;PALERMO&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;head&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea output_execute_result&quot;&gt;
&lt;div&gt;
&lt;style scoped=&quot;&quot;&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;
  &lt;thead&gt;
    &lt;tr style=&quot;text-align: right;&quot;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;fecha&lt;/th&gt;
      &lt;th&gt;tipo&lt;/th&gt;
      &lt;th&gt;lat&lt;/th&gt;
      &lt;th&gt;lon&lt;/th&gt;
      &lt;th&gt;precio&lt;/th&gt;
      &lt;th&gt;superficie_total&lt;/th&gt;
      &lt;th&gt;superficie_cubierta&lt;/th&gt;
      &lt;th&gt;ambientes&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;barrio&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;PALERMO&lt;/th&gt;
      &lt;td&gt;2018-03-30&lt;/td&gt;
      &lt;td&gt;casa&lt;/td&gt;
      &lt;td&gt;-34.578329&lt;/td&gt;
      &lt;td&gt;-58.397749&lt;/td&gt;
      &lt;td&gt;3100000.0&lt;/td&gt;
      &lt;td&gt;450.0&lt;/td&gt;
      &lt;td&gt;350.0&lt;/td&gt;
      &lt;td&gt;3.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;PALERMO&lt;/th&gt;
      &lt;td&gt;2018-04-10&lt;/td&gt;
      &lt;td&gt;departamento&lt;/td&gt;
      &lt;td&gt;-34.586787&lt;/td&gt;
      &lt;td&gt;-58.416735&lt;/td&gt;
      &lt;td&gt;145000.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;3.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;PALERMO&lt;/th&gt;
      &lt;td&gt;2018-04-18&lt;/td&gt;
      &lt;td&gt;departamento&lt;/td&gt;
      &lt;td&gt;-34.582436&lt;/td&gt;
      &lt;td&gt;-58.414845&lt;/td&gt;
      &lt;td&gt;850000.0&lt;/td&gt;
      &lt;td&gt;270.0&lt;/td&gt;
      &lt;td&gt;240.0&lt;/td&gt;
      &lt;td&gt;6.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;PALERMO&lt;/th&gt;
      &lt;td&gt;2018-01-26&lt;/td&gt;
      &lt;td&gt;departamento&lt;/td&gt;
      &lt;td&gt;-34.578773&lt;/td&gt;
      &lt;td&gt;-58.415132&lt;/td&gt;
      &lt;td&gt;330000.0&lt;/td&gt;
      &lt;td&gt;74.0&lt;/td&gt;
      &lt;td&gt;64.0&lt;/td&gt;
      &lt;td&gt;3.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;PALERMO&lt;/th&gt;
      &lt;td&gt;2018-04-06&lt;/td&gt;
      &lt;td&gt;departamento&lt;/td&gt;
      &lt;td&gt;-34.569005&lt;/td&gt;
      &lt;td&gt;-58.436241&lt;/td&gt;
      &lt;td&gt;300000.0&lt;/td&gt;
      &lt;td&gt;110.0&lt;/td&gt;
      &lt;td&gt;98.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# traer todas las propiedades en Palermo y Chacarita&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;resultado&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;PALERMO&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;CHACARITA&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:]&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;resultado&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;head&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea output_execute_result&quot;&gt;
&lt;div&gt;
&lt;style scoped=&quot;&quot;&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;
  &lt;thead&gt;
    &lt;tr style=&quot;text-align: right;&quot;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;fecha&lt;/th&gt;
      &lt;th&gt;tipo&lt;/th&gt;
      &lt;th&gt;lat&lt;/th&gt;
      &lt;th&gt;lon&lt;/th&gt;
      &lt;th&gt;precio&lt;/th&gt;
      &lt;th&gt;superficie_total&lt;/th&gt;
      &lt;th&gt;superficie_cubierta&lt;/th&gt;
      &lt;th&gt;ambientes&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;barrio&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;PALERMO&lt;/th&gt;
      &lt;td&gt;2018-03-30&lt;/td&gt;
      &lt;td&gt;casa&lt;/td&gt;
      &lt;td&gt;-34.578329&lt;/td&gt;
      &lt;td&gt;-58.397749&lt;/td&gt;
      &lt;td&gt;3100000.0&lt;/td&gt;
      &lt;td&gt;450.0&lt;/td&gt;
      &lt;td&gt;350.0&lt;/td&gt;
      &lt;td&gt;3.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;PALERMO&lt;/th&gt;
      &lt;td&gt;2018-04-10&lt;/td&gt;
      &lt;td&gt;departamento&lt;/td&gt;
      &lt;td&gt;-34.586787&lt;/td&gt;
      &lt;td&gt;-58.416735&lt;/td&gt;
      &lt;td&gt;145000.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;3.0&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# al principio de la tabla están las de Palermo, hacia el final de la tabla están las de Chacarita&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;resultado&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tail&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea output_execute_result&quot;&gt;
&lt;div&gt;
&lt;style scoped=&quot;&quot;&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;
  &lt;thead&gt;
    &lt;tr style=&quot;text-align: right;&quot;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;fecha&lt;/th&gt;
      &lt;th&gt;tipo&lt;/th&gt;
      &lt;th&gt;lat&lt;/th&gt;
      &lt;th&gt;lon&lt;/th&gt;
      &lt;th&gt;precio&lt;/th&gt;
      &lt;th&gt;superficie_total&lt;/th&gt;
      &lt;th&gt;superficie_cubierta&lt;/th&gt;
      &lt;th&gt;ambientes&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;barrio&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;CHACARITA&lt;/th&gt;
      &lt;td&gt;2017-12-09&lt;/td&gt;
      &lt;td&gt;ph&lt;/td&gt;
      &lt;td&gt;-34.582115&lt;/td&gt;
      &lt;td&gt;-58.455020&lt;/td&gt;
      &lt;td&gt;329000.0&lt;/td&gt;
      &lt;td&gt;265.0&lt;/td&gt;
      &lt;td&gt;215.0&lt;/td&gt;
      &lt;td&gt;5.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;CHACARITA&lt;/th&gt;
      &lt;td&gt;2018-02-11&lt;/td&gt;
      &lt;td&gt;departamento&lt;/td&gt;
      &lt;td&gt;-34.590656&lt;/td&gt;
      &lt;td&gt;-58.448731&lt;/td&gt;
      &lt;td&gt;92000.0&lt;/td&gt;
      &lt;td&gt;33.0&lt;/td&gt;
      &lt;td&gt;30.0&lt;/td&gt;
      &lt;td&gt;1.0&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Cuando necesitemos recuperar al índice como columna, podemos traerla de vuelta.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reset_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inplace&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;head&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea output_execute_result&quot;&gt;
&lt;div&gt;
&lt;style scoped=&quot;&quot;&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;
  &lt;thead&gt;
    &lt;tr style=&quot;text-align: right;&quot;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;barrio&lt;/th&gt;
      &lt;th&gt;fecha&lt;/th&gt;
      &lt;th&gt;tipo&lt;/th&gt;
      &lt;th&gt;lat&lt;/th&gt;
      &lt;th&gt;lon&lt;/th&gt;
      &lt;th&gt;precio&lt;/th&gt;
      &lt;th&gt;superficie_total&lt;/th&gt;
      &lt;th&gt;superficie_cubierta&lt;/th&gt;
      &lt;th&gt;ambientes&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;VILLA LURO&lt;/td&gt;
      &lt;td&gt;2018-02-23&lt;/td&gt;
      &lt;td&gt;ph&lt;/td&gt;
      &lt;td&gt;-34.640644&lt;/td&gt;
      &lt;td&gt;-58.500677&lt;/td&gt;
      &lt;td&gt;128000.0&lt;/td&gt;
      &lt;td&gt;65.0&lt;/td&gt;
      &lt;td&gt;60.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;BARRACAS&lt;/td&gt;
      &lt;td&gt;2018-02-28&lt;/td&gt;
      &lt;td&gt;departamento&lt;/td&gt;
      &lt;td&gt;-34.643719&lt;/td&gt;
      &lt;td&gt;-58.372644&lt;/td&gt;
      &lt;td&gt;86000.0&lt;/td&gt;
      &lt;td&gt;34.0&lt;/td&gt;
      &lt;td&gt;32.0&lt;/td&gt;
      &lt;td&gt;1.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;COLEGIALES&lt;/td&gt;
      &lt;td&gt;2018-02-07&lt;/td&gt;
      &lt;td&gt;departamento&lt;/td&gt;
      &lt;td&gt;-34.573595&lt;/td&gt;
      &lt;td&gt;-58.442591&lt;/td&gt;
      &lt;td&gt;194150.0&lt;/td&gt;
      &lt;td&gt;58.0&lt;/td&gt;
      &lt;td&gt;48.0&lt;/td&gt;
      &lt;td&gt;2.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;VILLA DEVOTO&lt;/td&gt;
      &lt;td&gt;2018-02-20&lt;/td&gt;
      &lt;td&gt;casa&lt;/td&gt;
      &lt;td&gt;-34.611046&lt;/td&gt;
      &lt;td&gt;-58.503044&lt;/td&gt;
      &lt;td&gt;245000.0&lt;/td&gt;
      &lt;td&gt;112.0&lt;/td&gt;
      &lt;td&gt;112.0&lt;/td&gt;
      &lt;td&gt;2.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;VILLA CRESPO&lt;/td&gt;
      &lt;td&gt;2018-04-11&lt;/td&gt;
      &lt;td&gt;departamento&lt;/td&gt;
      &lt;td&gt;-34.605809&lt;/td&gt;
      &lt;td&gt;-58.453481&lt;/td&gt;
      &lt;td&gt;142900.0&lt;/td&gt;
      &lt;td&gt;47.0&lt;/td&gt;
      &lt;td&gt;40.0&lt;/td&gt;
      &lt;td&gt;2.0&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;hr /&gt;
&lt;p&gt;Pandas tiene la capacidad de convertir a más de una columna en índice, lo que recibe el nombre de &lt;strong&gt;multi-índice&lt;/strong&gt;, en la que cada ex-columna aporta un nivel de indexación, estableciéndose también una jerarquía de indexación. Los valores existentes en las columnas se convierten en etiquetas.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;set_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;barrio&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;tipo&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;inplace&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;head&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea output_execute_result&quot;&gt;
&lt;div&gt;
&lt;style scoped=&quot;&quot;&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;
  &lt;thead&gt;
    &lt;tr style=&quot;text-align: right;&quot;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;fecha&lt;/th&gt;
      &lt;th&gt;lat&lt;/th&gt;
      &lt;th&gt;lon&lt;/th&gt;
      &lt;th&gt;precio&lt;/th&gt;
      &lt;th&gt;superficie_total&lt;/th&gt;
      &lt;th&gt;superficie_cubierta&lt;/th&gt;
      &lt;th&gt;ambientes&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;barrio&lt;/th&gt;
      &lt;th&gt;tipo&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;VILLA LURO&lt;/th&gt;
      &lt;th&gt;ph&lt;/th&gt;
      &lt;td&gt;2018-02-23&lt;/td&gt;
      &lt;td&gt;-34.640644&lt;/td&gt;
      &lt;td&gt;-58.500677&lt;/td&gt;
      &lt;td&gt;128000.0&lt;/td&gt;
      &lt;td&gt;65.0&lt;/td&gt;
      &lt;td&gt;60.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;BARRACAS&lt;/th&gt;
      &lt;th&gt;departamento&lt;/th&gt;
      &lt;td&gt;2018-02-28&lt;/td&gt;
      &lt;td&gt;-34.643719&lt;/td&gt;
      &lt;td&gt;-58.372644&lt;/td&gt;
      &lt;td&gt;86000.0&lt;/td&gt;
      &lt;td&gt;34.0&lt;/td&gt;
      &lt;td&gt;32.0&lt;/td&gt;
      &lt;td&gt;1.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;COLEGIALES&lt;/th&gt;
      &lt;th&gt;departamento&lt;/th&gt;
      &lt;td&gt;2018-02-07&lt;/td&gt;
      &lt;td&gt;-34.573595&lt;/td&gt;
      &lt;td&gt;-58.442591&lt;/td&gt;
      &lt;td&gt;194150.0&lt;/td&gt;
      &lt;td&gt;58.0&lt;/td&gt;
      &lt;td&gt;48.0&lt;/td&gt;
      &lt;td&gt;2.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;VILLA DEVOTO&lt;/th&gt;
      &lt;th&gt;casa&lt;/th&gt;
      &lt;td&gt;2018-02-20&lt;/td&gt;
      &lt;td&gt;-34.611046&lt;/td&gt;
      &lt;td&gt;-58.503044&lt;/td&gt;
      &lt;td&gt;245000.0&lt;/td&gt;
      &lt;td&gt;112.0&lt;/td&gt;
      &lt;td&gt;112.0&lt;/td&gt;
      &lt;td&gt;2.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;VILLA CRESPO&lt;/th&gt;
      &lt;th&gt;departamento&lt;/th&gt;
      &lt;td&gt;2018-04-11&lt;/td&gt;
      &lt;td&gt;-34.605809&lt;/td&gt;
      &lt;td&gt;-58.453481&lt;/td&gt;
      &lt;td&gt;142900.0&lt;/td&gt;
      &lt;td&gt;47.0&lt;/td&gt;
      &lt;td&gt;40.0&lt;/td&gt;
      &lt;td&gt;2.0&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;En este caso barrio es el nivel 0 de indexación, tiene precedencia por sobre tipo, que viene a ser el nivel 1. Vamos a poder referenciar a los niveles por nombre y por posición.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;index&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;names&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;FrozenList([&amp;#39;barrio&amp;#39;, &amp;#39;tipo&amp;#39;])&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Seleccionar filas utilizando solo el nivel superior es como si trabajásemos con un índice simple, lo que veníamos haciendo.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# notar que la tabla devuelta carece del nivel superior&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;PALERMO&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;head&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea output_execute_result&quot;&gt;
&lt;div&gt;
&lt;style scoped=&quot;&quot;&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;
  &lt;thead&gt;
    &lt;tr style=&quot;text-align: right;&quot;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;fecha&lt;/th&gt;
      &lt;th&gt;lat&lt;/th&gt;
      &lt;th&gt;lon&lt;/th&gt;
      &lt;th&gt;precio&lt;/th&gt;
      &lt;th&gt;superficie_total&lt;/th&gt;
      &lt;th&gt;superficie_cubierta&lt;/th&gt;
      &lt;th&gt;ambientes&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;tipo&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;casa&lt;/th&gt;
      &lt;td&gt;2018-03-30&lt;/td&gt;
      &lt;td&gt;-34.578329&lt;/td&gt;
      &lt;td&gt;-58.397749&lt;/td&gt;
      &lt;td&gt;3100000.0&lt;/td&gt;
      &lt;td&gt;450.0&lt;/td&gt;
      &lt;td&gt;350.0&lt;/td&gt;
      &lt;td&gt;3.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;departamento&lt;/th&gt;
      &lt;td&gt;2018-04-10&lt;/td&gt;
      &lt;td&gt;-34.586787&lt;/td&gt;
      &lt;td&gt;-58.416735&lt;/td&gt;
      &lt;td&gt;145000.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;3.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;departamento&lt;/th&gt;
      &lt;td&gt;2018-04-18&lt;/td&gt;
      &lt;td&gt;-34.582436&lt;/td&gt;
      &lt;td&gt;-58.414845&lt;/td&gt;
      &lt;td&gt;850000.0&lt;/td&gt;
      &lt;td&gt;270.0&lt;/td&gt;
      &lt;td&gt;240.0&lt;/td&gt;
      &lt;td&gt;6.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;departamento&lt;/th&gt;
      &lt;td&gt;2018-01-26&lt;/td&gt;
      &lt;td&gt;-34.578773&lt;/td&gt;
      &lt;td&gt;-58.415132&lt;/td&gt;
      &lt;td&gt;330000.0&lt;/td&gt;
      &lt;td&gt;74.0&lt;/td&gt;
      &lt;td&gt;64.0&lt;/td&gt;
      &lt;td&gt;3.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;departamento&lt;/th&gt;
      &lt;td&gt;2018-04-06&lt;/td&gt;
      &lt;td&gt;-34.569005&lt;/td&gt;
      &lt;td&gt;-58.436241&lt;/td&gt;
      &lt;td&gt;300000.0&lt;/td&gt;
      &lt;td&gt;110.0&lt;/td&gt;
      &lt;td&gt;98.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Antes de continuar es necesario introducir a las tuplas (&lt;code&gt;tuple&lt;/code&gt;), otro tipo de objeto nativo de Python. Son muy parecidas a las listas, se diferencian en algo que no nos importa mucho ahora: las listas son objetos mutables y las tuplas son inmutables. La forma literal de crearlas es utilizando paréntesis en vez de corchetes.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tupla&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;tupla&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;(1, 2, 3)&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Para hacer una selección utilizando más niveles del multi-índice se requiere escribir las etiquetas deseadas dentro de tuplas respetando la jerarquía de niveles, así &lt;code&gt;(nivel 0, nivel 1, ...)&lt;/code&gt;.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# seleccionamos departamentos en Palermo&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;filas&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;PALERMO&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;departamento&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;filas&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;head&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stderr output_text&quot;&gt;
&lt;pre&gt;/home/matias/.pyenv/versions/3.7.3/lib/python3.7/site-packages/ipykernel_launcher.py:4: PerformanceWarning: indexing past lexsort depth may impact performance.
  after removing the cwd from sys.path.
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea output_execute_result&quot;&gt;
&lt;div&gt;
&lt;style scoped=&quot;&quot;&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;
  &lt;thead&gt;
    &lt;tr style=&quot;text-align: right;&quot;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;fecha&lt;/th&gt;
      &lt;th&gt;lat&lt;/th&gt;
      &lt;th&gt;lon&lt;/th&gt;
      &lt;th&gt;precio&lt;/th&gt;
      &lt;th&gt;superficie_total&lt;/th&gt;
      &lt;th&gt;superficie_cubierta&lt;/th&gt;
      &lt;th&gt;ambientes&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;barrio&lt;/th&gt;
      &lt;th&gt;tipo&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th rowspan=&quot;5&quot; valign=&quot;top&quot;&gt;PALERMO&lt;/th&gt;
      &lt;th&gt;departamento&lt;/th&gt;
      &lt;td&gt;2018-04-10&lt;/td&gt;
      &lt;td&gt;-34.586787&lt;/td&gt;
      &lt;td&gt;-58.416735&lt;/td&gt;
      &lt;td&gt;145000.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;3.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;departamento&lt;/th&gt;
      &lt;td&gt;2018-04-18&lt;/td&gt;
      &lt;td&gt;-34.582436&lt;/td&gt;
      &lt;td&gt;-58.414845&lt;/td&gt;
      &lt;td&gt;850000.0&lt;/td&gt;
      &lt;td&gt;270.0&lt;/td&gt;
      &lt;td&gt;240.0&lt;/td&gt;
      &lt;td&gt;6.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;departamento&lt;/th&gt;
      &lt;td&gt;2018-01-26&lt;/td&gt;
      &lt;td&gt;-34.578773&lt;/td&gt;
      &lt;td&gt;-58.415132&lt;/td&gt;
      &lt;td&gt;330000.0&lt;/td&gt;
      &lt;td&gt;74.0&lt;/td&gt;
      &lt;td&gt;64.0&lt;/td&gt;
      &lt;td&gt;3.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;departamento&lt;/th&gt;
      &lt;td&gt;2018-04-06&lt;/td&gt;
      &lt;td&gt;-34.569005&lt;/td&gt;
      &lt;td&gt;-58.436241&lt;/td&gt;
      &lt;td&gt;300000.0&lt;/td&gt;
      &lt;td&gt;110.0&lt;/td&gt;
      &lt;td&gt;98.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;departamento&lt;/th&gt;
      &lt;td&gt;2018-04-06&lt;/td&gt;
      &lt;td&gt;-34.582669&lt;/td&gt;
      &lt;td&gt;-58.414019&lt;/td&gt;
      &lt;td&gt;360000.0&lt;/td&gt;
      &lt;td&gt;110.0&lt;/td&gt;
      &lt;td&gt;110.0&lt;/td&gt;
      &lt;td&gt;4.0&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# seleccionamos propiedades en San Telmo y Chacarita que son departamentos&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;filas&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;SAN TELMO&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;CHACARITA&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;departamento&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# al usar multi-índice es IMPORTANTE especificar también las columnas, aunque no queramos filtrarlas&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;filas&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;head&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea output_execute_result&quot;&gt;
&lt;div&gt;
&lt;style scoped=&quot;&quot;&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;
  &lt;thead&gt;
    &lt;tr style=&quot;text-align: right;&quot;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;fecha&lt;/th&gt;
      &lt;th&gt;lat&lt;/th&gt;
      &lt;th&gt;lon&lt;/th&gt;
      &lt;th&gt;precio&lt;/th&gt;
      &lt;th&gt;superficie_total&lt;/th&gt;
      &lt;th&gt;superficie_cubierta&lt;/th&gt;
      &lt;th&gt;ambientes&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;barrio&lt;/th&gt;
      &lt;th&gt;tipo&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th rowspan=&quot;3&quot; valign=&quot;top&quot;&gt;CHACARITA&lt;/th&gt;
      &lt;th&gt;departamento&lt;/th&gt;
      &lt;td&gt;2018-02-07&lt;/td&gt;
      &lt;td&gt;-34.585998&lt;/td&gt;
      &lt;td&gt;-58.454436&lt;/td&gt;
      &lt;td&gt;190000.0&lt;/td&gt;
      &lt;td&gt;73.0&lt;/td&gt;
      &lt;td&gt;70.0&lt;/td&gt;
      &lt;td&gt;4.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;departamento&lt;/th&gt;
      &lt;td&gt;2018-04-08&lt;/td&gt;
      &lt;td&gt;-34.583265&lt;/td&gt;
      &lt;td&gt;-58.452488&lt;/td&gt;
      &lt;td&gt;118000.0&lt;/td&gt;
      &lt;td&gt;33.0&lt;/td&gt;
      &lt;td&gt;30.0&lt;/td&gt;
      &lt;td&gt;1.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;departamento&lt;/th&gt;
      &lt;td&gt;2018-04-18&lt;/td&gt;
      &lt;td&gt;-34.582635&lt;/td&gt;
      &lt;td&gt;-58.451826&lt;/td&gt;
      &lt;td&gt;325000.0&lt;/td&gt;
      &lt;td&gt;86.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;3.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;SAN TELMO&lt;/th&gt;
      &lt;th&gt;departamento&lt;/th&gt;
      &lt;td&gt;2018-03-27&lt;/td&gt;
      &lt;td&gt;-34.619606&lt;/td&gt;
      &lt;td&gt;-58.374275&lt;/td&gt;
      &lt;td&gt;365000.0&lt;/td&gt;
      &lt;td&gt;140.0&lt;/td&gt;
      &lt;td&gt;140.0&lt;/td&gt;
      &lt;td&gt;3.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;CHACARITA&lt;/th&gt;
      &lt;th&gt;departamento&lt;/th&gt;
      &lt;td&gt;2018-03-02&lt;/td&gt;
      &lt;td&gt;-34.587261&lt;/td&gt;
      &lt;td&gt;-58.452466&lt;/td&gt;
      &lt;td&gt;158000.0&lt;/td&gt;
      &lt;td&gt;62.0&lt;/td&gt;
      &lt;td&gt;60.0&lt;/td&gt;
      &lt;td&gt;2.0&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Para seleccionar las propiedades en todos los barrios que son departamentos tenemos que pedir todas las etiquetas del nivel 0 (todos los barrios) y la etiqueta del nivel 1 (departamento).&lt;/p&gt;
&lt;p&gt;En principio podríamos pensar lo siguiente, ya que &lt;code&gt;:&lt;/code&gt; representaría todas las etiquetas de los barrios.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;filas = (:, 'departamento')

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Sin embargo esta sintaxis no es correcta: el azúcar sintáctica de &lt;code&gt;:&lt;/code&gt; solo sirve cuando está encerrado entre corchetes &lt;code&gt;[:]&lt;/code&gt; y en el caso anterior lo está en paréntesis.&lt;/p&gt;
&lt;p&gt;Recordemos que &lt;code&gt;:&lt;/code&gt; es una forma abreviada de tipear &lt;code&gt;slice(None)&lt;/code&gt; y que estas dos formas significan lo mismo.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;filas&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;slice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;None&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;departamento&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;filas&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;head&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea output_execute_result&quot;&gt;
&lt;div&gt;
&lt;style scoped=&quot;&quot;&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;
  &lt;thead&gt;
    &lt;tr style=&quot;text-align: right;&quot;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;fecha&lt;/th&gt;
      &lt;th&gt;lat&lt;/th&gt;
      &lt;th&gt;lon&lt;/th&gt;
      &lt;th&gt;precio&lt;/th&gt;
      &lt;th&gt;superficie_total&lt;/th&gt;
      &lt;th&gt;superficie_cubierta&lt;/th&gt;
      &lt;th&gt;ambientes&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;barrio&lt;/th&gt;
      &lt;th&gt;tipo&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;BARRACAS&lt;/th&gt;
      &lt;th&gt;departamento&lt;/th&gt;
      &lt;td&gt;2018-02-28&lt;/td&gt;
      &lt;td&gt;-34.643719&lt;/td&gt;
      &lt;td&gt;-58.372644&lt;/td&gt;
      &lt;td&gt;86000.0&lt;/td&gt;
      &lt;td&gt;34.0&lt;/td&gt;
      &lt;td&gt;32.0&lt;/td&gt;
      &lt;td&gt;1.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;COLEGIALES&lt;/th&gt;
      &lt;th&gt;departamento&lt;/th&gt;
      &lt;td&gt;2018-02-07&lt;/td&gt;
      &lt;td&gt;-34.573595&lt;/td&gt;
      &lt;td&gt;-58.442591&lt;/td&gt;
      &lt;td&gt;194150.0&lt;/td&gt;
      &lt;td&gt;58.0&lt;/td&gt;
      &lt;td&gt;48.0&lt;/td&gt;
      &lt;td&gt;2.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;VILLA CRESPO&lt;/th&gt;
      &lt;th&gt;departamento&lt;/th&gt;
      &lt;td&gt;2018-04-11&lt;/td&gt;
      &lt;td&gt;-34.605809&lt;/td&gt;
      &lt;td&gt;-58.453481&lt;/td&gt;
      &lt;td&gt;142900.0&lt;/td&gt;
      &lt;td&gt;47.0&lt;/td&gt;
      &lt;td&gt;40.0&lt;/td&gt;
      &lt;td&gt;2.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;VILLA LURO&lt;/th&gt;
      &lt;th&gt;departamento&lt;/th&gt;
      &lt;td&gt;2018-03-18&lt;/td&gt;
      &lt;td&gt;-34.638511&lt;/td&gt;
      &lt;td&gt;-58.504406&lt;/td&gt;
      &lt;td&gt;73000.0&lt;/td&gt;
      &lt;td&gt;29.0&lt;/td&gt;
      &lt;td&gt;26.0&lt;/td&gt;
      &lt;td&gt;1.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;VILLA URQUIZA&lt;/th&gt;
      &lt;th&gt;departamento&lt;/th&gt;
      &lt;td&gt;2018-03-27&lt;/td&gt;
      &lt;td&gt;-34.577253&lt;/td&gt;
      &lt;td&gt;-58.497460&lt;/td&gt;
      &lt;td&gt;150392.0&lt;/td&gt;
      &lt;td&gt;53.0&lt;/td&gt;
      &lt;td&gt;46.0&lt;/td&gt;
      &lt;td&gt;2.0&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Pandas provee una manera de recuperar el azúcar sintáctica.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;filas&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;IndexSlice&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;departamento&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;filas&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;:]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;head&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea output_execute_result&quot;&gt;
&lt;div&gt;
&lt;style scoped=&quot;&quot;&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;
  &lt;thead&gt;
    &lt;tr style=&quot;text-align: right;&quot;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;fecha&lt;/th&gt;
      &lt;th&gt;lat&lt;/th&gt;
      &lt;th&gt;lon&lt;/th&gt;
      &lt;th&gt;precio&lt;/th&gt;
      &lt;th&gt;superficie_total&lt;/th&gt;
      &lt;th&gt;superficie_cubierta&lt;/th&gt;
      &lt;th&gt;ambientes&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;barrio&lt;/th&gt;
      &lt;th&gt;tipo&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;BARRACAS&lt;/th&gt;
      &lt;th&gt;departamento&lt;/th&gt;
      &lt;td&gt;2018-02-28&lt;/td&gt;
      &lt;td&gt;-34.643719&lt;/td&gt;
      &lt;td&gt;-58.372644&lt;/td&gt;
      &lt;td&gt;86000.0&lt;/td&gt;
      &lt;td&gt;34.0&lt;/td&gt;
      &lt;td&gt;32.0&lt;/td&gt;
      &lt;td&gt;1.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;COLEGIALES&lt;/th&gt;
      &lt;th&gt;departamento&lt;/th&gt;
      &lt;td&gt;2018-02-07&lt;/td&gt;
      &lt;td&gt;-34.573595&lt;/td&gt;
      &lt;td&gt;-58.442591&lt;/td&gt;
      &lt;td&gt;194150.0&lt;/td&gt;
      &lt;td&gt;58.0&lt;/td&gt;
      &lt;td&gt;48.0&lt;/td&gt;
      &lt;td&gt;2.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;VILLA CRESPO&lt;/th&gt;
      &lt;th&gt;departamento&lt;/th&gt;
      &lt;td&gt;2018-04-11&lt;/td&gt;
      &lt;td&gt;-34.605809&lt;/td&gt;
      &lt;td&gt;-58.453481&lt;/td&gt;
      &lt;td&gt;142900.0&lt;/td&gt;
      &lt;td&gt;47.0&lt;/td&gt;
      &lt;td&gt;40.0&lt;/td&gt;
      &lt;td&gt;2.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;VILLA LURO&lt;/th&gt;
      &lt;th&gt;departamento&lt;/th&gt;
      &lt;td&gt;2018-03-18&lt;/td&gt;
      &lt;td&gt;-34.638511&lt;/td&gt;
      &lt;td&gt;-58.504406&lt;/td&gt;
      &lt;td&gt;73000.0&lt;/td&gt;
      &lt;td&gt;29.0&lt;/td&gt;
      &lt;td&gt;26.0&lt;/td&gt;
      &lt;td&gt;1.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;VILLA URQUIZA&lt;/th&gt;
      &lt;th&gt;departamento&lt;/th&gt;
      &lt;td&gt;2018-03-27&lt;/td&gt;
      &lt;td&gt;-34.577253&lt;/td&gt;
      &lt;td&gt;-58.497460&lt;/td&gt;
      &lt;td&gt;150392.0&lt;/td&gt;
      &lt;td&gt;53.0&lt;/td&gt;
      &lt;td&gt;46.0&lt;/td&gt;
      &lt;td&gt;2.0&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;La gente suele escribir menos recurriendo a esta artimaña.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# darle un alias a pd.IndexSlice&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;idx&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;IndexSlice&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;idx&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;departamento&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;(slice(None, None, None), &amp;#39;departamento&amp;#39;)&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Otra opción que tenemos a mano para seleccionar todos los departamentos, más simple aunque solo sirve para selección y &lt;strong&gt;no para asignación&lt;/strong&gt;, es el método &lt;em&gt;cross-section&lt;/em&gt; (&lt;code&gt;xs&lt;/code&gt;) que selecciona datos según valor de un índice particular.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;xs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;departamento&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;level&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;tipo&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;drop_level&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;head&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea output_execute_result&quot;&gt;
&lt;div&gt;
&lt;style scoped=&quot;&quot;&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;
  &lt;thead&gt;
    &lt;tr style=&quot;text-align: right;&quot;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;fecha&lt;/th&gt;
      &lt;th&gt;lat&lt;/th&gt;
      &lt;th&gt;lon&lt;/th&gt;
      &lt;th&gt;precio&lt;/th&gt;
      &lt;th&gt;superficie_total&lt;/th&gt;
      &lt;th&gt;superficie_cubierta&lt;/th&gt;
      &lt;th&gt;ambientes&lt;/th&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;barrio&lt;/th&gt;
      &lt;th&gt;tipo&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;BARRACAS&lt;/th&gt;
      &lt;th&gt;departamento&lt;/th&gt;
      &lt;td&gt;2018-02-28&lt;/td&gt;
      &lt;td&gt;-34.643719&lt;/td&gt;
      &lt;td&gt;-58.372644&lt;/td&gt;
      &lt;td&gt;86000.0&lt;/td&gt;
      &lt;td&gt;34.0&lt;/td&gt;
      &lt;td&gt;32.0&lt;/td&gt;
      &lt;td&gt;1.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;COLEGIALES&lt;/th&gt;
      &lt;th&gt;departamento&lt;/th&gt;
      &lt;td&gt;2018-02-07&lt;/td&gt;
      &lt;td&gt;-34.573595&lt;/td&gt;
      &lt;td&gt;-58.442591&lt;/td&gt;
      &lt;td&gt;194150.0&lt;/td&gt;
      &lt;td&gt;58.0&lt;/td&gt;
      &lt;td&gt;48.0&lt;/td&gt;
      &lt;td&gt;2.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;VILLA CRESPO&lt;/th&gt;
      &lt;th&gt;departamento&lt;/th&gt;
      &lt;td&gt;2018-04-11&lt;/td&gt;
      &lt;td&gt;-34.605809&lt;/td&gt;
      &lt;td&gt;-58.453481&lt;/td&gt;
      &lt;td&gt;142900.0&lt;/td&gt;
      &lt;td&gt;47.0&lt;/td&gt;
      &lt;td&gt;40.0&lt;/td&gt;
      &lt;td&gt;2.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;VILLA LURO&lt;/th&gt;
      &lt;th&gt;departamento&lt;/th&gt;
      &lt;td&gt;2018-03-18&lt;/td&gt;
      &lt;td&gt;-34.638511&lt;/td&gt;
      &lt;td&gt;-58.504406&lt;/td&gt;
      &lt;td&gt;73000.0&lt;/td&gt;
      &lt;td&gt;29.0&lt;/td&gt;
      &lt;td&gt;26.0&lt;/td&gt;
      &lt;td&gt;1.0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;VILLA URQUIZA&lt;/th&gt;
      &lt;th&gt;departamento&lt;/th&gt;
      &lt;td&gt;2018-03-27&lt;/td&gt;
      &lt;td&gt;-34.577253&lt;/td&gt;
      &lt;td&gt;-58.497460&lt;/td&gt;
      &lt;td&gt;150392.0&lt;/td&gt;
      &lt;td&gt;53.0&lt;/td&gt;
      &lt;td&gt;46.0&lt;/td&gt;
      &lt;td&gt;2.0&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;No lo hemos mostrado pero el índice de las columnas también puede ser un multi-índice.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# nos despedimos de los multi-índices por ahora...&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;reset_index&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;inplace&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Operaciones-vectorizadas&quot;&gt;Operaciones vectorizadas&lt;a class=&quot;anchor-link&quot; href=&quot;#Operaciones-vectorizadas&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Vector y arreglo son dos términos intercambiables. El título se refiere a operaciones sobre arreglos de NumPy que se realizan elemento a elemento (&lt;em&gt;element-wise&lt;/em&gt;) que también están Pandas por estar construido sobre NumPy. Además estas operaciones están preparadas para tratar con valores ausentes. Ninguna de estas dos funcionalidades está presente en Python puro.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;nan&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;array([ 2.,  4., nan])&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;strong&gt;Nota&lt;/strong&gt;: Los valores ausentes &lt;code&gt;NA&lt;/code&gt; no existen nativamente en Python, como sí existen en R. NumPy lo mitiga usando &lt;code&gt;NaN&lt;/code&gt; (&lt;em&gt;not a number&lt;/em&gt;) para representarlos. &lt;code&gt;NaN&lt;/code&gt; es un valor del tipo &lt;code&gt;float&lt;/code&gt;. Como los arreglos de NumPy pueden tener un solo &lt;code&gt;dtype&lt;/code&gt;, un arreglo de enteros es promovido a un arreglo de flotantes y un arreglo de booleanos es llevado a uno de objetos (&lt;code&gt;object&lt;/code&gt;) en presencia de valores ausentes, ya que por ejemplo, no podríamos tener un arreglo con enteros y &lt;code&gt;NaN&lt;/code&gt; (&lt;code&gt;float&lt;/code&gt;) simultáneamente.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Los operadores (&lt;code&gt;+&lt;/code&gt;, &lt;code&gt;-&lt;/code&gt;, ...) terminan invocando a funciones; existen dentro de la sintáxis del lenguaje por practicidad. Cuando alguno de los operandos es un arreglo de NumPy, se invocan funciones de NumPy correspondientes (&lt;code&gt;np.add&lt;/code&gt;, &lt;code&gt;np.substract&lt;/code&gt;, ...) en vez de funciones de Python puro. También las podemos llamar directamente.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;multiply&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;array([ 2.,  4., nan])&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Como característica, son &lt;strong&gt;funciones universales&lt;/strong&gt; (&lt;code&gt;ufunc&lt;/code&gt;), ya que hacen su trabajo elemento a elemento independientemente de las dimensiones de los argumentos (escalar, columna, tabla).&lt;/p&gt;
&lt;p&gt;Pandas a su vez implementa las funciones de NumPy como métodos (aunque en la mayor parte del tiempo usamos operadores).&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# convertimos de USD a ARS&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;precio&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;multiply&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;35&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;head&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;0    4480000.0
1    3010000.0
2    6795250.0
3    8575000.0
4    5001500.0
Name: precio, dtype: float64&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Las operaciones vectorizadas en cualquiera de sus sabores (operadores, funciones, métodos) son ideales para trabajar sobre las columnas existentes y crear nuevas.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;precio_m2&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;precio&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;superficie_total&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;head&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea output_execute_result&quot;&gt;
&lt;div&gt;
&lt;style scoped=&quot;&quot;&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;
  &lt;thead&gt;
    &lt;tr style=&quot;text-align: right;&quot;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;barrio&lt;/th&gt;
      &lt;th&gt;tipo&lt;/th&gt;
      &lt;th&gt;fecha&lt;/th&gt;
      &lt;th&gt;lat&lt;/th&gt;
      &lt;th&gt;lon&lt;/th&gt;
      &lt;th&gt;precio&lt;/th&gt;
      &lt;th&gt;superficie_total&lt;/th&gt;
      &lt;th&gt;superficie_cubierta&lt;/th&gt;
      &lt;th&gt;ambientes&lt;/th&gt;
      &lt;th&gt;precio_m2&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;VILLA LURO&lt;/td&gt;
      &lt;td&gt;ph&lt;/td&gt;
      &lt;td&gt;2018-02-23&lt;/td&gt;
      &lt;td&gt;-34.640644&lt;/td&gt;
      &lt;td&gt;-58.500677&lt;/td&gt;
      &lt;td&gt;128000.0&lt;/td&gt;
      &lt;td&gt;65.0&lt;/td&gt;
      &lt;td&gt;60.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;1969.230769&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;BARRACAS&lt;/td&gt;
      &lt;td&gt;departamento&lt;/td&gt;
      &lt;td&gt;2018-02-28&lt;/td&gt;
      &lt;td&gt;-34.643719&lt;/td&gt;
      &lt;td&gt;-58.372644&lt;/td&gt;
      &lt;td&gt;86000.0&lt;/td&gt;
      &lt;td&gt;34.0&lt;/td&gt;
      &lt;td&gt;32.0&lt;/td&gt;
      &lt;td&gt;1.0&lt;/td&gt;
      &lt;td&gt;2529.411765&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;COLEGIALES&lt;/td&gt;
      &lt;td&gt;departamento&lt;/td&gt;
      &lt;td&gt;2018-02-07&lt;/td&gt;
      &lt;td&gt;-34.573595&lt;/td&gt;
      &lt;td&gt;-58.442591&lt;/td&gt;
      &lt;td&gt;194150.0&lt;/td&gt;
      &lt;td&gt;58.0&lt;/td&gt;
      &lt;td&gt;48.0&lt;/td&gt;
      &lt;td&gt;2.0&lt;/td&gt;
      &lt;td&gt;3347.413793&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;VILLA DEVOTO&lt;/td&gt;
      &lt;td&gt;casa&lt;/td&gt;
      &lt;td&gt;2018-02-20&lt;/td&gt;
      &lt;td&gt;-34.611046&lt;/td&gt;
      &lt;td&gt;-58.503044&lt;/td&gt;
      &lt;td&gt;245000.0&lt;/td&gt;
      &lt;td&gt;112.0&lt;/td&gt;
      &lt;td&gt;112.0&lt;/td&gt;
      &lt;td&gt;2.0&lt;/td&gt;
      &lt;td&gt;2187.500000&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;VILLA CRESPO&lt;/td&gt;
      &lt;td&gt;departamento&lt;/td&gt;
      &lt;td&gt;2018-04-11&lt;/td&gt;
      &lt;td&gt;-34.605809&lt;/td&gt;
      &lt;td&gt;-58.453481&lt;/td&gt;
      &lt;td&gt;142900.0&lt;/td&gt;
      &lt;td&gt;47.0&lt;/td&gt;
      &lt;td&gt;40.0&lt;/td&gt;
      &lt;td&gt;2.0&lt;/td&gt;
      &lt;td&gt;3040.425532&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Operadores-y-funciones-comunes&quot;&gt;Operadores y funciones comunes&lt;a class=&quot;anchor-link&quot; href=&quot;#Operadores-y-funciones-comunes&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Existen operadores como &lt;code&gt;+&lt;/code&gt; que requieren dos operandos, llamados operadores binarios y operadores como &lt;code&gt;-&lt;/code&gt; (negación) que trabajan con un solo operando, los operadores unarios.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Comparación&lt;/strong&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;==  np.equal
!=  np.not_equal

 &amp;lt;  np.less
&amp;lt;=  np.less_equal

 &amp;gt;  np.greater
&amp;gt;=  np.greater_equal

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;Matemáticas&lt;/strong&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt; +  np.add
 -  np.subtract
 -  np.negate  (unario)
 *  np.multiply
 /  np.divide

**  np.pow
    np.sqrt
    np.exp
    np.log

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;Booleanas&lt;/strong&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt; &amp;amp;  np.bitwise_and
 |  np.bitwise_or
 ~  np.bitwise_not  (unario)

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;Flotantes&lt;/strong&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;    np.round
    np.isna
    np.notna&lt;/code&gt;&lt;/pre&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;strong&gt;IMPORTANTE&lt;/strong&gt;: &lt;code&gt;and&lt;/code&gt; y &lt;code&gt;or&lt;/code&gt; realizan una sola evaluación booleana en el objeto entero, mientras que &lt;code&gt;&amp;amp;&lt;/code&gt; y &lt;code&gt;|&lt;/code&gt; realizan múltiples evaluaciones sobre el contenido (elementos de la colección) de los objetos. Cuando trabajamos con arreglos, esto último es lo que normalmente queremos.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;b&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;np&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;array&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# bitwise and&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;array([ True, False, False])&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# bitwise or&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;array([ True,  True, False])&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Operaciones-con-texto&quot;&gt;Operaciones con texto&lt;a class=&quot;anchor-link&quot; href=&quot;#Operaciones-con-texto&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Los &lt;em&gt;strings&lt;/em&gt; (&lt;code&gt;str&lt;/code&gt;) de Python poseen una gran variedad de métodos muy útiles. Pandas implementa estos métodos y atributos (junto con otros más) como operaciones vectorizadas que se acceden desde el atributo &lt;code&gt;Series.str&lt;/code&gt; y &lt;code&gt;DataFrame.str&lt;/code&gt;.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;frutas&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Series&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;manzana&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;banana&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;frutas&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;upper&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;0    MANZANA
1     BANANA
dtype: object&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Operaciones-con-objetos-temporales&quot;&gt;Operaciones con objetos temporales&lt;a class=&quot;anchor-link&quot; href=&quot;#Operaciones-con-objetos-temporales&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Python viene con objetos del tipo fecha (&lt;code&gt;date&lt;/code&gt;), hora (&lt;code&gt;time&lt;/code&gt;), fecha y hora (&lt;code&gt;datetime&lt;/code&gt;) e intervalos temporales (&lt;code&gt;timedelta&lt;/code&gt;). Los métodos y atributos de estos objetos aparecen vectorizados bajo el atributo &lt;code&gt;Series.dt&lt;/code&gt; y &lt;code&gt;DataFrame.dt&lt;/code&gt;.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fechas&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Series&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;1990-01-01&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;2018-10-31&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;fechas&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;0    1990-01-01
1    2018-10-31
dtype: object&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# convertimos strings a datetime&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;fechas&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to_datetime&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fechas&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;fechas&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;0   1990-01-01
1   2018-10-31
dtype: datetime64[ns]&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# atributo year de datetime&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;fechas&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;year&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;0    1990
1    2018
dtype: int64&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;strong&gt;Nota&lt;/strong&gt;: NumPy no implementa operaciones con texto y tiempo pero Pandas sí.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Selecci&amp;#243;n-usando-columnas&quot;&gt;Selecci&amp;#243;n usando columnas&lt;a class=&quot;anchor-link&quot; href=&quot;#Selecci&amp;#243;n-usando-columnas&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;En vez de usar el índice de las filas podemos seleccionar filas usando las columnas. Para ello generamos máscaras booleanas usando columnas (que de por sí tienen un largo igual al de la tabla) y operaciones que devuelvan valores booleanos. Las operaciones de comparación son bastante útiles en este contexto ya que nos permiten seleccionar filas según valores en las columnas.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# seleccionar las propiedades con precio menor a $80.000&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;precio&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;80000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;head&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea output_execute_result&quot;&gt;
&lt;div&gt;
&lt;style scoped=&quot;&quot;&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;
  &lt;thead&gt;
    &lt;tr style=&quot;text-align: right;&quot;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;barrio&lt;/th&gt;
      &lt;th&gt;tipo&lt;/th&gt;
      &lt;th&gt;fecha&lt;/th&gt;
      &lt;th&gt;lat&lt;/th&gt;
      &lt;th&gt;lon&lt;/th&gt;
      &lt;th&gt;precio&lt;/th&gt;
      &lt;th&gt;superficie_total&lt;/th&gt;
      &lt;th&gt;superficie_cubierta&lt;/th&gt;
      &lt;th&gt;ambientes&lt;/th&gt;
      &lt;th&gt;precio_m2&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;5&lt;/th&gt;
      &lt;td&gt;VILLA LURO&lt;/td&gt;
      &lt;td&gt;departamento&lt;/td&gt;
      &lt;td&gt;2018-03-18&lt;/td&gt;
      &lt;td&gt;-34.638511&lt;/td&gt;
      &lt;td&gt;-58.504406&lt;/td&gt;
      &lt;td&gt;73000.0&lt;/td&gt;
      &lt;td&gt;29.0&lt;/td&gt;
      &lt;td&gt;26.0&lt;/td&gt;
      &lt;td&gt;1.0&lt;/td&gt;
      &lt;td&gt;2517.241379&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;7&lt;/th&gt;
      &lt;td&gt;BELGRANO&lt;/td&gt;
      &lt;td&gt;local&lt;/td&gt;
      &lt;td&gt;2018-01-25&lt;/td&gt;
      &lt;td&gt;-34.560463&lt;/td&gt;
      &lt;td&gt;-58.458433&lt;/td&gt;
      &lt;td&gt;32000.0&lt;/td&gt;
      &lt;td&gt;30.0&lt;/td&gt;
      &lt;td&gt;30.0&lt;/td&gt;
      &lt;td&gt;1.0&lt;/td&gt;
      &lt;td&gt;1066.666667&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;16&lt;/th&gt;
      &lt;td&gt;VILLA CRESPO&lt;/td&gt;
      &lt;td&gt;local&lt;/td&gt;
      &lt;td&gt;2018-04-21&lt;/td&gt;
      &lt;td&gt;-34.597679&lt;/td&gt;
      &lt;td&gt;-58.443019&lt;/td&gt;
      &lt;td&gt;11111.0&lt;/td&gt;
      &lt;td&gt;200.0&lt;/td&gt;
      &lt;td&gt;200.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;55.555000&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;26&lt;/th&gt;
      &lt;td&gt;LINIERS&lt;/td&gt;
      &lt;td&gt;local&lt;/td&gt;
      &lt;td&gt;2018-04-19&lt;/td&gt;
      &lt;td&gt;-34.638658&lt;/td&gt;
      &lt;td&gt;-58.528026&lt;/td&gt;
      &lt;td&gt;19900.0&lt;/td&gt;
      &lt;td&gt;16.0&lt;/td&gt;
      &lt;td&gt;16.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;1243.750000&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;31&lt;/th&gt;
      &lt;td&gt;BALVANERA&lt;/td&gt;
      &lt;td&gt;departamento&lt;/td&gt;
      &lt;td&gt;2018-03-25&lt;/td&gt;
      &lt;td&gt;-34.612309&lt;/td&gt;
      &lt;td&gt;-58.412878&lt;/td&gt;
      &lt;td&gt;54000.0&lt;/td&gt;
      &lt;td&gt;25.0&lt;/td&gt;
      &lt;td&gt;25.0&lt;/td&gt;
      &lt;td&gt;1.0&lt;/td&gt;
      &lt;td&gt;2160.000000&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;strong&gt;IMPORTANTE&lt;/strong&gt;: Por una cuestión de precedencia de operadores, de querer combinar máscaras usando operaciones &lt;em&gt;bitwise&lt;/em&gt;, si las máscaras son creadas usando operadores de comparación, deben ser encerradas entre paréntesis. Esto es porque Python resuelve antes los operadores como &lt;code&gt;&amp;amp;&lt;/code&gt; y &lt;code&gt;|&lt;/code&gt; que los operadores como &lt;code&gt;&amp;lt;&lt;/code&gt; e &lt;code&gt;==&lt;/code&gt;; usamos los paréntesis para indicarle a Python el orden de evaluación pretendido: primero las comparaciones, luego las operaciones &lt;em&gt;bitwise&lt;/em&gt;. Como en matemáticas, lo que está dentro de paréntesis debe resolverse primero (tiene precedencia) sobre lo que está afuera.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;precio&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;80000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ambientes&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;head&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea output_execute_result&quot;&gt;
&lt;div&gt;
&lt;style scoped=&quot;&quot;&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;
  &lt;thead&gt;
    &lt;tr style=&quot;text-align: right;&quot;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;barrio&lt;/th&gt;
      &lt;th&gt;tipo&lt;/th&gt;
      &lt;th&gt;fecha&lt;/th&gt;
      &lt;th&gt;lat&lt;/th&gt;
      &lt;th&gt;lon&lt;/th&gt;
      &lt;th&gt;precio&lt;/th&gt;
      &lt;th&gt;superficie_total&lt;/th&gt;
      &lt;th&gt;superficie_cubierta&lt;/th&gt;
      &lt;th&gt;ambientes&lt;/th&gt;
      &lt;th&gt;precio_m2&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;1404&lt;/th&gt;
      &lt;td&gt;PARQUE PATRICIOS&lt;/td&gt;
      &lt;td&gt;departamento&lt;/td&gt;
      &lt;td&gt;2018-04-28&lt;/td&gt;
      &lt;td&gt;-34.629577&lt;/td&gt;
      &lt;td&gt;-58.398071&lt;/td&gt;
      &lt;td&gt;78000.0&lt;/td&gt;
      &lt;td&gt;57.0&lt;/td&gt;
      &lt;td&gt;50.0&lt;/td&gt;
      &lt;td&gt;3.0&lt;/td&gt;
      &lt;td&gt;1368.421053&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2277&lt;/th&gt;
      &lt;td&gt;FLORES&lt;/td&gt;
      &lt;td&gt;departamento&lt;/td&gt;
      &lt;td&gt;2018-04-20&lt;/td&gt;
      &lt;td&gt;-34.652157&lt;/td&gt;
      &lt;td&gt;-58.459236&lt;/td&gt;
      &lt;td&gt;70000.0&lt;/td&gt;
      &lt;td&gt;60.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;3.0&lt;/td&gt;
      &lt;td&gt;1166.666667&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2378&lt;/th&gt;
      &lt;td&gt;VILLA LUGANO&lt;/td&gt;
      &lt;td&gt;departamento&lt;/td&gt;
      &lt;td&gt;2018-03-09&lt;/td&gt;
      &lt;td&gt;-34.686170&lt;/td&gt;
      &lt;td&gt;-58.466922&lt;/td&gt;
      &lt;td&gt;77000.0&lt;/td&gt;
      &lt;td&gt;70.0&lt;/td&gt;
      &lt;td&gt;62.0&lt;/td&gt;
      &lt;td&gt;3.0&lt;/td&gt;
      &lt;td&gt;1100.000000&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3054&lt;/th&gt;
      &lt;td&gt;BALVANERA&lt;/td&gt;
      &lt;td&gt;departamento&lt;/td&gt;
      &lt;td&gt;2017-12-06&lt;/td&gt;
      &lt;td&gt;-34.612801&lt;/td&gt;
      &lt;td&gt;-58.406688&lt;/td&gt;
      &lt;td&gt;78000.0&lt;/td&gt;
      &lt;td&gt;44.0&lt;/td&gt;
      &lt;td&gt;44.0&lt;/td&gt;
      &lt;td&gt;3.0&lt;/td&gt;
      &lt;td&gt;1772.727273&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3055&lt;/th&gt;
      &lt;td&gt;VILLA SOLDATI&lt;/td&gt;
      &lt;td&gt;departamento&lt;/td&gt;
      &lt;td&gt;2018-01-08&lt;/td&gt;
      &lt;td&gt;-34.668741&lt;/td&gt;
      &lt;td&gt;-58.443146&lt;/td&gt;
      &lt;td&gt;52000.0&lt;/td&gt;
      &lt;td&gt;55.0&lt;/td&gt;
      &lt;td&gt;55.0&lt;/td&gt;
      &lt;td&gt;3.0&lt;/td&gt;
      &lt;td&gt;945.454545&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# en vez de operadores de comparación podemos usar sus métodos equivalentes y ahorrarnos los problemas de precedencia&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;precio&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;lt&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;80000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;amp;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ambientes&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;eq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;head&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea output_execute_result&quot;&gt;
&lt;div&gt;
&lt;style scoped=&quot;&quot;&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;
  &lt;thead&gt;
    &lt;tr style=&quot;text-align: right;&quot;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;barrio&lt;/th&gt;
      &lt;th&gt;tipo&lt;/th&gt;
      &lt;th&gt;fecha&lt;/th&gt;
      &lt;th&gt;lat&lt;/th&gt;
      &lt;th&gt;lon&lt;/th&gt;
      &lt;th&gt;precio&lt;/th&gt;
      &lt;th&gt;superficie_total&lt;/th&gt;
      &lt;th&gt;superficie_cubierta&lt;/th&gt;
      &lt;th&gt;ambientes&lt;/th&gt;
      &lt;th&gt;precio_m2&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;1404&lt;/th&gt;
      &lt;td&gt;PARQUE PATRICIOS&lt;/td&gt;
      &lt;td&gt;departamento&lt;/td&gt;
      &lt;td&gt;2018-04-28&lt;/td&gt;
      &lt;td&gt;-34.629577&lt;/td&gt;
      &lt;td&gt;-58.398071&lt;/td&gt;
      &lt;td&gt;78000.0&lt;/td&gt;
      &lt;td&gt;57.0&lt;/td&gt;
      &lt;td&gt;50.0&lt;/td&gt;
      &lt;td&gt;3.0&lt;/td&gt;
      &lt;td&gt;1368.421053&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2277&lt;/th&gt;
      &lt;td&gt;FLORES&lt;/td&gt;
      &lt;td&gt;departamento&lt;/td&gt;
      &lt;td&gt;2018-04-20&lt;/td&gt;
      &lt;td&gt;-34.652157&lt;/td&gt;
      &lt;td&gt;-58.459236&lt;/td&gt;
      &lt;td&gt;70000.0&lt;/td&gt;
      &lt;td&gt;60.0&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
      &lt;td&gt;3.0&lt;/td&gt;
      &lt;td&gt;1166.666667&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2378&lt;/th&gt;
      &lt;td&gt;VILLA LUGANO&lt;/td&gt;
      &lt;td&gt;departamento&lt;/td&gt;
      &lt;td&gt;2018-03-09&lt;/td&gt;
      &lt;td&gt;-34.686170&lt;/td&gt;
      &lt;td&gt;-58.466922&lt;/td&gt;
      &lt;td&gt;77000.0&lt;/td&gt;
      &lt;td&gt;70.0&lt;/td&gt;
      &lt;td&gt;62.0&lt;/td&gt;
      &lt;td&gt;3.0&lt;/td&gt;
      &lt;td&gt;1100.000000&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3054&lt;/th&gt;
      &lt;td&gt;BALVANERA&lt;/td&gt;
      &lt;td&gt;departamento&lt;/td&gt;
      &lt;td&gt;2017-12-06&lt;/td&gt;
      &lt;td&gt;-34.612801&lt;/td&gt;
      &lt;td&gt;-58.406688&lt;/td&gt;
      &lt;td&gt;78000.0&lt;/td&gt;
      &lt;td&gt;44.0&lt;/td&gt;
      &lt;td&gt;44.0&lt;/td&gt;
      &lt;td&gt;3.0&lt;/td&gt;
      &lt;td&gt;1772.727273&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3055&lt;/th&gt;
      &lt;td&gt;VILLA SOLDATI&lt;/td&gt;
      &lt;td&gt;departamento&lt;/td&gt;
      &lt;td&gt;2018-01-08&lt;/td&gt;
      &lt;td&gt;-34.668741&lt;/td&gt;
      &lt;td&gt;-58.443146&lt;/td&gt;
      &lt;td&gt;52000.0&lt;/td&gt;
      &lt;td&gt;55.0&lt;/td&gt;
      &lt;td&gt;55.0&lt;/td&gt;
      &lt;td&gt;3.0&lt;/td&gt;
      &lt;td&gt;945.454545&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Alineamiento-autom&amp;#225;tico&quot;&gt;Alineamiento autom&amp;#225;tico&lt;a class=&quot;anchor-link&quot; href=&quot;#Alineamiento-autom&amp;#225;tico&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;En casos en los que intervengan más de una tabla o columna, como cuando queremos añadir una columna nueva a una tabla, podríamos pensar en cuidar aspectos como que la columna tenga el mismo largo que la tabla y que el orden de los elementos en la nueva columna se condiga con el orden de las filas de la tabla. Esto normalmente es así al trabajar con arreglos de NumPy.&lt;/p&gt;
&lt;p&gt;Afortunadamente nada de esto debe preocuparnos al usar Pandas. Los índices cumplen una función de gran utilidad en las operaciones y en las asignaciones, donde les elementos son alianeados según sus índices para que todo salga como lo esperamos.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Operaciones&quot;&gt;Operaciones&lt;a class=&quot;anchor-link&quot; href=&quot;#Operaciones&quot;&gt; &lt;/a&gt;&lt;/h3&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;algunas_frutas&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Series&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;🥝&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;🥥&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;🍇&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;🍌&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;🍎&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;algunas_frutas&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;index&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;kiwi&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;coco&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;uva&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;banana&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;manzana&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;algunas_frutas&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;kiwi       🥝
coco       🥥
uva        🍇
banana     🍌
manzana    🍎
dtype: object&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;otras_frutas&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Series&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;([&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;🍇&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;🍐&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;🍎&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;otras_frutas&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;index&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;uva&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;pera&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;manzana&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;otras_frutas&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;uva        🍇
pera       🍐
manzana    🍎
dtype: object&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# operación suma entre dos Series que no tienen el mismo largo ni coinciden en todas las etiquetas&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;algunas_frutas&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;otras_frutas&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;banana     NaN
coco       NaN
kiwi       NaN
manzana     🍎🍎
pera       NaN
uva         🍇🍇
dtype: object&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;El índice de la &lt;code&gt;Series&lt;/code&gt; resultante tiene todas las etiquetas de ambos operandos, con los valores resultantes de la operación. Notar que los elementos no estaban alineados.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Nota&lt;/strong&gt;: Cuando alguno de los operandos es &lt;code&gt;NaN&lt;/code&gt; el resultado de la operación es &lt;code&gt;NaN&lt;/code&gt;.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Asignaci&amp;#243;n&quot;&gt;Asignaci&amp;#243;n&lt;a class=&quot;anchor-link&quot; href=&quot;#Asignaci&amp;#243;n&quot;&gt; &lt;/a&gt;&lt;/h3&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# convertimos a una Series en un DataFrame de una columna y nombramos a esa columna&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;dg&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;algunas_frutas&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;to_frame&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;algunas&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;dg&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea output_execute_result&quot;&gt;
&lt;div&gt;
&lt;style scoped=&quot;&quot;&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;
  &lt;thead&gt;
    &lt;tr style=&quot;text-align: right;&quot;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;algunas&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;kiwi&lt;/th&gt;
      &lt;td&gt;🥝&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;coco&lt;/th&gt;
      &lt;td&gt;🥥&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;uva&lt;/th&gt;
      &lt;td&gt;🍇&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;banana&lt;/th&gt;
      &lt;td&gt;🍌&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;manzana&lt;/th&gt;
      &lt;td&gt;🍎&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dg&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;otras&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;otras_frutas&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;dg&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea output_execute_result&quot;&gt;
&lt;div&gt;
&lt;style scoped=&quot;&quot;&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;
  &lt;thead&gt;
    &lt;tr style=&quot;text-align: right;&quot;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;algunas&lt;/th&gt;
      &lt;th&gt;otras&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;kiwi&lt;/th&gt;
      &lt;td&gt;🥝&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;coco&lt;/th&gt;
      &lt;td&gt;🥥&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;uva&lt;/th&gt;
      &lt;td&gt;🍇&lt;/td&gt;
      &lt;td&gt;🍇&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;banana&lt;/th&gt;
      &lt;td&gt;🍌&lt;/td&gt;
      &lt;td&gt;NaN&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;manzana&lt;/th&gt;
      &lt;td&gt;🍎&lt;/td&gt;
      &lt;td&gt;🍎&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Se respeta el índice de la tabla, es decir no se le agregan las etiquetas que &lt;code&gt;otras_frutas&lt;/code&gt; tiene de más. Los valores se asignan alineados y los valores con etiquetas no presentes en &lt;code&gt;otras_frutas&lt;/code&gt; quedan ausentes en la nueva columna.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;M&amp;#225;scaras&quot;&gt;M&amp;#225;scaras&lt;a class=&quot;anchor-link&quot; href=&quot;#M&amp;#225;scaras&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;La alineación automática funciona aún en el indexado, siempre y cuando la máscara sea una &lt;code&gt;Series&lt;/code&gt; y su índice coincida con el del objeto sobre el cual se indexa, lo que suele ser el caso cuando trabajamos con las columnas del &lt;code&gt;DataFrame&lt;/code&gt;. Lo que veremos a continuación no funcionaría con una máscara que sea un arreglo de NumPy ya que carece de índice.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# seleccionamos propiedades de dos ambientes&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;máscara&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ambientes&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;eq&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;máscara&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;head&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;0    False
1    False
2     True
3     True
4     True
Name: ambientes, dtype: bool&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# dejamos un testimonio del resultado&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;máscara&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;head&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea output_execute_result&quot;&gt;
&lt;div&gt;
&lt;style scoped=&quot;&quot;&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;
  &lt;thead&gt;
    &lt;tr style=&quot;text-align: right;&quot;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;barrio&lt;/th&gt;
      &lt;th&gt;tipo&lt;/th&gt;
      &lt;th&gt;fecha&lt;/th&gt;
      &lt;th&gt;lat&lt;/th&gt;
      &lt;th&gt;lon&lt;/th&gt;
      &lt;th&gt;precio&lt;/th&gt;
      &lt;th&gt;superficie_total&lt;/th&gt;
      &lt;th&gt;superficie_cubierta&lt;/th&gt;
      &lt;th&gt;ambientes&lt;/th&gt;
      &lt;th&gt;precio_m2&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;COLEGIALES&lt;/td&gt;
      &lt;td&gt;departamento&lt;/td&gt;
      &lt;td&gt;2018-02-07&lt;/td&gt;
      &lt;td&gt;-34.573595&lt;/td&gt;
      &lt;td&gt;-58.442591&lt;/td&gt;
      &lt;td&gt;194150.0&lt;/td&gt;
      &lt;td&gt;58.0&lt;/td&gt;
      &lt;td&gt;48.0&lt;/td&gt;
      &lt;td&gt;2.0&lt;/td&gt;
      &lt;td&gt;3347.413793&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;VILLA DEVOTO&lt;/td&gt;
      &lt;td&gt;casa&lt;/td&gt;
      &lt;td&gt;2018-02-20&lt;/td&gt;
      &lt;td&gt;-34.611046&lt;/td&gt;
      &lt;td&gt;-58.503044&lt;/td&gt;
      &lt;td&gt;245000.0&lt;/td&gt;
      &lt;td&gt;112.0&lt;/td&gt;
      &lt;td&gt;112.0&lt;/td&gt;
      &lt;td&gt;2.0&lt;/td&gt;
      &lt;td&gt;2187.500000&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;VILLA CRESPO&lt;/td&gt;
      &lt;td&gt;departamento&lt;/td&gt;
      &lt;td&gt;2018-04-11&lt;/td&gt;
      &lt;td&gt;-34.605809&lt;/td&gt;
      &lt;td&gt;-58.453481&lt;/td&gt;
      &lt;td&gt;142900.0&lt;/td&gt;
      &lt;td&gt;47.0&lt;/td&gt;
      &lt;td&gt;40.0&lt;/td&gt;
      &lt;td&gt;2.0&lt;/td&gt;
      &lt;td&gt;3040.425532&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;6&lt;/th&gt;
      &lt;td&gt;VILLA URQUIZA&lt;/td&gt;
      &lt;td&gt;departamento&lt;/td&gt;
      &lt;td&gt;2018-03-27&lt;/td&gt;
      &lt;td&gt;-34.577253&lt;/td&gt;
      &lt;td&gt;-58.497460&lt;/td&gt;
      &lt;td&gt;150392.0&lt;/td&gt;
      &lt;td&gt;53.0&lt;/td&gt;
      &lt;td&gt;46.0&lt;/td&gt;
      &lt;td&gt;2.0&lt;/td&gt;
      &lt;td&gt;2837.584906&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;15&lt;/th&gt;
      &lt;td&gt;NUÑEZ&lt;/td&gt;
      &lt;td&gt;departamento&lt;/td&gt;
      &lt;td&gt;2017-11-21&lt;/td&gt;
      &lt;td&gt;-34.540443&lt;/td&gt;
      &lt;td&gt;-58.473773&lt;/td&gt;
      &lt;td&gt;213500.0&lt;/td&gt;
      &lt;td&gt;48.0&lt;/td&gt;
      &lt;td&gt;44.0&lt;/td&gt;
      &lt;td&gt;2.0&lt;/td&gt;
      &lt;td&gt;4447.916667&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# reordenamos la Series de atrás para adelante, lo que se conoce como revertir (reverse)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# (no hace falta entender esta línea en este momento)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;al_revés&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;máscara&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[::&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# el orden de esta máscara es diferente al de la anterior&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;al_revés&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;head&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;24257     True
24256    False
24255    False
24254    False
24253    False
Name: ambientes, dtype: bool&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# corroboramos que el resultado es el mismo&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;al_revés&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;head&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stderr output_text&quot;&gt;
&lt;pre&gt;/home/matias/.pyenv/versions/3.7.3/lib/python3.7/site-packages/ipykernel_launcher.py:2: UserWarning: Boolean Series key will be reindexed to match DataFrame index.
  
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;


&lt;div class=&quot;output_html rendered_html output_subarea output_execute_result&quot;&gt;
&lt;div&gt;
&lt;style scoped=&quot;&quot;&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
&lt;/style&gt;
&lt;table border=&quot;1&quot; class=&quot;dataframe&quot;&gt;
  &lt;thead&gt;
    &lt;tr style=&quot;text-align: right;&quot;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;barrio&lt;/th&gt;
      &lt;th&gt;tipo&lt;/th&gt;
      &lt;th&gt;fecha&lt;/th&gt;
      &lt;th&gt;lat&lt;/th&gt;
      &lt;th&gt;lon&lt;/th&gt;
      &lt;th&gt;precio&lt;/th&gt;
      &lt;th&gt;superficie_total&lt;/th&gt;
      &lt;th&gt;superficie_cubierta&lt;/th&gt;
      &lt;th&gt;ambientes&lt;/th&gt;
      &lt;th&gt;precio_m2&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;COLEGIALES&lt;/td&gt;
      &lt;td&gt;departamento&lt;/td&gt;
      &lt;td&gt;2018-02-07&lt;/td&gt;
      &lt;td&gt;-34.573595&lt;/td&gt;
      &lt;td&gt;-58.442591&lt;/td&gt;
      &lt;td&gt;194150.0&lt;/td&gt;
      &lt;td&gt;58.0&lt;/td&gt;
      &lt;td&gt;48.0&lt;/td&gt;
      &lt;td&gt;2.0&lt;/td&gt;
      &lt;td&gt;3347.413793&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;VILLA DEVOTO&lt;/td&gt;
      &lt;td&gt;casa&lt;/td&gt;
      &lt;td&gt;2018-02-20&lt;/td&gt;
      &lt;td&gt;-34.611046&lt;/td&gt;
      &lt;td&gt;-58.503044&lt;/td&gt;
      &lt;td&gt;245000.0&lt;/td&gt;
      &lt;td&gt;112.0&lt;/td&gt;
      &lt;td&gt;112.0&lt;/td&gt;
      &lt;td&gt;2.0&lt;/td&gt;
      &lt;td&gt;2187.500000&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;VILLA CRESPO&lt;/td&gt;
      &lt;td&gt;departamento&lt;/td&gt;
      &lt;td&gt;2018-04-11&lt;/td&gt;
      &lt;td&gt;-34.605809&lt;/td&gt;
      &lt;td&gt;-58.453481&lt;/td&gt;
      &lt;td&gt;142900.0&lt;/td&gt;
      &lt;td&gt;47.0&lt;/td&gt;
      &lt;td&gt;40.0&lt;/td&gt;
      &lt;td&gt;2.0&lt;/td&gt;
      &lt;td&gt;3040.425532&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;6&lt;/th&gt;
      &lt;td&gt;VILLA URQUIZA&lt;/td&gt;
      &lt;td&gt;departamento&lt;/td&gt;
      &lt;td&gt;2018-03-27&lt;/td&gt;
      &lt;td&gt;-34.577253&lt;/td&gt;
      &lt;td&gt;-58.497460&lt;/td&gt;
      &lt;td&gt;150392.0&lt;/td&gt;
      &lt;td&gt;53.0&lt;/td&gt;
      &lt;td&gt;46.0&lt;/td&gt;
      &lt;td&gt;2.0&lt;/td&gt;
      &lt;td&gt;2837.584906&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;15&lt;/th&gt;
      &lt;td&gt;NUÑEZ&lt;/td&gt;
      &lt;td&gt;departamento&lt;/td&gt;
      &lt;td&gt;2017-11-21&lt;/td&gt;
      &lt;td&gt;-34.540443&lt;/td&gt;
      &lt;td&gt;-58.473773&lt;/td&gt;
      &lt;td&gt;213500.0&lt;/td&gt;
      &lt;td&gt;48.0&lt;/td&gt;
      &lt;td&gt;44.0&lt;/td&gt;
      &lt;td&gt;2.0&lt;/td&gt;
      &lt;td&gt;4447.916667&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;strong&gt;Nota&lt;/strong&gt;: Que el indexado haga uso de las etiquetas de la máscara es la razón por la cuál las máscaras funcionan en el indexado por etiquetas (&lt;code&gt;loc&lt;/code&gt;) y no en el indexado por posición (&lt;code&gt;iloc&lt;/code&gt;).&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Ejemplo-integrador&quot;&gt;Ejemplo integrador&lt;a class=&quot;anchor-link&quot; href=&quot;#Ejemplo-integrador&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;El siguiente ejemplo asigna a aquellos avisos que carecen de superficie cubierta, su superficie total.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;loc&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;superficie_cubierta&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;isnull&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;superficie_cubierta&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;superficie_total&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code&gt;loc&lt;/code&gt; para indexar por filas y columnas; necesitamos indexar por etiquetas para hacer referencia a la columna sobre la cual hacer la asignación por su nombre.&lt;/li&gt;
&lt;li&gt;Creamos una máscara usando la columna superficie_cubierta y la operación vectorizada &lt;code&gt;isnull&lt;/code&gt;, que servirá para seleccionar aquellas filas en las que superficie_cubierta es &lt;code&gt;NaN&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;Asignamos los valores presentes en la columna superficie_total y no nos preocupamos por hacer una selección (como la del punto anterior) sobre estos valores ya que la alineación automática se encargará de alinear las filas de ambos lados de la asignación por su etiqueta.&lt;/li&gt;
&lt;/ol&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Visualizaci&amp;#243;n-b&amp;#225;sica&quot;&gt;Visualizaci&amp;#243;n b&amp;#225;sica&lt;a class=&quot;anchor-link&quot; href=&quot;#Visualizaci&amp;#243;n-b&amp;#225;sica&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Ver más: &lt;a href=&quot;http://pandas.pydata.org/pandas-docs/stable/visualization.html&quot;&gt;http://pandas.pydata.org/pandas-docs/stable/visualization.html&lt;/a&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# activar gráficos en Jupyter; hace falta correrlo una vez&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;matplotlib&lt;/span&gt; inline
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Tanto &lt;code&gt;Series&lt;/code&gt; como &lt;code&gt;DataFrame&lt;/code&gt;s tienen un atributo llamado &lt;code&gt;plot&lt;/code&gt; que habilita los siguientes métodos para distintos gráficos típicos.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;line&lt;/code&gt; y &lt;code&gt;area&lt;/code&gt; para líneas y líneas sólidas.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;bar&lt;/code&gt; y &lt;code&gt;barh&lt;/code&gt; para barras verticales y horizontales.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;pie&lt;/code&gt; para tortas.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;scatter&lt;/code&gt; para puntos.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;hist&lt;/code&gt; y &lt;code&gt;hexbin&lt;/code&gt; para histogramas e histogramas 2D.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;density&lt;/code&gt; o &lt;code&gt;kde&lt;/code&gt; para densidad de probabilidad.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;box&lt;/code&gt; para &lt;em&gt;boxplot&lt;/em&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;IMPORTANTE&lt;/strong&gt;: Cuando graficamos en base a un &lt;code&gt;DataFrame&lt;/code&gt;, cada columna se interpreta como una variable.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;df&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;precio&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;plot&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;hist&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;bins&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;xlim&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;500000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;&amp;lt;matplotlib.axes._subplots.AxesSubplot at 0x7f825e369fd0&amp;gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_png output_subarea &quot;&gt;
&lt;img src=&quot;data:image/png;base64,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
&quot; /&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Actividad-de-investigaci&amp;#243;n&quot;&gt;Actividad de investigaci&amp;#243;n&lt;a class=&quot;anchor-link&quot; href=&quot;#Actividad-de-investigaci&amp;#243;n&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Consultar la ayuda o la web para saber más de los métodos que se encuentran a continuación. Por ejemplo:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;help&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;pd&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;DataFrame&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;sort_values&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Help on function sort_values in module pandas.core.frame:

sort_values(self, by, axis=0, ascending=True, inplace=False, kind=&amp;#39;quicksort&amp;#39;, na_position=&amp;#39;last&amp;#39;, ignore_index=False)
    Sort by the values along either axis.
    
    Parameters
    ----------
            by : str or list of str
                Name or list of names to sort by.
    
                - if `axis` is 0 or `&amp;#39;index&amp;#39;` then `by` may contain index
                  levels and/or column labels.
                - if `axis` is 1 or `&amp;#39;columns&amp;#39;` then `by` may contain column
                  levels and/or index labels.
    
                .. versionchanged:: 0.23.0
    
                   Allow specifying index or column level names.
    axis : {0 or &amp;#39;index&amp;#39;, 1 or &amp;#39;columns&amp;#39;}, default 0
         Axis to be sorted.
    ascending : bool or list of bool, default True
         Sort ascending vs. descending. Specify list for multiple sort
         orders.  If this is a list of bools, must match the length of
         the by.
    inplace : bool, default False
         If True, perform operation in-place.
    kind : {&amp;#39;quicksort&amp;#39;, &amp;#39;mergesort&amp;#39;, &amp;#39;heapsort&amp;#39;}, default &amp;#39;quicksort&amp;#39;
         Choice of sorting algorithm. See also ndarray.np.sort for more
         information.  `mergesort` is the only stable algorithm. For
         DataFrames, this option is only applied when sorting on a single
         column or label.
    na_position : {&amp;#39;first&amp;#39;, &amp;#39;last&amp;#39;}, default &amp;#39;last&amp;#39;
         Puts NaNs at the beginning if `first`; `last` puts NaNs at the
         end.
    ignore_index : bool, default False
         If True, the resulting axis will be labeled 0, 1, …, n - 1.
    
         .. versionadded:: 1.0.0
    
    Returns
    -------
    sorted_obj : DataFrame or None
        DataFrame with sorted values if inplace=False, None otherwise.
    
    Examples
    --------
    &amp;gt;&amp;gt;&amp;gt; df = pd.DataFrame({
    ...     &amp;#39;col1&amp;#39;: [&amp;#39;A&amp;#39;, &amp;#39;A&amp;#39;, &amp;#39;B&amp;#39;, np.nan, &amp;#39;D&amp;#39;, &amp;#39;C&amp;#39;],
    ...     &amp;#39;col2&amp;#39;: [2, 1, 9, 8, 7, 4],
    ...     &amp;#39;col3&amp;#39;: [0, 1, 9, 4, 2, 3],
    ... })
    &amp;gt;&amp;gt;&amp;gt; df
        col1 col2 col3
    0   A    2    0
    1   A    1    1
    2   B    9    9
    3   NaN  8    4
    4   D    7    2
    5   C    4    3
    
    Sort by col1
    
    &amp;gt;&amp;gt;&amp;gt; df.sort_values(by=[&amp;#39;col1&amp;#39;])
        col1 col2 col3
    0   A    2    0
    1   A    1    1
    2   B    9    9
    5   C    4    3
    4   D    7    2
    3   NaN  8    4
    
    Sort by multiple columns
    
    &amp;gt;&amp;gt;&amp;gt; df.sort_values(by=[&amp;#39;col1&amp;#39;, &amp;#39;col2&amp;#39;])
        col1 col2 col3
    1   A    1    1
    0   A    2    0
    2   B    9    9
    5   C    4    3
    4   D    7    2
    3   NaN  8    4
    
    Sort Descending
    
    &amp;gt;&amp;gt;&amp;gt; df.sort_values(by=&amp;#39;col1&amp;#39;, ascending=False)
        col1 col2 col3
    4   D    7    2
    5   C    4    3
    2   B    9    9
    0   A    2    0
    1   A    1    1
    3   NaN  8    4
    
    Putting NAs first
    
    &amp;gt;&amp;gt;&amp;gt; df.sort_values(by=&amp;#39;col1&amp;#39;, ascending=False, na_position=&amp;#39;first&amp;#39;)
        col1 col2 col3
    3   NaN  8    4
    4   D    7    2
    5   C    4    3
    2   B    9    9
    0   A    2    0
    1   A    1    1

&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h4 id=&quot;Ordenar-valores&quot;&gt;Ordenar valores&lt;a class=&quot;anchor-link&quot; href=&quot;#Ordenar-valores&quot;&gt; &lt;/a&gt;&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;sort_values&lt;/li&gt;
&lt;li&gt;sort_index&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&quot;Tirar-filas/columnas&quot;&gt;Tirar filas/columnas&lt;a class=&quot;anchor-link&quot; href=&quot;#Tirar-filas/columnas&quot;&gt; &lt;/a&gt;&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;drop&lt;/li&gt;
&lt;li&gt;drop_duplicates&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&quot;Renombrar-filas/columnas&quot;&gt;Renombrar filas/columnas&lt;a class=&quot;anchor-link&quot; href=&quot;#Renombrar-filas/columnas&quot;&gt; &lt;/a&gt;&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;rename&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&quot;Datos-ausentes&quot;&gt;Datos ausentes&lt;a class=&quot;anchor-link&quot; href=&quot;#Datos-ausentes&quot;&gt; &lt;/a&gt;&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;dropna&lt;/li&gt;
&lt;li&gt;fillna&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Recursos-adicionales&quot;&gt;Recursos adicionales&lt;a class=&quot;anchor-link&quot; href=&quot;#Recursos-adicionales&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;h4 id=&quot;Documentaci&amp;#243;n&quot;&gt;Documentaci&amp;#243;n&lt;a class=&quot;anchor-link&quot; href=&quot;#Documentaci&amp;#243;n&quot;&gt; &lt;/a&gt;&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://pandas.pydata.org/pandas-docs/stable/api.html&quot;&gt;API&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&quot;Art&amp;#237;culos&quot;&gt;Art&amp;#237;culos&lt;a class=&quot;anchor-link&quot; href=&quot;#Art&amp;#237;culos&quot;&gt; &lt;/a&gt;&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://gregreda.com/2013/10/26/intro-to-pandas-data-structures/&quot;&gt;Intro to Pandas&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://tomaugspurger.github.io/modern-1-intro&quot;&gt;Modern Pandas&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&quot;Machetes&quot;&gt;Machetes&lt;a class=&quot;anchor-link&quot; href=&quot;#Machetes&quot;&gt; &lt;/a&gt;&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://www.dataquest.io/blog/pandas-cheat-sheet/&quot;&gt;DataQuest cheat sheet&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://s3.amazonaws.com/assets.datacamp.com/blog_assets/PandasPythonForDataScience.pdf&quot;&gt;DataCamp cheat sheet&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://pandas.pydata.org/Pandas_Cheat_Sheet.pdf&quot;&gt;Pandas cheat sheet&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&quot;Libros&quot;&gt;Libros&lt;a class=&quot;anchor-link&quot; href=&quot;#Libros&quot;&gt; &lt;/a&gt;&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://jakevdp.github.io/PythonDataScienceHandbook/&quot;&gt;Python for data science&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Python for data analysis&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;</content><author><name>Matías Battocchia</name></author><summary type="html"></summary></entry><entry><title type="html">Introducción a la programación</title><link href="https://matiasbattocchia.github.io/datitos/Introducci%C3%B3n-a-la-programaci%C3%B3n.html" rel="alternate" type="text/html" title="Introducción a la programación" /><published>2018-03-08T00:00:00-06:00</published><updated>2018-03-08T00:00:00-06:00</updated><id>https://matiasbattocchia.github.io/datitos/Introducci%C3%B3n-a-la-programaci%C3%B3n</id><content type="html" xml:base="https://matiasbattocchia.github.io/datitos/Introducci%C3%B3n-a-la-programaci%C3%B3n.html">&lt;!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2018-03-08-Introducción-a-la-programación.ipynb
--&gt;

&lt;div class=&quot;container&quot; id=&quot;notebook-container&quot;&gt;
        
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Es un trabajo en progreso y quién sabe cuándo será el día que lo retome.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Una-receta-para-elaborar-cerveza&quot;&gt;Una receta para elaborar cerveza&lt;a class=&quot;anchor-link&quot; href=&quot;#Una-receta-para-elaborar-cerveza&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;Ingredientes&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Agua &lt;em&gt;purificada&lt;/em&gt;. Se usan distintos tipos de agua para diferentes tipos de cerveza.&lt;/li&gt;
&lt;li&gt;Cebada &lt;em&gt;malteada, molida&lt;/em&gt;. La cebada es un cereal, el cual pasa por un proceso de malteado que extrae su almidón y sus enzimas.&lt;/li&gt;
&lt;li&gt;Lúpulo. Las flores de lúpulo son las encargadas de dar el amargor y el aroma característicos de la cerveza.&lt;/li&gt;
&lt;li&gt;Levadura para cerveza: Son microorganismos encargados de convertir azúcares en alcohol.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;Elaboración&lt;/strong&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;p&gt;Maceración: Se mezcla el agua con la cebada durante cierto periodo de tiempo a cierta temperatura, las enzimas atacan al almidón convirtiéndolo en azúcares. Se filtra la mezcla. &lt;em&gt;Producto: mosto&lt;/em&gt;.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Hervido: Se hierve el mosto durante cierto tiempo, esto permite su esterilización. En el hervido también se agrega el lúpulo, además de aportar sabor y aroma, frena los procesos enzimáticos. Se lo deja enfriar. &lt;em&gt;Producto: mosto amargo&lt;/em&gt;.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Fermentación: Se le agrega la levadura al mosto. Este proceso dura cierta cantidad de días a cierta temperatura. Luego el mosto fermentado es nuevamente filtrado. &lt;em&gt;Producto: cerveza&lt;/em&gt;.&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;em&gt;Fuente&lt;/em&gt;: &lt;a href=&quot;http://www.blogdecerveza.com/infografia-cerveza-sajonia-brewing&quot;&gt;http://www.blogdecerveza.com/infografia-cerveza-sajonia-brewing&lt;/a&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;La-receta-vista-como-un-programa&quot;&gt;La receta vista como un programa&lt;a class=&quot;anchor-link&quot; href=&quot;#La-receta-vista-como-un-programa&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;En la receta se hace distinción entre los ingredientes y las instrucciones de elaboracción. En un programa sucede algo similar, es posible distinguir a los &lt;strong&gt;datos&lt;/strong&gt; (los ingredientes) del &lt;strong&gt;código&lt;/strong&gt; (las instrucciones); el código es aplicado a los datos para transformarlos y así obtener nuevos datos (los productos), sobre los cuales se puede seguir aplicando código hasta obtener un resultado (o producto) final.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Datos&lt;/strong&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;# cantidades para 15 litros de cerveza artesanal

agua     =  30 litros de agua mineral
malta    = 4,5 kilos  de harina de cebada malteada (malta)
lúpulo   = 200 gramos de lúpulo
levadura =  10 gramos de levadura de cerveza&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;Código&lt;/strong&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;mosto   = macerar(agua, malta)
amargo  = hervir(mosto, lúpulo)
cerveza = fermentar(amargo, levadura)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Resalta en este programa la estructura renglonada. Cada renglón constituye una &lt;strong&gt;instrucción&lt;/strong&gt; que expresa alguna acción a realizar. Vemos que un &lt;strong&gt;programa&lt;/strong&gt; está conformado por una secuencia de una o más instrucciones.&lt;/p&gt;
&lt;p&gt;Todo texto precedido por un numeral (&lt;code&gt;#&lt;/code&gt;) es un &lt;strong&gt;comentario&lt;/strong&gt;. Estos son ignorados por el programa, son útiles para dejar anotaciones que faciliten la lectura del mismo.&lt;/p&gt;
&lt;p&gt;También es notorio el uso del signo igual (&lt;code&gt;=&lt;/code&gt;). Su función es asignar el &lt;strong&gt;valor&lt;/strong&gt; de la derecha a la &lt;strong&gt;variable&lt;/strong&gt; de la izquierda en lo que se conoce como &lt;em&gt;instrucción de asignación&lt;/em&gt;. Un valor es un dato, como mencionamos, una entidad capaz de ser manipulada por el código. A su vez, una variable es un nombre simbólico (también conocido como &lt;em&gt;identificador&lt;/em&gt;) que está asociado a una entidad.&lt;/p&gt;
&lt;p&gt;La variable es la manera breve de referirse al valor, como el nombre o el DNI de una persona, que sirve para evitar hacer una descripción que la identifique cada vez que la queramos mencionar. A diferencia del nombre o el documento de las personas, que están asociados de por vida a una persona particular, una variable puede cambiar de valor mediante posteriores re-asignaciones.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Tipos-de-datos&quot;&gt;Tipos de datos&lt;a class=&quot;anchor-link&quot; href=&quot;#Tipos-de-datos&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Analizaremos con mayor profundidad la sección ingredientes/datos. Es común que los programas comiencen con algunas deficiones de variables ya que constituyen la materia prima sobre la cual realizar la ejecución del código.&lt;/p&gt;
&lt;p&gt;Queremos experimentar un poco, de la receta respetaremos el proceso de elaboración y variaremos las &lt;em&gt;cantidades&lt;/em&gt; y las &lt;em&gt;cualidades&lt;/em&gt; de las materias primas para obtener diversas cervezas. Asociaremos cantidades con valores y cualidades con &lt;strong&gt;tipos&lt;/strong&gt;. A continuación, una tabla que resume los ingredientes.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;     VALOR  |  TIPO
-----------------------
 30 litros  |  agua mineral
4,5 kilos   |  harina de cebada malteada (malta)
200 gramos  |  lúpulo
 10 gramos  |  levadura de cerveza&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Podríamos usar menos lúpulo para crear una cerveza menos amarga. Quizás queramos usar más malta para una cerveza más alcohólica. Mientras mantengamos los valores dentro de ciertos rangos y proporciones la receta funcionará. Esto es interesante y esencialmente se debe a que los &lt;em&gt;tipos&lt;/em&gt; de ingredientes continúan siendo los mismos. Diferente sería el caso de no contar con levadura de cerveza y querer reemplazarla por levadura de pan; sucede que no sirve para hacer cerveza.&lt;/p&gt;
&lt;p&gt;Es así que los datos se diferencian por sus cualidades y que los programas se escriben teniendo en cuenta ciertos tipos de datos y no otros. Algunos lenguajes de programación son escrictos respecto a los tipos —si la receta dice &lt;em&gt;agua mineral&lt;/em&gt; entonces sí o sí tiene que ser agua mineral— y otros, como Python, no lo son: mientras los datos se comporten de manera similar &lt;em&gt;a efectos del programa&lt;/em&gt; entonces pueden usarse de manera indistinta. Por ejemplo, en vez de &lt;em&gt;agua mineral&lt;/em&gt; podríamos utilizar &lt;em&gt;agua filtrada&lt;/em&gt; ya que también se puede beber y &lt;em&gt;a efectos de la receta&lt;/em&gt; servirá para la obtención de mosto por medio del proceso de maceración.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Funciones&quot;&gt;Funciones&lt;a class=&quot;anchor-link&quot; href=&quot;#Funciones&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Ahora profundizaremos sobre la sección elaboración/código. En abstracto se trata de una secuencia de operaciones que resuelve un problema (el de hacer cerveza), lo que se conoce como &lt;strong&gt;algoritmo&lt;/strong&gt;. Concretamente, un algoritmo puede ser expresado de diversas maneras, utilizando un lengaje natural como en la receta, un lenguaje formal como en el programa e incluso gráficamente mediante un diagrama.&lt;/p&gt;
&lt;p&gt;Las operaciones toman datos &lt;em&gt;de entrada&lt;/em&gt;, internamente realizan tareas, y devuelven un dato &lt;em&gt;de salida&lt;/em&gt;. Asociaremos el concepto de operación con el de &lt;strong&gt;función&lt;/strong&gt;. A continuación, una tabla que lista las operaciones del proceso de elaboración.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;FUNCIÓN    |  ENTRADAS                |  SALIDA
-----------------------------------------------------
macerar    |  agua, malta             |  mosto
hervir     |  mosto, lúpulo           |  mosto amargo
fermentar  |  mosto amargo, levadura  |  cerveza&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Las funciones son, como los datos, también entidades. Como sucede con los datos, también se las asocia con un nombre o identificador para poder invocarlas cuando sea necesario. En principio las funciones son operaciones &lt;em&gt;en potencia&lt;/em&gt;, son entidades que si bien son capaces de realizar tareas, se encuentran en letargo. Para convertirlas &lt;em&gt;en acto&lt;/em&gt;, en la realización de las tareas, las funciones deben ser accionadas, lo que se conoce como &lt;em&gt;llamar a la función&lt;/em&gt;. Una manera de lograrlo es mediante el &lt;em&gt;operador llamar a función&lt;/em&gt; &lt;code&gt;()&lt;/code&gt;, que al acompañar a una función, la activa. Dentro de los paréntesis se especifican los valores (datos) de entrada, los llamados &lt;strong&gt;argumentos&lt;/strong&gt; de la función. Como resultado la función será &lt;strong&gt;evaluada&lt;/strong&gt;—convertida en un valor (dato) de salida.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;función(argumentos...)  -&amp;gt;  valor
macerar(agua, malta)    -&amp;gt;  mosto&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Caracterizan a una función los argumentos que requiere, en número y en tipo. Por ejemplo &lt;code&gt;macerar&lt;/code&gt; requiere dos argumentos, el primero del tipo &lt;code&gt;agua&lt;/code&gt; y el segundo del tipo &lt;code&gt;malta&lt;/code&gt;. Fallar al proporcionar los valores requeridos por alguna función durante la ejecución del código hará que se detenga.&lt;/p&gt;
&lt;p&gt;Dijimos que las funciones internamente realizan tareas. No siempre estas tareas producirán meramente el dato a ser retornado sino que tendrán otros efectos como almacenar datos o imprimirlos en pantalla y a veces importan más estos efectos que el valor de salida.&lt;/p&gt;
&lt;p&gt;En la receta asignamos los valores retornados a variables así luego los podemos referenciar.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Ejercicio-1&quot;&gt;Ejercicio 1&lt;a class=&quot;anchor-link&quot; href=&quot;#Ejercicio-1&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Elaborar un glosario con las palabras resaltadas en negrita.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Constantes&quot;&gt;Constantes&lt;a class=&quot;anchor-link&quot; href=&quot;#Constantes&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Las constantes son como las variables solo que mantienen su valor. Es decir que una vez asignado un valor a un nombre (identificador), a este no se le podrá reasignar otro valor en el transcurso del programa.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Operadores&quot;&gt;Operadores&lt;a class=&quot;anchor-link&quot; href=&quot;#Operadores&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Los operadores son como las funciones solo que se escriben diferente para otorgarle al lenguaje naturalidad y expresividad (facilidad para leerlo y escribirlo). Por ejemplo, las operaciones artiméticas nos resultarán más familiares así&lt;/p&gt;

&lt;pre&gt;&lt;code&gt; 1 + 1  -&amp;gt;  2
 8 - 1  -&amp;gt;  7&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;que en una forma funcional.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;sumar(1, 1)   -&amp;gt;  2
restar(8, 1)  -&amp;gt;  7&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Si bien el orden de escritura es otro, en ambos casos el tipo de dato de los argumentos/operandos tiene que ser compatible con la operación y la operación retornará un valor.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;función(argumento_1, argumento_2)  -&amp;gt;  valor
operando_1 operador operando_2     -&amp;gt;  valor&lt;/code&gt;&lt;/pre&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Literales&quot;&gt;Literales&lt;a class=&quot;anchor-link&quot; href=&quot;#Literales&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Los valores surgen de las operaciones, así como la flor de lúpulo sale de una planta—viendo a la planta como un proceso que engendra flores. Por otro lado las operaciones requieren valores de entrada, así como se necesita una semilla para dar origen a una planta. Estamos ante una situación del tipo &lt;em&gt;el huevo y la gallina&lt;/em&gt;, en la que se requieren operaciones para obtener valores y valores para obtener operaciones. Para salir de este enriedo los lenguajes de programación proveen &lt;strong&gt;literales&lt;/strong&gt; para algunos tipos de datos, una manera de escribir valores de manera espontánea, sin recurrir a operaciones que les den origen.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Entidades-primitivas&quot;&gt;Entidades primitivas&lt;a class=&quot;anchor-link&quot; href=&quot;#Entidades-primitivas&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Los lenguajes de programación proveen elementos básicos con los cuales crear programas. Llamamos &lt;strong&gt;primitivas&lt;/strong&gt; a las entidades preexistentes en el lenguaje. Las llamamos así para diferenciarlas de las entidades que es posible construir a partir de estas. Por ejemplo, podemos definir nuestras propias funciones, afines al problema a resolver (más adelante veremos cómo). Mientras tanto el lenguaje cuenta con entidades genéricas con las cuales empezar.&lt;/p&gt;
&lt;p&gt;Python no es un lenguaje especialmente pensado para elaborar cerveza. Los ingredientes con los que cuenta son otros, esta es una lista no exhaustiva de tipos de datos primitivos, los más frecuentes. Entre paréntesis se encuentra el nombre que les da Python.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Nada (&lt;code&gt;NoneType&lt;/code&gt;)&lt;/li&gt;
&lt;li&gt;Booleanos (&lt;code&gt;bool&lt;/code&gt;)&lt;/li&gt;
&lt;li&gt;Numéricos&lt;ul&gt;
&lt;li&gt;Enteros (&lt;code&gt;int&lt;/code&gt;)&lt;/li&gt;
&lt;li&gt;Flotantes (&lt;code&gt;float&lt;/code&gt;)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Secuencias&lt;ul&gt;
&lt;li&gt;Texto (&lt;code&gt;str&lt;/code&gt;)&lt;/li&gt;
&lt;li&gt;Listas (&lt;code&gt;list&lt;/code&gt;)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Mapeos&lt;ul&gt;
&lt;li&gt;Diccionarios (&lt;code&gt;dict&lt;/code&gt;)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;Nada&lt;/strong&gt;. Este tipo tiene un solo valor (hay una única entidad con este valor). Nos podemos refereir a esta entidad usando la constante primitiva &lt;code&gt;None&lt;/code&gt;. Se usa en varias situaciones para significar la ausencia de un valor.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Booleanos&lt;/strong&gt;. Este tipo tiene dos valores. Estas entidades representan los valores &lt;em&gt;verdadero&lt;/em&gt; y &lt;em&gt;falso&lt;/em&gt;. Nos podemos referir a estas entidades mediante las constantes primitivas &lt;code&gt;True&lt;/code&gt; y &lt;code&gt;False&lt;/code&gt; respectivamente.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Enteros&lt;/strong&gt;. Este tipo tiene infinitos valores, son los números positivos y negativos. Estos valores se pueden referenciar de una manera literal utilizando numerales (0–9). Python interpretará al símbolo &lt;code&gt;2&lt;/code&gt; como un entero de valor dos.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Flotantes&lt;/strong&gt;. Son los números reales. Se pueden referenciar literalmente usando numerales y el punto (.) como separador decimal. Python interpretará &lt;code&gt;3.14&lt;/code&gt; como un valor del tipo flotante. Son representaciones &lt;em&gt;aproximadas&lt;/em&gt; de los números reales, es una consesión de precisión por rango, que permite computar números reales muy pequeños y muy grandes eficientemente.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Nota&lt;/em&gt;: Las constantes &lt;code&gt;None&lt;/code&gt;, &lt;code&gt;True&lt;/code&gt; y &lt;code&gt;False&lt;/code&gt; son necesarias ya que no existen en nuestro &lt;em&gt;lenguaje natural occidental&lt;/em&gt; símbolos para referirnos a la nada, a lo verdadero y a lo falso de manera literal, en la manera en la que sí existen caracteres numéricos para referirnos a los números.&lt;/p&gt;
&lt;h3 id=&quot;Secuencias&quot;&gt;Secuencias&lt;a class=&quot;anchor-link&quot; href=&quot;#Secuencias&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Las secuencias son &lt;em&gt;colecciones ordenadas&lt;/em&gt; de datos indexadas por números no negativos. A diferencia de los tipos de datos vistos hasta el momento, el valor de una colección es &lt;em&gt;los datos que contiene&lt;/em&gt;. Un cajón de cervezas viene a ser una colección de botellas de cerveza; el cajón es muy útil para manipular todas esas botellas en conjunto. Por ordenado e indexado nos referimos a que cada lugar del cajón está numerado, lo que nos permite colocar o retirar botellas de lugares específicos.&lt;/p&gt;
&lt;p&gt;La función primitiva &lt;code&gt;len&lt;/code&gt; devuelve la cantidad de ítems de la secuencia—aplicada a un cajón lleno debería devolver el número 12.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;len(secuencia)  -&amp;gt;  tamaño de la secuencia
len(cajón)  -&amp;gt;  12&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;El operador &lt;em&gt;índice&lt;/em&gt; &lt;code&gt;[]&lt;/code&gt; selecciona una posición en la secuencia y devuelve su contenido; dentro de los corchetes se especifica la posición. En Python, &lt;strong&gt;el índice comienza en cero&lt;/strong&gt;.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;secuencia[entero]  -&amp;gt;  dato
cajón[2]  -&amp;gt;  botella de cerveza del lugar número 3&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;Texto&lt;/strong&gt;. Normalmente reciben el nombre de &lt;em&gt;strings&lt;/em&gt; (cuerdas), son colecciones de &lt;strong&gt;caracteres&lt;/strong&gt;. Los valores del tipo &lt;em&gt;string&lt;/em&gt; se pueden generar de manera literal al escribirlos entre comillas simples (') o dobles (&quot;). Por ejemplo el literal &lt;code&gt;&quot;cerveza&quot;&lt;/code&gt; se diferencia del identificador &lt;code&gt;cerveza&lt;/code&gt;, el intérprete de Python [revisar: no se ha explicado qué es el intérprete] al leer el literal lo transformará en un dato del tipo texto cuyo valor es cerveza, en cambio cuando si lee el identificador —la palabra sin comillas— que podría tratarse del nombre de una variable o una función, invocará a la entidad asociada.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Listas&lt;/strong&gt;. Son colecciones arbitrarias de datos. Una lista puede contener todo tipo de datos, incluso otras listas. Se pueden crear de manera literal utilizando corchetes ([ ]) como delimitadores y coma (,) para separar los elementos de la lista.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;números = [1, 2, 3]
números[0]  -&amp;gt;  1&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;em&gt;Nota&lt;/em&gt;: Puede resultar ambigüa la utilización de corchetes, ya que sirven tanto para la creación de listas como para el operador índice. Sin embargo se utilizan de manera diferente, lo que rompe la ambigüedad.&lt;/p&gt;
&lt;h3 id=&quot;Mapeos&quot;&gt;Mapeos&lt;a class=&quot;anchor-link&quot; href=&quot;#Mapeos&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;Los mapeos son colecciones de datos indexadas por valores arbitrarios. Un ejemplo es una agenda de contactos telefónicos; se trata de una colección de números de teléfono, en la que cada número está relacionado —&lt;em&gt;mapeado&lt;/em&gt;— a un nombre de contacto. Relaciona &lt;em&gt;claves&lt;/em&gt; (nombres de contacto) con &lt;em&gt;valores&lt;/em&gt; (números de teléfono). Las secuencias y los mapeos son parecidos, ambos son colecciones, se diferencian en la forma de indexar los datos, es decir, en la forma de recuperarlos: mediante la &lt;strong&gt;posición&lt;/strong&gt; en el caso de las secuencias, por medio de una &lt;strong&gt;clave&lt;/strong&gt; en el de los mapeos. En la agenda, para encontrar un número de teléfono (el valor), lo buscamos por el nombre del contacto (la clave).&lt;/p&gt;
&lt;p&gt;Como sucede con las secuencias,  la función &lt;code&gt;len&lt;/code&gt; devuelve la cantidad de elementos del mapeo y el operador &lt;em&gt;índice&lt;/em&gt; &lt;code&gt;[]&lt;/code&gt; selecciona un elemento del mapeo y devuelve su valor; dentro de los corchetes se especifica la clave.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Diccionarios&lt;/strong&gt;. Es el mapeo paradigmático. Se pueden crear de manera literal utilizando llaves ({ }) como delimitadores, coma (,) para separar los elementos del diccionario, lo que nos recuerda un poco a las listas, solo que los elementos del diccionario son pares clave-valor, utilizándose dos puntos (:) para separar la clave del valor.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;proveedores = {'a':1, 'b':2, 'c':3}
proveedores['b']  -&amp;gt;  2&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;En este ejemplo se usaron &lt;em&gt;strings&lt;/em&gt; para las claves y enteros para los valores. Los tipos de datos que pueden cumplir estas funciones no están limitados a estos, los valores pueden ser de cualquier tipo, incluyendo listas y otros diccionarios; las claves están más acotadas, normalmente son &lt;em&gt;strings&lt;/em&gt;, podrían ser de otros pero no listas ni diccionarios.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;</content><author><name>Matías Battocchia</name></author><summary type="html"></summary></entry><entry><title type="html">Un recorrido por scikit-learn</title><link href="https://matiasbattocchia.github.io/datitos/Recorrido-por-scikit-learn.html" rel="alternate" type="text/html" title="Un recorrido por scikit-learn" /><published>2017-08-04T00:00:00-05:00</published><updated>2017-08-04T00:00:00-05:00</updated><id>https://matiasbattocchia.github.io/datitos/Recorrido-por-scikit-learn</id><content type="html" xml:base="https://matiasbattocchia.github.io/datitos/Recorrido-por-scikit-learn.html">&lt;!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2017-08-04-Recorrido-por-scikit-learn.ipynb
--&gt;

&lt;div class=&quot;container&quot; id=&quot;notebook-container&quot;&gt;
        
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;Preparé unas clases introductorias a la librería de aprendizaje automático &lt;code&gt;scikit-learn&lt;/code&gt;. Las notas de las clases, que aquí comparto, si bien no llegan a conformar un tutorial, perfilan como una guía para recorrer la documentación de la librería en gran parte de su extensión.&lt;/p&gt;
&lt;p&gt;En esencia reorganicé las guías de usuario de la librería en torno al flujo de trabajo del desarrollo de modelos. Adicionalmente, como en la vida real los datos de los que uno suele disponer están lejos de ser perfectos, añadí algunas técnicas para trabajar con conjuntos de datos desbalanceados.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;ul&gt;
&lt;li&gt;Recorrido por las posibilidades de la librería (&lt;a href=&quot;http://scikit-learn.org/stable/user_guide.html&quot;&gt;guías de usuario&lt;/a&gt;)&lt;/li&gt;
&lt;li&gt;Familizarización con la documentación (&lt;a href=&quot;http://scikit-learn.org/stable/modules/classes.html&quot;&gt;API&lt;/a&gt;)&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Tarea&lt;/strong&gt;: implementación de un flujo de trabajo sencillo para regresión (parecido al &lt;a href=&quot;http://scikit-learn.org/stable/tutorial/basic/tutorial.html&quot;&gt;tutorial básico&lt;/a&gt;)&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pandas&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pd&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;numpy&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;np&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;plt&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;seaborn&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sn&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h4 id=&quot;Requisitos&quot;&gt;Requisitos&lt;a class=&quot;anchor-link&quot; href=&quot;#Requisitos&quot;&gt; &lt;/a&gt;&lt;/h4&gt;&lt;p&gt;Algo de familiaridad con NumPy. Ver este &lt;a href=&quot;http://cs231n.github.io/python-numpy-tutorial&quot;&gt;tutorial&lt;/a&gt;.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h4 id=&quot;Utilidad&quot;&gt;Utilidad&lt;a class=&quot;anchor-link&quot; href=&quot;#Utilidad&quot;&gt; &lt;/a&gt;&lt;/h4&gt;&lt;ul&gt;
&lt;li&gt;Aprendizaje supervisado&lt;ul&gt;
&lt;li&gt;Clasificación&lt;/li&gt;
&lt;li&gt;Regresión&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Aprendizaje no supervisado&lt;/li&gt;
&lt;li&gt;&lt;del&gt;Aprendizaje por refuerzos&lt;/del&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Redes neuronales: solo perceptrón multicapa y &lt;em&gt;restricted Boltzmann machine&lt;/em&gt;.&lt;/p&gt;
&lt;h4 id=&quot;Datos&quot;&gt;Datos&lt;a class=&quot;anchor-link&quot; href=&quot;#Datos&quot;&gt; &lt;/a&gt;&lt;/h4&gt;&lt;p&gt;&lt;code&gt;scikit-learn&lt;/code&gt; consume &lt;strong&gt;datos&lt;/strong&gt; con forma de matriz o arreglo bidimensional, de dimensión &lt;code&gt;(n_muestras, n_atributos)&lt;/code&gt; — es como imaginamos normalmente a los datos, dispuestos en una tabla donde las &lt;strong&gt;columnas&lt;/strong&gt; son los atributos y hay tantas muestras como &lt;strong&gt;filas&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;Convencionalmente en la documentación la varible &lt;em&gt;&lt;code&gt;X&lt;/code&gt;&lt;/em&gt; se utiliza para los &lt;strong&gt;atributos&lt;/strong&gt; propiamente dichos, y la variable &lt;em&gt;&lt;code&gt;y&lt;/code&gt;&lt;/em&gt; para los &lt;strong&gt;objetivos&lt;/strong&gt;. Cuando el objetivo es uno solo, &lt;em&gt;&lt;code&gt;y&lt;/code&gt;&lt;/em&gt; suele tomar la forma de arreglo unidimensional de dimensión &lt;code&gt;(n_muestras,)&lt;/code&gt;.&lt;/p&gt;
&lt;h4 id=&quot;Objetos&quot;&gt;Objetos&lt;a class=&quot;anchor-link&quot; href=&quot;#Objetos&quot;&gt; &lt;/a&gt;&lt;/h4&gt;&lt;p&gt;En &lt;code&gt;scikit-learn&lt;/code&gt; hay dos tipos fundamentales de objetos:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;Los &lt;strong&gt;transformadores&lt;/strong&gt;, que implementan los métodos&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;fit(X, y)&lt;/code&gt; y&lt;/li&gt;
&lt;li&gt;&lt;code&gt;transform(X)&lt;/code&gt;,&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;y los &lt;strong&gt;estimadores&lt;/strong&gt;, que implementan&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;fit(X, y)&lt;/code&gt;,&lt;/li&gt;
&lt;li&gt;&lt;code&gt;predict(X)&lt;/code&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Flujo-de-trabajo&quot;&gt;Flujo de trabajo&lt;a class=&quot;anchor-link&quot; href=&quot;#Flujo-de-trabajo&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;&lt;img src=&quot;https://docs.google.com/drawings/d/1HJH4Al7gkcIKOr21w-ciZwAFZad6CsU_YKdeAiHHolA/pub?w=960&amp;amp;h=720&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Datos&quot;&gt;Datos&lt;a class=&quot;anchor-link&quot; href=&quot;#Datos&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Vamos a usar el conjunto de datos de plantas de iris para los ejemplos. Este dataset es una especie de hola mundo del aprendizaje de máquinas.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://upload.wikimedia.org/wikipedia/commons/4/41/Iris_versicolor_3.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Cantidad de instancias&lt;/strong&gt;: 150&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Atributos&lt;/strong&gt; (4)&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;1. Largo del sépalo [cm]
2. Ancho del sépalo [cm]
3. Largo del pétalo [cm]
4. Ancho del pétalo [cm]

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;Objetivos&lt;/strong&gt; (1)&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;5. Clase
    - Setosa
    - Versicolour
    - Virginica

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;Valores ausentes&lt;/strong&gt;: No&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sklearn.datasets&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;load_iris&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;iris&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;load_iris&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;iris&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;iris&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;target&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;X: datos   &amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;y: objetivo&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;X: datos    (150, 4)
y: objetivo (150,)
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Limpieza-de-datos&quot;&gt;Limpieza de datos&lt;a class=&quot;anchor-link&quot; href=&quot;#Limpieza-de-datos&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Data_cleansing&quot;&gt;https://en.wikipedia.org/wiki/Data_cleansing&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Cardinalidad&lt;/li&gt;
&lt;li&gt;Rango&lt;/li&gt;
&lt;li&gt;Desviación&lt;/li&gt;
&lt;li&gt;Tipo&lt;ul&gt;
&lt;li&gt;Booleano&lt;/li&gt;
&lt;li&gt;Numéro (separadores)&lt;/li&gt;
&lt;li&gt;Texto&lt;ul&gt;
&lt;li&gt;espacios (&lt;em&gt;trimming&lt;/em&gt;)&lt;/li&gt;
&lt;li&gt;tildes&lt;/li&gt;
&lt;li&gt;casos (mayúsculas, minúsculas)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Codificación&lt;/strong&gt; (UTF-8, etcétera)&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Partici&amp;#243;n-del-conjunto-de-datos&quot;&gt;Partici&amp;#243;n del conjunto de datos&lt;a class=&quot;anchor-link&quot; href=&quot;#Partici&amp;#243;n-del-conjunto-de-datos&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;Entrenamiento (50%)&lt;/li&gt;
&lt;li&gt;Validación (25%) — salvo cross-validation o ausencia de hiperparámetros.&lt;/li&gt;
&lt;li&gt;Prueba (25%)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;Ejemplo&lt;/strong&gt;: &lt;code&gt;train_test_split&lt;/code&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sklearn.model_selection&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train_test_split&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;X_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_test&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train_test_split&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;test_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.25&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;random_state&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Transformadores:-preprocesamiento-de-atributos&quot;&gt;Transformadores: preprocesamiento de atributos&lt;a class=&quot;anchor-link&quot; href=&quot;#Transformadores:-preprocesamiento-de-atributos&quot;&gt; &lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Extracci&amp;#243;n&quot;&gt;Extracci&amp;#243;n&lt;a class=&quot;anchor-link&quot; href=&quot;#Extracci&amp;#243;n&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;&lt;a href=&quot;http://scikit-learn.org/stable/modules/feature_extraction.html&quot;&gt;http://scikit-learn.org/stable/modules/feature_extraction.html&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Imágenes&lt;/li&gt;
&lt;li&gt;Texto&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Transformaci&amp;#243;n&quot;&gt;Transformaci&amp;#243;n&lt;a class=&quot;anchor-link&quot; href=&quot;#Transformaci&amp;#243;n&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;&lt;a href=&quot;http://scikit-learn.org/stable/modules/preprocessing.html#standardization-or-mean-removal-and-variance-scaling&quot;&gt;http://scikit-learn.org/stable/modules/preprocessing.html#standardization-or-mean-removal-and-variance-scaling&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Estandarización (&lt;code&gt;StandardScaler&lt;/code&gt;) — A cada atributo le remueve su valor medio y lo escala dividiéndolo por su desviación estándar.&lt;ul&gt;
&lt;li&gt;Centrar los datos es prácticamente obligatorio (hay excepciones).&lt;/li&gt;
&lt;li&gt;Normalizar los datos solo si los atributos difieren en unidades y/u órdenes de magnitud.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Reajuste&lt;ul&gt;
&lt;li&gt;Rango (&lt;code&gt;MinMaxScaler&lt;/code&gt;)&lt;/li&gt;
&lt;li&gt;Valor absoluto (&lt;code&gt;MaxAbsScaler&lt;/code&gt;)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;Ejemplo&lt;/strong&gt;: &lt;code&gt;StandardScaler&lt;/code&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sklearn.preprocessing&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;StandardScaler&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;std&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;StandardScaler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;with_mean&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;with_std&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;X_train_std&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;transform&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;     
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;img src=&quot;http://cs231n.github.io/assets/nn2/prepro1.jpeg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;a href=&quot;http://scikit-learn.org/stable/modules/preprocessing.html#normalization&quot;&gt;http://scikit-learn.org/stable/modules/preprocessing.html#normalization&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Normalización (Normalizer) — Divide vectores por su norma (afecta filas en vez de columnas).&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Imputaci&amp;#243;n-de-valores-ausentes&quot;&gt;Imputaci&amp;#243;n de valores ausentes&lt;a class=&quot;anchor-link&quot; href=&quot;#Imputaci&amp;#243;n-de-valores-ausentes&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;&lt;a href=&quot;http://scikit-learn.org/stable/modules/preprocessing.html#imputation-of-missing-values&quot;&gt;http://scikit-learn.org/stable/modules/preprocessing.html#imputation-of-missing-values&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Descarte (tirar la muestra)&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Valor más común&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Valor medio&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Valor mediano&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;Estimación (clasificación/regresión)&lt;/li&gt;
&lt;li&gt;&lt;em&gt;Hot-deck&lt;/em&gt; (el valor de la muestra más parecida)&lt;/li&gt;
&lt;li&gt;Valor ausente (&lt;em&gt;NA&lt;/em&gt;) como otro valor&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Creaci&amp;#243;n&quot;&gt;Creaci&amp;#243;n&lt;a class=&quot;anchor-link&quot; href=&quot;#Creaci&amp;#243;n&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;&lt;a href=&quot;http://scikit-learn.org/stable/modules/preprocessing.html#generating-polynomial-features&quot;&gt;http://scikit-learn.org/stable/modules/preprocessing.html#generating-polynomial-features&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;De $(X_1, X_2)$ a $(1, X_1, X_2, X_1^2, X_1X_2, X_2^2)$.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Reducci&amp;#243;n-de-dimensionalidad&quot;&gt;Reducci&amp;#243;n de dimensionalidad&lt;a class=&quot;anchor-link&quot; href=&quot;#Reducci&amp;#243;n-de-dimensionalidad&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;&lt;a href=&quot;http://scikit-learn.org/stable/modules/unsupervised_reduction.html&quot;&gt;http://scikit-learn.org/stable/modules/unsupervised_reduction.html&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;PCA — análisis de componentes principales. Estandarizar los datos antes de usar PCA.&lt;/li&gt;
&lt;li&gt;Casi todos los estimadores &lt;strong&gt;no supervisados&lt;/strong&gt; implementan el método &lt;code&gt;transform(X)&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://scikit-learn.org/stable/modules/lda_qda.html&quot;&gt;Algunos&lt;/a&gt; estimadores &lt;strong&gt;supervisados&lt;/strong&gt; también.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;Ejemplo&lt;/strong&gt;: &lt;code&gt;PCA&lt;/code&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sklearn.decomposition&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PCA&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;pca&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;PCA&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_components&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;whiten&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;False&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;pca&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X_train_std&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;X_train_pca&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pca&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;transform&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X_train_std&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;img src=&quot;http://cs231n.github.io/assets/nn2/prepro2.jpeg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Selecci&amp;#243;n-&amp;#8212;-solo-aprendizaje-supervisado&quot;&gt;Selecci&amp;#243;n &amp;#8212; solo aprendizaje supervisado&lt;a class=&quot;anchor-link&quot; href=&quot;#Selecci&amp;#243;n-&amp;#8212;-solo-aprendizaje-supervisado&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;&lt;a href=&quot;http://scikit-learn.org/stable/modules/feature_selection.html&quot;&gt;http://scikit-learn.org/stable/modules/feature_selection.html&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Umbral de varianza&lt;/li&gt;
&lt;li&gt;Análisis univariado&lt;/li&gt;
&lt;li&gt;Usando un estimador&lt;/li&gt;
&lt;li&gt;Eliminación recursiva (también existe la agregación recursiva)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;Ejemplo&lt;/strong&gt;: &lt;code&gt;SelectKBest&lt;/code&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sklearn.feature_selection&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SelectKBest&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;kbest&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SelectKBest&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;kbest&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X_train_std&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;X_train_kbest&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;kbest&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;transform&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X_train_std&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Estimadores:-selecci&amp;#243;n-de-modelos&quot;&gt;Estimadores: selecci&amp;#243;n de modelos&lt;a class=&quot;anchor-link&quot; href=&quot;#Estimadores:-selecci&amp;#243;n-de-modelos&quot;&gt; &lt;/a&gt;&lt;/h2&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;img src=&quot;http://scikit-learn.org/stable/_static/ml_map.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;¿Qué estimador usar para el conjunto de datos de &lt;strong&gt;plantas de iris&lt;/strong&gt;?&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;¿Más de 50 muestras? Sí, el conjunto de datos tiene 150 (en realidad un poco menos porque hemos separado un conjunto de prueba).&lt;/li&gt;
&lt;li&gt;¿Hay que predecir una categoría? Sí, queremos predecir a qué especie pertenece cada planta.&lt;/li&gt;
&lt;li&gt;¿Los datos estás anotados? Sí, están anotados en tres categorías.&lt;/li&gt;
&lt;li&gt;¿Más de 100,000 muestras? No...&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Nos recomiendan usar una máquina de vectores de soporte (&lt;a href=&quot;https://en.wikipedia.org/wiki/Support_vector_machine&quot;&gt;&lt;em&gt;support vector machine&lt;/em&gt;&lt;/a&gt;) con un &lt;em&gt;kernel&lt;/em&gt; lineal.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;strong&gt;Ejemplo&lt;/strong&gt;: &lt;code&gt;SVC&lt;/code&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sklearn.svm&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SVC&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;estimador&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SVC&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;kernel&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;linear&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;C&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;probability&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;True&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;estimador&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X_train_std&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;X_test_std&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;transform&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;y_pred&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;estimador&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;predict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X_test_std&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;predict_proba(X)&quot;&gt;&lt;code&gt;predict_proba(X)&lt;/code&gt;&lt;a class=&quot;anchor-link&quot; href=&quot;#predict_proba(X)&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;&lt;a href=&quot;http://scikit-learn.org/stable/modules/calibration.html&quot;&gt;http://scikit-learn.org/stable/modules/calibration.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Al realizar la clasificación, a menudo se desea no solo predecir la etiqueta de la clase, sino también obtener una probabilidad de la etiqueta. Esta probabilidad da algún tipo de confianza en la predicción. Algunos modelos pueden darle estimaciones pobres de las probabilidades de la clase y algunos incluso no admiten la predicción de probabilidad. El módulo de calibración le permite calibrar mejor las probabilidades de un modelo determinado o agregar soporte para la predicción de probabilidad.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;estimador&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;predict_proba&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[:&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;round&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;array([[ 0.,  0.,  1.],
       [ 0.,  0.,  1.],
       [ 0.,  1.,  0.]])&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Cantidad-de-objetivos-&amp;#8212;-solo-aprendizaje-supervisado&quot;&gt;Cantidad de objetivos &amp;#8212; solo aprendizaje supervisado&lt;a class=&quot;anchor-link&quot; href=&quot;#Cantidad-de-objetivos-&amp;#8212;-solo-aprendizaje-supervisado&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;&lt;a href=&quot;http://scikit-learn.org/stable/modules/multiclass.html&quot;&gt;http://scikit-learn.org/stable/modules/multiclass.html&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Clasificador&lt;ul&gt;
&lt;li&gt;Binario&lt;/li&gt;
&lt;li&gt;Multi&lt;ul&gt;
&lt;li&gt;Clase&lt;/li&gt;
&lt;li&gt;Etiqueta&lt;/li&gt;
&lt;li&gt;Clase-etiqueta&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Regresor&lt;ul&gt;
&lt;li&gt;Univariado&lt;/li&gt;
&lt;li&gt;Multivariado&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;En &lt;code&gt;scikit-learn&lt;/code&gt; todos los clasificadores aceptan varias clases&lt;/strong&gt;. Algunos estimadores trabajan inherentemente con múltiples objetivos y le sacan provecho a la correlación entre los mismos. Cuando no es el caso del estimador, existen diferentes estrategias para que admita múltiples objetivos:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;em&gt;OVO&lt;/em&gt; (uno-contra-uno),&lt;/li&gt;
&lt;li&gt;&lt;em&gt;OVA&lt;/em&gt; (uno-contra-todos).&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Ensambles-&amp;#8212;-solo-aprendizaje-supervisado&quot;&gt;Ensambles &amp;#8212; solo aprendizaje supervisado&lt;a class=&quot;anchor-link&quot; href=&quot;#Ensambles-&amp;#8212;-solo-aprendizaje-supervisado&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;&lt;a href=&quot;http://scikit-learn.org/stable/modules/ensemble.html&quot;&gt;http://scikit-learn.org/stable/modules/ensemble.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Diferentes tipos de ensambles:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Promediadores: estimadores en paralelo, reducen la &lt;strong&gt;varianza&lt;/strong&gt;.&lt;/li&gt;
&lt;li&gt;Propulsores (&lt;em&gt;boosting&lt;/em&gt;): estimadores en serie, reducen el &lt;strong&gt;sesgo&lt;/strong&gt;.&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Evaluaci&amp;#243;n-del-modelo&quot;&gt;Evaluaci&amp;#243;n del modelo&lt;a class=&quot;anchor-link&quot; href=&quot;#Evaluaci&amp;#243;n-del-modelo&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;http://scikit-learn.org/stable/modules/model_evaluation.html&quot;&gt;http://scikit-learn.org/stable/modules/model_evaluation.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Cada estimador implementa un método llamado &lt;code&gt;score(X, y)&lt;/code&gt; que devuelve un puntaje del desempeño del estimador. El puntaje es calculado usando una métrica acorde a la naturaleza del estimador, por ejemplo los regresores suelen reportar &lt;strong&gt;R²&lt;/strong&gt; mientas que los clasificadores, &lt;strong&gt;efectividad&lt;/strong&gt;.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;estimador&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;score&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X_test_std&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;0.97368421052631582&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Efectividad&quot;&gt;&lt;a href=&quot;http://scikit-learn.org/stable/modules/generated/sklearn.metrics.accuracy_score.html&quot;&gt;Efectividad&lt;/a&gt;&lt;a class=&quot;anchor-link&quot; href=&quot;#Efectividad&quot;&gt; &lt;/a&gt;&lt;/h3&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sklearn.metrics&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;accuracy_score&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;accuracy_score&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_pred&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;0.97368421052631582&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Matriz-de-confusi&amp;#243;n&quot;&gt;&lt;a href=&quot;http://scikit-learn.org/stable/modules/generated/sklearn.metrics.confusion_matrix.html&quot;&gt;Matriz de confusi&amp;#243;n&lt;/a&gt;&lt;a class=&quot;anchor-link&quot; href=&quot;#Matriz-de-confusi&amp;#243;n&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Confusion_matrix&quot;&gt;https://en.wikipedia.org/wiki/Confusion_matrix&lt;/a&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sklearn.metrics&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;confusion_matrix&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;confusion_matrix&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_pred&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;array([[13,  0,  0],
       [ 0, 15,  1],
       [ 0,  0,  9]])&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Reporte&quot;&gt;&lt;a href=&quot;http://scikit-learn.org/stable/modules/generated/sklearn.metrics.classification_report.html&quot;&gt;Reporte&lt;/a&gt;&lt;a class=&quot;anchor-link&quot; href=&quot;#Reporte&quot;&gt; &lt;/a&gt;&lt;/h3&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sklearn.metrics&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;classification_report&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;clases&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;Setosa&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Versicolour&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;Virginica&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;classification_report&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_pred&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;target_names&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;clases&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;             precision    recall  f1-score   support

     Setosa       1.00      1.00      1.00        13
Versicolour       1.00      0.94      0.97        16
  Virginica       0.90      1.00      0.95         9

avg / total       0.98      0.97      0.97        38

&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;F1&quot;&gt;&lt;a href=&quot;http://scikit-learn.org/stable/modules/generated/sklearn.metrics.f1_score.html&quot;&gt;F1&lt;/a&gt;&lt;a class=&quot;anchor-link&quot; href=&quot;#F1&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;&lt;em&gt;Útil para conjuntos de datos desbalanceados&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;$F_1 = 2 \cdot \frac{\mathrm{precision} \cdot \mathrm{recall}}{\mathrm{precision} + \mathrm{recall}}$&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sklearn.metrics&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;f1_score&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;f1_score&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_pred&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;average&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;weighted&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;  
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;0.97395228308462156&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h3 id=&quot;Kappa-de-Cohen&quot;&gt;&lt;a href=&quot;http://scikit-learn.org/stable/modules/generated/sklearn.metrics.cohen_kappa_score.html&quot;&gt;Kappa de Cohen&lt;/a&gt;&lt;a class=&quot;anchor-link&quot; href=&quot;#Kappa-de-Cohen&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;p&gt;&lt;a href=&quot;https://en.wikipedia.org/wiki/Cohen&amp;#39;s_kappa&quot;&gt;https://en.wikipedia.org/wiki/Cohen&amp;#39;s_kappa&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Útil para conjuntos de datos desbalanceados&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;$\kappa = \frac{p_o - p_e}{1 - p_e}$&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sklearn.metrics&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cohen_kappa_score&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;cohen_kappa_score&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_pred&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;0.95978835978835975&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Flujo-de-datos&quot;&gt;Flujo de datos&lt;a class=&quot;anchor-link&quot; href=&quot;#Flujo-de-datos&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;&lt;img src=&quot;https://docs.google.com/drawings/d/1aabA_HusMS9sjpVGhFxgYtsKyTypsLz9qd5BqqwAL-U/pub?w=1922&amp;amp;h=663&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Pipeline&quot;&gt;Pipeline&lt;a class=&quot;anchor-link&quot; href=&quot;#Pipeline&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;http://scikit-learn.org/stable/modules/pipeline.html&quot;&gt;http://scikit-learn.org/stable/modules/pipeline.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Todos los objetos del flujo, excepto el último, deben ser muestreadores/&lt;strong&gt;transformadores&lt;/strong&gt; (deben implementar el método &lt;code&gt;sample&lt;/code&gt;/&lt;code&gt;transform&lt;/code&gt;). El último objeto puede ser de cualquier tipo, suele ser un estimador.&lt;/p&gt;
&lt;p&gt;Prestar atención a &lt;a href=&quot;https://scikit-learn.org/stable/modules/compose.html#column-transformer&quot;&gt;ColumnTransformer&lt;/a&gt; que permite aplicar transformadores a DataFrames de Pandas.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sklearn.pipeline&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;make_pipeline&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;flujo&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;make_pipeline&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;StandardScaler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;SVC&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;())&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;flujo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;flujo&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;score&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;0.97368421052631582&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Optimizaci&amp;#243;n:-validaci&amp;#243;n-cruzada&quot;&gt;Optimizaci&amp;#243;n: validaci&amp;#243;n cruzada&lt;a class=&quot;anchor-link&quot; href=&quot;#Optimizaci&amp;#243;n:-validaci&amp;#243;n-cruzada&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;http://scikit-learn.org/stable/modules/cross_validation.html&quot;&gt;http://scikit-learn.org/stable/modules/cross_validation.html&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;El conjunto de datos de validación sirve para ajustar a los &lt;strong&gt;hiperparámetros&lt;/strong&gt; de los objetos que componen el flujo de trabajo, tanto como para la composición del flujo en sí mismo. La &lt;strong&gt;validación cruzada&lt;/strong&gt; es útil cuando el conjunto de validación es necesario y las muestras son escasas.&lt;/p&gt;
&lt;p&gt;Se necesitan dos cosas:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Una estrategia de particionamiento de los datos.&lt;/li&gt;
&lt;li&gt;Una métrica de evaluación.&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&quot;Estrategias&quot;&gt;Estrategias&lt;a class=&quot;anchor-link&quot; href=&quot;#Estrategias&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;K-fold, stratified k-fold — estrategias por defecto para regresores y clasificadores respectivamente.&lt;/li&gt;
&lt;li&gt;Leave one out (LOO)&lt;/li&gt;
&lt;li&gt;Leave P out (LPO)&lt;/li&gt;
&lt;li&gt;Shuffle &amp;amp; split, stratified shuffle &amp;amp; split&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&quot;https://docs.google.com/drawings/d/1EoJOIjEnVkVGYDyknO7ecsk7zUucGRMrHp8yJgpaYuQ/pub?w=826&amp;amp;h=405&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;
&lt;h3 id=&quot;M&amp;#233;tricas&quot;&gt;M&amp;#233;tricas&lt;a class=&quot;anchor-link&quot; href=&quot;#M&amp;#233;tricas&quot;&gt; &lt;/a&gt;&lt;/h3&gt;&lt;ul&gt;
&lt;li&gt;De no especificarse ninguna, se usa el método &lt;code&gt;score(X, y)&lt;/code&gt; del estimador.&lt;/li&gt;
&lt;li&gt;Las métricas más comunes se pueden pasar como argumento (&lt;em&gt;string&lt;/em&gt;), ver &lt;a href=&quot;http://scikit-learn.org/stable/modules/model_evaluation.html#common-cases-predefined-values&quot;&gt;tabla&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;Se pueden armar &lt;a href=&quot;http://scikit-learn.org/stable/modules/generated/sklearn.metrics.make_scorer.html&quot;&gt;&lt;strong&gt;puntuadores&lt;/strong&gt;&lt;/a&gt; a partir de cualquier métrica, tanto de la API como definidas por el usuario, y pasar como argumento (&lt;em&gt;función&lt;/em&gt;).&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;a href=&quot;http://scikit-learn.org/stable/modules/generated/sklearn.model_selection.cross_val_score.html&quot;&gt;http://scikit-learn.org/stable/modules/generated/sklearn.model_selection.cross_val_score.html&lt;/a&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sklearn.model_selection&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cross_val_score&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;resultados&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cross_val_score&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flujo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cv&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;scoring&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;f1_weighted&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;F1 promedio: &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%0.2f&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt; (+/- &lt;/span&gt;&lt;span class=&quot;si&quot;&gt;%0.2f&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;)&amp;#39;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;resultados&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;mean&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(),&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;resultados&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;std&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;F1 promedio: 0.96 (+/- 0.08)
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Optimizaci&amp;#243;n:-b&amp;#250;squeda&quot;&gt;Optimizaci&amp;#243;n: b&amp;#250;squeda&lt;a class=&quot;anchor-link&quot; href=&quot;#Optimizaci&amp;#243;n:-b&amp;#250;squeda&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;http://scikit-learn.org/stable/modules/grid_search.html&quot;&gt;http://scikit-learn.org/stable/modules/grid_search.html&lt;/a&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sklearn.model_selection&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;GridSearchCV&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;hiperparámetros&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;s1&quot;&gt;&amp;#39;svc__kernel&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;linear&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;rbf&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;),&lt;/span&gt;
         &lt;span class=&quot;s1&quot;&gt;&amp;#39;svc__C&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;grilla&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;GridSearchCV&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;flujo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;hiperparámetros&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;grilla&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
    
&lt;span class=&quot;n&quot;&gt;estimador&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;grilla&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;best_estimator_&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Evaluaci&amp;#243;n-final&quot;&gt;Evaluaci&amp;#243;n final&lt;a class=&quot;anchor-link&quot; href=&quot;#Evaluaci&amp;#243;n-final&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Una vez elegido el modelo y ajustados sus hiperparámetros, si se desea los conjuntos de datos de entrenamiento y de validación pueden fusionarse en un nuevo conjunto de entrenamiento para reentrenar el modelo final usando más datos — de hecho es lo que hace &lt;code&gt;GridSearchCV&lt;/code&gt; para el mejor estimador.&lt;/p&gt;
&lt;p&gt;En cambio por más seguridad que se tenga del desempeño del modelo, no es recomendable usar los datos del conjunto de prueba, es mejor usarlos para medir su desempeño y asegurarnos de que esté libre de errores.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_pred&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;estimador&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;predict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;f1_score&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_pred&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;average&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;weighted&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Persistencia-del-modelo&quot;&gt;Persistencia del modelo&lt;a class=&quot;anchor-link&quot; href=&quot;#Persistencia-del-modelo&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;http://scikit-learn.org/stable/modules/model_persistence.html&quot;&gt;http://scikit-learn.org/stable/modules/model_persistence.html&lt;/a&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;pickle&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# persistencia&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;modelo.pickle&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;wb&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;archivo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;pickle&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;dump&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;estimador&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;archivo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# carga&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;with&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;modelo.pickle&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&amp;#39;rb&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;archivo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;n&quot;&gt;estimador&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;pickle&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;load&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;archivo&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Extra:-Muestreo-&amp;#8212;-conjunto-desbalanceado&quot;&gt;Extra: Muestreo &amp;#8212; conjunto desbalanceado&lt;a class=&quot;anchor-link&quot; href=&quot;#Extra:-Muestreo-&amp;#8212;-conjunto-desbalanceado&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;El &lt;em&gt;entrenamiento&lt;/em&gt; y la &lt;em&gt;validación&lt;/em&gt; de estimadores suele requerir conjuntos de datos &lt;strong&gt;balanceados&lt;/strong&gt;; no así la &lt;em&gt;prueba&lt;/em&gt; de los mismos ya que deben enfrentar datos reales del problema (&lt;strong&gt;desbalanceados&lt;/strong&gt;).&lt;/p&gt;
&lt;p&gt;&lt;code&gt;scikit-learn&lt;/code&gt; apenas provee algoritmos de muestro, podemos usar la extensión &lt;code&gt;imbalanced-learn&lt;/code&gt; que implementa varios.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;pip install imbalanced-learn
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;code&gt;imbalanced-learn&lt;/code&gt; aporta objetos del tipo &lt;strong&gt;muestreador&lt;/strong&gt; (&lt;em&gt;sampler&lt;/em&gt;) que implementan los métodos&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;fit(X, y)&lt;/code&gt; y&lt;/li&gt;
&lt;li&gt;&lt;code&gt;sample(X, y)&lt;/code&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Algunos algoritmos:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Under-sampling&lt;ul&gt;
&lt;li&gt;ClusterCentroids&lt;/li&gt;
&lt;li&gt;RandomUnderSampler&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Over-sampling&lt;ul&gt;
&lt;li&gt;SMOTE&lt;/li&gt;
&lt;li&gt;RandomOverSampler&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;Nota&lt;/strong&gt;: &lt;code&gt;imbalanced-learn&lt;/code&gt; re-implementa la clase &lt;code&gt;Pipeline&lt;/code&gt; para que admita muestreadores.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Ejemplo&lt;/strong&gt;: &lt;code&gt;RandomUnderSampler&lt;/code&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sklearn.datasets&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;make_classification&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;imblearn.under_sampling&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;RandomUnderSampler&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# generación de un conjunto de datos&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;make_classification&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;n_classes&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;class_sep&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;weights&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;0.9&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;
                           &lt;span class=&quot;n&quot;&gt;n_informative&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_redundant&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;flip_y&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                           &lt;span class=&quot;n&quot;&gt;n_features&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;n_clusters_per_class&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;
                           &lt;span class=&quot;n&quot;&gt;n_samples&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;200&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;random_state&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# aplicación de random under-sampling&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;rus&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;RandomUnderSampler&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;X_resampled&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_resampled&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;rus&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit_sample&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Ejercicio:-Boston-price-data-set&quot;&gt;Ejercicio: Boston price data set&lt;a class=&quot;anchor-link&quot; href=&quot;#Ejercicio:-Boston-price-data-set&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;Cantidad de instancias&lt;/strong&gt;: 506&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Atributos&lt;/strong&gt; (13)&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;1.  CRIM per capita crime rate by town
2.  ZN proportion of residential land zoned for lots over 25,000 sq.ft.
3.  INDUS proportion of non-retail business acres per town
4.  CHAS Charles River dummy variable (= 1 if tract bounds river; 0 otherwise)
5.  NOX nitric oxides concentration (parts per 10 million)
6.  RM average number of rooms per dwelling
7.  AGE proportion of owner-occupied units built prior to 1940
8.  DIS weighted distances to five Boston employment centres
9.  RAD index of accessibility to radial highways
10. TAX full-value property-tax rate per 10,000 USD
11. PTRATIO pupil-teacher ratio by town
12. B 1000(Bk - 0.63)^2 where Bk is the proportion of blacks by town
13. LSTAT % lower status of the population

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;Objetivos&lt;/strong&gt; (1)&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;14. MEDV Median value of owner-occupied homes in 1000’s USD

&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;Valores ausentes&lt;/strong&gt;: No&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sklearn.datasets&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;load_boston&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;boston&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;load_boston&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;()&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;   &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;boston&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;data&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;boston&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;target&lt;/span&gt;

&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;X: datos   &amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;print&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;y: objetivo&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;X: datos    (506, 13)
y: objetivo (506,)
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sklearn.model_selection&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train_test_split&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;X_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;X_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_test&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;train_test_split&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;test_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;0.25&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;p&gt;&lt;strong&gt;Sugerencias&lt;/strong&gt;:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;1.1 &lt;a href=&quot;http://scikit-learn.org/stable/modules/linear_model.html&quot;&gt;Modelo lineal&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;1.1.1. Ordinary least squares&lt;/li&gt;
&lt;li&gt;1.1.2. Ridge regression&lt;/li&gt;
&lt;li&gt;1.1.3. Lasso&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;c1&quot;&gt;# implementar estimador&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sklearn.metrics&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r2_score&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;r2_score&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_pred&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# mientras más cerca de 1.0, mejor&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;0.89914051165600339&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;div class=&quot;cell border-box-sizing text_cell rendered&quot;&gt;&lt;div class=&quot;inner_cell&quot;&gt;
&lt;div class=&quot;text_cell_render border-box-sizing rendered_html&quot;&gt;
&lt;h2 id=&quot;Automatizaci&amp;#243;n&quot;&gt;Automatizaci&amp;#243;n&lt;a class=&quot;anchor-link&quot; href=&quot;#Automatizaci&amp;#243;n&quot;&gt; &lt;/a&gt;&lt;/h2&gt;&lt;p&gt;&lt;a href=&quot;https://github.com/rhiever/tpot&quot;&gt;TPOT&lt;/a&gt; es una herramienta de aprendizaje automático automatizado que optimiza el flujo de trabajo.&lt;/p&gt;
&lt;div class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;pip install tpot
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;tpot&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TPOTRegressor&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;tpot&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;TPOTRegressor&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;generations&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;population_size&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;verbosity&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;n&quot;&gt;tpot&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;fit&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_train&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;y_pred&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;tpot&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;predict&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;X_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Warning: xgboost.XGBRegressor is not available and will not be used by TPOT.
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stderr output_text&quot;&gt;
&lt;pre&gt;Optimization Progress:  50%|█████     | 40/80 [00:11&amp;lt;00:09,  4.27pipeline/s]&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Generation 1 - Current best internal CV score: 14.469198135864161
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stderr output_text&quot;&gt;
&lt;pre&gt;Optimization Progress:  75%|███████▌  | 60/80 [00:28&amp;lt;00:10,  1.84pipeline/s]&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Generation 2 - Current best internal CV score: 14.43020757845812
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stderr output_text&quot;&gt;
&lt;pre&gt;                                                                            &lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stdout output_text&quot;&gt;
&lt;pre&gt;Generation 3 - Current best internal CV score: 14.358659442160791

Best pipeline: RandomForestRegressor(input_matrix, RandomForestRegressor__bootstrap=True, RandomForestRegressor__max_features=DEFAULT, RandomForestRegressor__min_samples_leaf=DEFAULT, RandomForestRegressor__min_samples_split=8, RandomForestRegressor__n_estimators=DEFAULT)
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_area&quot;&gt;

&lt;div class=&quot;output_subarea output_stream output_stderr output_text&quot;&gt;
&lt;pre&gt;
&lt;/pre&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;kn&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;sklearn.metrics&lt;/span&gt; &lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;r2_score&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;r2_score&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y_test&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;y_pred&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# mientras más cerca de 1.0, mejor&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;output_wrapper&quot;&gt;
&lt;div class=&quot;output&quot;&gt;

&lt;div class=&quot;output_area&quot;&gt;



&lt;div class=&quot;output_text output_subarea output_execute_result&quot;&gt;
&lt;pre&gt;0.87143869370430582&lt;/pre&gt;
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

    
    
&lt;div class=&quot;cell border-box-sizing code_cell rendered&quot;&gt;
&lt;div class=&quot;input&quot;&gt;

&lt;div class=&quot;inner_cell&quot;&gt;
    &lt;div class=&quot;input_area&quot;&gt;
&lt;div class=&quot; highlight hl-ipython3&quot;&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;tpot&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;export&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&amp;#39;tpot_boston_pipeline.py&amp;#39;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

    &lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
    

&lt;/div&gt;</content><author><name>Matías Battocchia</name></author><summary type="html"></summary></entry></feed>